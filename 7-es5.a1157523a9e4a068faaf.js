!function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{QiNc:function(t,r,i){"use strict";i.r(r),i.d(r,"TaskCatalogFilterPageModule",function(){return d});var a,s,o=i("ofXK"),c=i("3Pt+"),l=i("TEn/"),u=i("tyNb"),b=i("hvzS"),h=i("fXoL"),f=[{path:"",component:b.a}],k=((s=e(function t(){n(this,t)})).\u0275fac=function(t){return new(t||s)},s.\u0275mod=h.Jb({type:s}),s.\u0275inj=h.Ib({imports:[[u.h.forChild(f)],u.h]}),s),d=((a=e(function t(){n(this,t)})).\u0275fac=function(t){return new(t||a)},a.\u0275mod=h.Jb({type:a}),a.\u0275inj=h.Ib({imports:[[o.c,c.a,l.bb,k]]}),a)},hvzS:function(t,r,i){"use strict";i.d(r,"a",function(){return b});var a=i("fXoL"),s=i("TEn/"),o=i("L5fO"),c=i("ofXK"),l=i("3Pt+");function u(t,e){if(1&t){var n=a.Sb();a.Rb(0,"ion-item"),a.Rb(1,"ion-label"),a.tc(2),a.Qb(),a.Rb(3,"ion-toggle",9),a.Zb("ngModelChange",function(t){a.mc(n);var r=e.$implicit;return a.bc().taskGroups[r].isFiltered=!t}),a.Qb(),a.Qb()}if(2&t){var r=e.$implicit,i=a.bc();a.Bb(2),a.uc(r),a.Bb(1),a.hc("ngModel",!i.taskGroups[r].isFiltered)}}var b=function(){var t=function(){function t(e,r){n(this,t),this.modalCtrl=e,this.langProvider=r}return e(t,[{key:"ngOnInit",value:function(){this.taskGroupsKeys=Object.keys(this.taskGroups)}},{key:"resetFilters",value:function(){var t=this;Object.keys(this.taskGroups).forEach(function(e){return t.taskGroups[e].isFiltered=!1})}},{key:"shutdownFilters",value:function(){var t=this;Object.keys(this.taskGroups).forEach(function(e){return t.taskGroups[e].isFiltered=!0})}},{key:"applyFilters",value:function(){this.modalCtrl.dismiss("koko")}},{key:"dismissFilters",value:function(){this.modalCtrl.dismiss("koko")}},{key:"changeFilterStatus",value:function(t){this.taskGroups[t].isFiltered=!this.taskGroups[t].isFiltered}}]),t}();return t.\u0275fac=function(e){return new(e||t)(a.Lb(s.eb),a.Lb(o.b))},t.\u0275cmp=a.Fb({type:t,selectors:[["app-task-catalog-filter"]],inputs:{taskGroups:"taskGroups"},decls:15,vars:5,consts:[["translucent","true"],["slot","end"],["strong","",3,"click"],[1,"mainFilters",3,"fullscreen"],[1,"resetFilters"],["slot","start","color","danger","fill","clear",3,"click"],["slot","end","color","success","fill","clear",3,"click"],[1,"filtersList"],[4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(a.Rb(0,"ion-header",0),a.Rb(1,"ion-toolbar"),a.Mb(2,"ion-title"),a.Rb(3,"ion-buttons",1),a.Rb(4,"ion-button",2),a.Zb("click",function(){return e.applyFilters()}),a.tc(5),a.Qb(),a.Qb(),a.Qb(),a.Qb(),a.Rb(6,"ion-content",3),a.Rb(7,"ion-toolbar",4),a.Rb(8,"ion-button",5),a.Zb("click",function(){return e.shutdownFilters()}),a.tc(9),a.Qb(),a.Rb(10,"ion-button",6),a.Zb("click",function(){return e.resetFilters()}),a.tc(11),a.Qb(),a.Qb(),a.Rb(12,"div",7),a.Rb(13,"ion-list"),a.rc(14,u,4,2,"ion-item",8),a.Qb(),a.Qb(),a.Qb()),2&t&&(a.Bb(5),a.uc(e.langProvider.Done),a.Bb(1),a.hc("fullscreen",!0),a.Bb(3),a.vc(" ",e.langProvider.ShutdownAll," "),a.Bb(2),a.vc(" ",e.langProvider.ShowAll," "),a.Bb(3),a.hc("ngForOf",e.taskGroupsKeys))},directives:[s.s,s.Z,s.X,s.k,s.j,s.n,s.D,c.l,s.w,s.C,s.Y,s.c,l.e,l.h],styles:[".mainFilters[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;overflow:hidden}.resetFilters[_ngcontent-%COMP%]{flex:1;width:100%;display:flex;justify-content:space-between}.filtersList[_ngcontent-%COMP%]{overflow:scroll}"]}),t}()},"m/R5":function(t,r,i){"use strict";i.r(r),i.d(r,"TaskCatalogPageModule",function(){return D});var a=i("ofXK"),s=i("3Pt+"),o=i("TEn/"),c=i("tyNb"),l=i("mrSG"),u=i("kLqA"),b=i("Mxx3"),h=i("hvzS"),f=i("fXoL"),k=i("3LWr"),d=i("zrcv"),g=i("NrBX"),v=i("RybT"),p=i("L5fO"),m=i("Ueei"),y=["slide"];function w(t,e){if(1&t){var n=f.Sb();f.Rb(0,"ion-button",10),f.Zb("click",function(){return f.mc(n),f.bc(3).showSearchbar()}),f.Mb(1,"ion-icon",12),f.Qb()}}function T(t,e){if(1&t){var n=f.Sb();f.Pb(0),f.Rb(1,"ion-buttons",4),f.Mb(2,"ion-menu-button"),f.Qb(),f.Rb(3,"ion-segment",5),f.Zb("ngModelChange",function(t){return f.mc(n),f.bc(2).segment=t})("ionChange",function(){return f.mc(n),f.bc(2).updateSegment()}),f.Rb(4,"ion-segment-button",6),f.tc(5),f.Qb(),f.Rb(6,"ion-segment-button",7),f.tc(7),f.Qb(),f.Qb(),f.Rb(8,"ion-buttons",8),f.rc(9,w,2,0,"ion-button",9),f.Rb(10,"ion-button",10),f.Zb("click",function(){return f.mc(n),f.bc(2).showTaskFilters()}),f.Mb(11,"ion-icon",11),f.Qb(),f.Qb(),f.Ob()}if(2&t){var r=f.bc(2);f.Bb(3),f.hc("ngModel",r.segment),f.Bb(2),f.vc(" ",r.langProvider.FavoriteCatalogTasks," "),f.Bb(2),f.vc(" ",r.langProvider.AllCatalogTasks," "),f.Bb(2),f.hc("ngIf",!r.isShowSearchbar)}}function C(t,e){if(1&t){var n=f.Sb();f.Rb(0,"ion-searchbar",13),f.Zb("ngModelChange",function(t){return f.mc(n),f.bc(2).searchTaskStr=t})("ionChange",function(){return f.mc(n),f.bc(2).updateSearchTask()})("ionCancel",function(){return f.mc(n),f.bc(2).hideSearchbar()}),f.Qb()}if(2&t){var r=f.bc(2);f.hc("ngModel",r.searchTaskStr)}}function F(t,e){if(1&t){var n=f.Sb();f.Rb(0,"ion-item-group"),f.Rb(1,"ion-item-divider",14),f.Rb(2,"ion-label"),f.tc(3),f.Qb(),f.Qb(),f.Rb(4,"ion-item",15),f.Zb("click",function(){f.mc(n);var t=f.bc(2);return t.createNewTask(t.store.lastTask.value)}),f.cc(5,"lowercase"),f.cc(6,"async"),f.Rb(7,"ion-label"),f.Rb(8,"p"),f.tc(9),f.cc(10,"async"),f.Qb(),f.Qb(),f.Qb(),f.Qb()}if(2&t){var r=f.bc(2);f.Bb(3),f.vc(" ",r.langProvider.LatestCatalogTasks," "),f.Bb(1),f.Cb("track",f.dc(5,3,f.dc(6,5,r.store.lastTask).type)),f.Bb(5),f.uc(f.dc(10,7,r.store.lastTask).description)}}function R(t,e){if(1&t){var n=f.Sb();f.Rb(0,"ion-icon",21),f.Zb("click",function(t){f.mc(n);var e=f.bc().$implicit;return f.bc(3).changeFavorite(e,t)}),f.Qb()}}function x(t,e){if(1&t){var n=f.Sb();f.Rb(0,"ion-icon",22),f.Zb("click",function(t){f.mc(n);var e=f.bc().$implicit;return f.bc(3).changeFavorite(e,t)}),f.Qb()}}function S(t,e){if(1&t){var n=f.Sb();f.Rb(0,"ion-item-sliding",null,17),f.cc(2,"lowercase"),f.Rb(3,"ion-item",18),f.Zb("click",function(){f.mc(n);var t=e.$implicit;return f.bc(3).createNewTask(t)}),f.Rb(4,"ion-label"),f.Rb(5,"p"),f.tc(6),f.Qb(),f.Qb(),f.rc(7,R,1,0,"ion-icon",19),f.rc(8,x,1,0,"ion-icon",20),f.Qb(),f.Qb()}if(2&t){var r=e.$implicit;f.Cb("track",f.dc(2,5,r.type)),f.Bb(3),f.hc("hidden",r.isFiltered),f.Bb(3),f.uc(r.description),f.Bb(1),f.hc("ngIf",!r.isFavorite),f.Bb(1),f.hc("ngIf",r.isFavorite)}}function Q(t,e){if(1&t&&(f.Rb(0,"ion-item-group"),f.Rb(1,"ion-item-divider",14),f.Rb(2,"ion-label"),f.tc(3),f.Qb(),f.Qb(),f.rc(4,S,9,7,"ion-item-sliding",16),f.Qb()),2&t){var n=e.$implicit,r=f.bc(2);f.Bb(3),f.vc(" ",n," "),f.Bb(1),f.hc("ngForOf",r.taskGroups[n].tasks)("ngForTrackBy",r.trackByFn)}}function P(t,e){if(1&t&&(f.Pb(0),f.Rb(1,"ion-header"),f.Rb(2,"ion-toolbar"),f.rc(3,T,12,4,"ng-container",0),f.rc(4,C,1,1,"ion-searchbar",1),f.Qb(),f.Qb(),f.Rb(5,"ion-content",2),f.Rb(6,"ion-list"),f.rc(7,F,11,9,"ion-item-group",0),f.cc(8,"async"),f.rc(9,Q,5,3,"ion-item-group",3),f.Qb(),f.Qb(),f.Ob()),2&t){var n=f.bc();f.Bb(3),f.hc("ngIf",!n.isShowSearchbar),f.Bb(1),f.hc("ngIf",n.isShowSearchbar),f.Bb(1),f.hc("fullscreen",!0),f.Bb(2),f.hc("ngIf",f.dc(8,5,n.store.lastTask)),f.Bb(2),f.hc("ngForOf",n.taskGroupsKeys)}}var O,M,B,G=[{path:"",component:(O=function(){function t(e,r,i,a,s,o,c,l,u,b){n(this,t),this.router=e,this.route=r,this.actionCtrl=i,this.store=a,this.msgService=s,this.modalCtrl=o,this.tasksDelegator=c,this.taskDelegatorFactory=l,this.langProvider=u,this.backupService=b,this.searchTaskStr="",this.segment="favorites",this.isInit=!1}return e(t,[{key:"ngOnInit",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.tasksDelegator.getCategoryConfig();case 2:this.taskCatalog=t.sent.TasksCatalog,this.taskGroups=this.taskCatalog.reduce(function(t,e){return t[e.group]=t[e.group]||{isFiltered:!1,tasks:[]},t[e.group].tasks.push(e),t},Object.create(null)),this.filterTasks(),this.isInit=!0;case 6:case"end":return t.stop()}},t,this)}))}},{key:"ionViewWillEnter",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.backupService.checkBackupNeeded(),!(e=this.route.snapshot.paramMap.get(b.a.TaskDescId))){t.next=8;break}return t.next=5,this.tasksDelegator.getTaskDesk(e);case 5:return n=t.sent,t.next=8,this.createNewTask(n,!0);case 8:case"end":return t.stop()}},t,this)}))}},{key:"updateSearchTask",value:function(){this.filterTasks()}},{key:"updateSegment",value:function(){var t;null===(t=this.slide)||void 0===t||t.closeOpened(),this.filterTasks()}},{key:"showSearchbar",value:function(){this.isShowSearchbar=!0}},{key:"hideSearchbar",value:function(){this.isShowSearchbar=!1,this.searchTaskStr="",this.filterTasks()}},{key:"tokenizeSearchText",value:function(t){var e=null;if(""!==t.trim()){var n=t.toLowerCase().replace(/,|\.|-/g," ");""!==n&&(e=n.split(" ").filter(function(t){return!!t.trim().length}))}return e}},{key:"checkSearchDesc",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!0;return e&&(r=n?e.every(function(e){return t.description.indexOf(e)>-1}):e.some(function(e){return t.description.indexOf(e)>-1})),r}},{key:"filterTasks",value:function(){var t=this,e=this.tokenizeSearchText(this.searchTaskStr);switch(this.segment){case"all":Object.keys(this.taskGroups).forEach(function(n){t.taskGroups[n].tasks.forEach(function(r){r.isFiltered=t.taskGroups[n].isFiltered||!t.checkSearchDesc(r,e)})});break;case"favorites":Object.keys(this.taskGroups).forEach(function(n){t.taskGroups[n].tasks.forEach(function(r){r.isFiltered=!r.isFavorite||t.taskGroups[n].isFiltered||!t.checkSearchDesc(r,e)})})}this.taskGroupsKeys=[],Object.keys(this.taskGroups).forEach(function(e){t.taskGroups[e].tasks.filter(function(t){return!t.isFiltered}).length>0&&t.taskGroupsKeys.push(e)})}},{key:"changeFavorite",value:function(t,e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.stopImmediatePropagation(),t.isFavorite=!t.isFavorite,t.isFavorite?this.msgService.showToast(this.langProvider.FavoriteAddMsg(t.description),500,b.b.ToastSuccess):this.msgService.showToast(this.langProvider.FavoriteRemoveMsg(t.description),500,b.b.ToastWarn),n.next=5,this.tasksDelegator.updateTaskCatalog();case 5:this.filterTasks();case 6:case"end":return n.stop()}},n,this)}))}},{key:"showTaskFilters",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalCtrl.create({component:h.a,swipeToClose:!0,componentProps:{taskGroups:this.taskGroups}});case 2:return e=t.sent,t.next=5,e.present();case 5:return t.next=7,e.onWillDismiss();case 7:this.filterTasks();case 8:case"end":return t.stop()}},t,this)}))}},{key:"taskSwiped",value:function(t,e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.msgService.showToast("Fully Swiped: ".concat(t.description),500);case 2:case"end":return e.stop()}},e,this)}))}},{key:"createNewTask",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,a,s,o,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.tasksDelegator.getTasksConfig(t.id);case 2:if(r=n.sent,e||!(r.isAlertForMultiple||r.maxItems>=1)){n.next=42;break}return n.next=6,this.tasksDelegator.getAllTasksByTypeImpl(t.type,t.id);case 6:if(!((i=n.sent).length>0)){n.next=31;break}if(!(i.length>=r.maxItems)){n.next=18;break}return n.next=11,this.actionCtrl.create({header:this.langProvider.CatalogTaskEditMaxTasksMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:function(){a="Edit"}},{text:this.langProvider.Cancel,role:"cancel",handler:function(){a="Cancel"}}]});case 11:return s=n.sent,n.next=14,s.present();case 14:return n.next=16,s.onWillDismiss();case 16:n.next=29;break;case 18:if(!r.isAlertForMultiple){n.next=28;break}return n.next=21,this.actionCtrl.create({header:this.langProvider.CatalogTaskEditOrNewMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:function(){a="Edit"}},{text:this.langProvider.CatalogTaskNew,role:"destructive",handler:function(){a="New"}},{text:this.langProvider.Cancel,role:"cancel",handler:function(){a="Cancel"}}]});case 21:return o=n.sent,n.next=24,o.present();case 24:return n.next=26,o.onWillDismiss();case 26:n.next=29;break;case 28:a="New";case 29:n.next=32;break;case 31:a="New";case 32:n.t0=a,n.next="New"===n.t0?35:"Edit"===n.t0?37:40;break;case 35:return this.navigatoToTask(t),n.abrupt("break",40);case 37:return c=i.sort(function(t,e){return new Date(t.date).getTime()-new Date(e.date).getTime()}).reverse()[0],this.navigatoToTask(t,c._id),n.abrupt("break",40);case 40:n.next=43;break;case 42:this.navigatoToTask(t);case 43:case"end":return n.stop()}},n,this)}))}},{key:"navigatoToTask",value:function(t,e){var n;this.store.lastTask.next(t),null===(n=this.slide)||void 0===n||n.closeOpened();var r={};r[b.a.TaskType]=t.type,r[b.a.TaskDescId]=t.id,e&&(r[b.a.SavedTaskId]=e),r[b.a.Unique]=u.Guid.raw();var i={Path:"tabs/tasks/".concat(this.taskDelegatorFactory.getTaskDelegator(t.type).getComponentRoute()),Params:r,NavigationExtras:{skipLocationChange:!0,replaceUrl:!0}};this.store.lastTaskNavData.next(i),this.router.navigate([i.Path,i.Params],i.NavigationExtras)}},{key:"trackByFn",value:function(t,e){return e?e.id:t}}]),t}(),O.\u0275fac=function(t){return new(t||O)(f.Lb(c.f),f.Lb(c.a),f.Lb(o.a),f.Lb(k.a),f.Lb(d.a),f.Lb(o.eb),f.Lb(g.a),f.Lb(v.a),f.Lb(p.b),f.Lb(m.a))},O.\u0275cmp=f.Fb({type:O,selectors:[["app-task-catalog"]],viewQuery:function(t,e){var n;1&t&&f.zc(y,1),2&t&&f.kc(n=f.ac())&&(e.slide=n.first)},decls:1,vars:1,consts:[[4,"ngIf"],["class","searchbar","showCancelButton","always",3,"ngModel","ngModelChange","ionChange","ionCancel",4,"ngIf"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["slot","start"],[3,"ngModel","ngModelChange","ionChange"],["value","favorites"],["value","all"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","options"],["slot","icon-only","name","search"],["showCancelButton","always",1,"searchbar",3,"ngModel","ngModelChange","ionChange","ionCancel"],["sticky","",1,"itemGroup"],["button","",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["slide",""],["button","",3,"hidden","click"],["slot","end","name","star-outline",3,"click",4,"ngIf"],["slot","end","name","star","color","primary",3,"click",4,"ngIf"],["slot","end","name","star-outline",3,"click"],["slot","end","name","star","color","primary",3,"click"]],template:function(t,e){1&t&&f.rc(0,P,10,7,"ng-container",0),2&t&&f.hc("ngIf",e.isInit)},directives:[a.m,o.s,o.Z,o.n,o.D,a.l,o.k,o.F,o.O,o.kb,s.e,s.h,o.P,o.j,o.t,o.N,o.lb,o.y,o.x,o.C,o.w,o.B],pipes:[a.b,a.k],styles:[".itemGroup[_ngcontent-%COMP%]{font-weight:700;--color:var(--ion-color-favorite)}.searchbar[_ngcontent-%COMP%]{background:var(--ion-color-light)}"]}),O)},{path:"task-catalog-filter",loadChildren:function(){return Promise.resolve().then(i.bind(null,"QiNc")).then(function(t){return t.TaskCatalogFilterPageModule})}}],I=((M=e(function t(){n(this,t)})).\u0275fac=function(t){return new(t||M)},M.\u0275mod=f.Jb({type:M}),M.\u0275inj=f.Ib({imports:[[c.h.forChild(G)],c.h]}),M),L=i("QiNc"),D=((B=e(function t(){n(this,t)})).\u0275fac=function(t){return new(t||B)},B.\u0275mod=f.Jb({type:B}),B.\u0275inj=f.Ib({imports:[[a.c,s.a,o.bb,I,L.TaskCatalogFilterPageModule]]}),B)}}])}();