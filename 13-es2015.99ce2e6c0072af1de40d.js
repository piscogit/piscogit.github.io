(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{OrUu:function(t,e,n){"use strict";n.r(e),n.d(e,"TasksHistoryPageModule",(function(){return D}));var s=n("ofXK"),i=n("3Pt+"),a=n("TEn/"),o=n("tyNb"),c=n("mrSG"),r=n("Mxx3"),l=n("fXoL"),b=n("3LWr"),d=n("ufmx"),h=n("NrBX"),u=n("L5fO"),g=n("zrcv"),y=n("RybT"),p=n("VVJX");function f(t,e){}let k=(()=>{class t{constructor(t,e){this.componentFactoryResolver=t,this.taskDelegatorFactory=e}ngOnInit(){const t=this.taskDelegatorFactory.getTaskDelegator(this.task.type).getHistoryComponent();if(t){const e=this.componentFactoryResolver.resolveComponentFactory(t),n=this.taskHost.viewContainerRef;n.clear();const s=n.createComponent(e);s.instance.task=this.task,s.instance.candidates=this.candidates,this.componentRef=s}}ngOnChanges(t){this.componentRef&&(this.componentRef.instance.task=this.task,this.componentRef.instance.candidates=this.candidates,this.componentRef.instance.calcHistory())}}return t.\u0275fac=function(e){return new(e||t)(l.Ib(l.j),l.Ib(y.a))},t.\u0275cmp=l.Cb({type:t,selectors:[["app-task-history-host"]],viewQuery:function(t,e){var n;1&t&&l.lc(p.a,!0),2&t&&l.gc(n=l.Wb())&&(e.taskHost=n.first)},inputs:{task:"task",candidates:"candidates"},features:[l.wb],decls:1,vars:0,consts:[["appTaskHost",""]],template:function(t,e){1&t&&l.nc(0,f,0,0,"ng-template",0)},directives:[p.a],styles:[""]}),t})();function m(t,e){if(1&t){const t=l.Ob();l.Nb(0,"ion-button",7),l.Vb("click",(function(){return l.ic(t),l.Xb(3).showSearchbar(!0)})),l.Jb(1,"ion-icon",9),l.Mb()}}function v(t,e){if(1&t){const t=l.Ob();l.Lb(0),l.Nb(1,"ion-buttons",4),l.Jb(2,"ion-menu-button"),l.Mb(),l.Nb(3,"ion-title"),l.pc(4),l.Mb(),l.Nb(5,"ion-buttons",5),l.nc(6,m,2,0,"ion-button",6),l.Nb(7,"ion-button",7),l.Vb("click",(function(){return l.ic(t),l.Xb(2).showTaskFilters()})),l.Jb(8,"ion-icon",8),l.Mb(),l.Mb(),l.Kb()}if(2&t){const t=l.Xb(2);l.yb(3),l.mc("direction",t.langProvider.LangDirection),l.yb(1),l.qc(t.langProvider.TasksHistory),l.yb(2),l.dc("ngIf",!t.isShowSearchbar)}}function C(t,e){if(1&t){const t=l.Ob();l.Nb(0,"ion-searchbar",10),l.Vb("ngModelChange",(function(e){return l.ic(t),l.Xb(2).searchTaskStr=e}))("ionChange",(function(){return l.ic(t),l.Xb(2).updateSearchTask()}))("ionCancel",(function(){return l.ic(t),l.Xb(2).showSearchbar(!1)})),l.Mb()}if(2&t){const t=l.Xb(2);l.dc("ngModel",t.searchTaskStr)}}function w(t,e){if(1&t){const t=l.Ob();l.Nb(0,"div"),l.Nb(1,"ion-item-sliding",null,11),l.Yb(3,"lowercase"),l.Nb(4,"ion-item-options",12),l.Nb(5,"ion-item-option",13),l.Vb("click",(function(){l.ic(t);const n=e.$implicit,s=l.hc(2);return l.Xb(2).onDeleted(n,s)})),l.Jb(6,"ion-icon",14),l.Mb(),l.Mb(),l.Nb(7,"ion-item",15),l.Vb("click",(function(){l.ic(t);const n=e.$implicit;return l.Xb(2).onEdit(n)})),l.Nb(8,"ion-label"),l.Nb(9,"h3",16),l.Nb(10,"span"),l.pc(11),l.Mb(),l.Nb(12,"span",17),l.pc(13),l.Yb(14,"date"),l.Mb(),l.Mb(),l.Jb(15,"app-task-history-host",18),l.Mb(),l.Mb(),l.Mb(),l.Mb()}if(2&t){const t=e.$implicit,n=l.Xb(2);l.yb(1),l.zb("track",l.Zb(3,7,t.type)),l.yb(7),l.mc("direction",n.langProvider.LangDirection),l.yb(3),l.qc(t.name),l.yb(2),l.qc(l.ac(14,9,t.date,"dd/MM/yy HH:mm:ss")),l.yb(2),l.dc("task",t)("candidates",n.candidates)}}function M(t,e){if(1&t&&(l.Lb(0),l.Nb(1,"ion-header"),l.Nb(2,"ion-toolbar"),l.nc(3,v,9,4,"ng-container",0),l.nc(4,C,1,1,"ion-searchbar",1),l.Mb(),l.Mb(),l.Nb(5,"ion-content"),l.Nb(6,"ion-virtual-scroll",2),l.nc(7,w,16,12,"div",3),l.Mb(),l.Mb(),l.Kb()),2&t){const t=l.Xb();l.yb(3),l.dc("ngIf",!t.isShowSearchbar),l.yb(1),l.dc("ngIf",t.isShowSearchbar),l.yb(2),l.dc("items",t.tasksHistory)("trackBy",t.trackByFn)}}const T=[{path:"",component:(()=>{class t{constructor(t,e,n,s,i,a,o,c,r){this.router=t,this.store=e,this.candidatesDelegator=n,this.tasksDelegator=s,this.langProvider=i,this.msgService=a,this.loadingCtrl=o,this.alertController=c,this.taskDelegatorFactory=r,this.subscription={},this.isInit=!1}ngOnInit(){return Object(c.a)(this,void 0,void 0,(function*(){this.candidates=yield this.candidatesDelegator.getCandidatesCopy(),this.subscription.lastTasksChangeTime=this.store.lastTasksChangeTime.subscribe(t=>Object(c.a)(this,void 0,void 0,(function*(){this.loadTasks()}))),this.isInit=!0}))}ngOnDestroy(){for(const t in this.subscription)Object.prototype.hasOwnProperty.call(this.subscription,t)&&this.subscription[t].unsubscribe()}ionViewWillEnter(){return Object(c.a)(this,void 0,void 0,(function*(){}))}loadTasks(){return Object(c.a)(this,void 0,void 0,(function*(){let t;try{t=yield this.msgService.showLoader();const e=(yield this.tasksDelegator.getAllTasks()).sort((t,e)=>{const n=new Date(t.date).getTime();return new Date(e.date).getTime()-n});this.tasksHistory=e}finally{t.dismiss()}}))}onEdit(t){const e={};e[r.a.TaskDescId]=t.taskId,e[r.a.SavedTaskId]=t._id;const n={Path:"tabs/tasks/"+t.type.toLowerCase(),Params:e,NavigationExtras:{skipLocationChange:!0,replaceUrl:!0}};this.store.lastTaskNavData.next(n),this.router.navigate([n.Path,n.Params],n.NavigationExtras)}onDeleted(t,e){return Object(c.a)(this,void 0,void 0,(function*(){e.closeOpened();let n=!1;const s=yield this.alertController.create({cssClass:[this.langProvider.LangDirection],header:this.langProvider.AreYouSure,subHeader:this.langProvider.TaskDeleteWarnMsg,buttons:[{text:this.langProvider.Cancel,role:"cancel",cssClass:"secondary"},{text:this.langProvider.Activate,role:"destructive",cssClass:"danger",handler:()=>n=!0}]});if(yield s.present(),yield s.onWillDismiss(),n){const e=this.taskDelegatorFactory.getTaskDelegator(t.type),n=yield this.loadingCtrl.create({message:"temp delete task"});yield n.present(),yield e.deleteTask(t),yield this.loadTasks(),yield n.dismiss(),yield n.onDidDismiss()}}))}showSearchbar(t){}showTaskFilters(){}updateSearchTask(){}trackByFn(t,e){return e?e._id:t}temp(t){console.log(t._id)}}return t.\u0275fac=function(e){return new(e||t)(l.Ib(o.f),l.Ib(b.a),l.Ib(d.a),l.Ib(h.a),l.Ib(u.b),l.Ib(g.a),l.Ib(a.cb),l.Ib(a.b),l.Ib(y.a))},t.\u0275cmp=l.Cb({type:t,selectors:[["app-tasks-history"]],viewQuery:function(t,e){var n;1&t&&l.tc(a.ab,!0),2&t&&l.gc(n=l.Wb())&&(e.virtualScroll=n.first)},decls:1,vars:1,consts:[[4,"ngIf"],["class","searchbar","showCancelButton","always",3,"ngModel","ngModelChange","ionChange","ionCancel",4,"ngIf"],[3,"items","trackBy"],[4,"virtualItem"],["slot","start"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","options"],["slot","icon-only","name","search"],["showCancelButton","always",1,"searchbar",3,"ngModel","ngModelChange","ionChange","ionCancel"],["slide",""],["side","end"],["color","danger",3,"click"],["name","trash",1,"deletedBtn"],["button","",3,"click"],[1,"taskHistory"],[2,"direction","ltr"],[3,"task","candidates"]],template:function(t,e){1&t&&l.nc(0,M,8,4,"ng-container",0),2&t&&l.dc("ngIf",e.isInit)},directives:[s.m,a.s,a.Z,a.n,a.ab,a.mb,a.k,a.F,a.X,a.j,a.t,a.N,a.kb,i.d,i.g,a.B,a.A,a.z,a.w,a.C,k],pipes:[s.k,s.e],styles:[".taskHistory[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.deletedBtn[_ngcontent-%COMP%]{font-size:large}"]}),t})()}];let I=(()=>{class t{}return t.\u0275mod=l.Gb({type:t}),t.\u0275inj=l.Fb({factory:function(e){return new(e||t)},imports:[[o.h.forChild(T)],o.h]}),t})();var N=n("ajeZ");let D=(()=>{class t{}return t.\u0275mod=l.Gb({type:t}),t.\u0275inj=l.Fb({factory:function(e){return new(e||t)},imports:[[s.c,i.a,a.bb,N.a,I]]}),t})()}}]);