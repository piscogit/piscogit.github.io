!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{LTzM:function(t,a,r){"use strict";r.r(a),r.d(a,"CreateCommentPageModule",(function(){return I}));var o=r("ofXK"),c=r("3Pt+"),s=r("TEn/"),d=r("tyNb"),l=r("mrSG"),u=r("OZ4V"),m=r("Mxx3"),b=r("+Ff3"),f=r("fXoL"),h=r("NrBX"),v=r("nTzd"),g=r("ufmx"),p=r("zrcv"),C=r("L5fO"),k=r("3LWr"),y=r("5+WD"),M=r("g1yl");function w(e,t){1&e&&f.Jb(0,"app-candidate-avatar",16),2&e&&f.dc("candidate",t.$implicit.value)}function x(e,t){if(1&e){var n=f.Ob();f.Nb(0,"ion-item",17),f.Vb("click",(function(){f.ic(n);var e=t.$implicit;return f.Xb().savedCommentSelected(e)})),f.Nb(1,"ion-label"),f.Nb(2,"span"),f.pc(3),f.Mb(),f.Mb(),f.Mb()}if(2&e){var a=t.$implicit;f.yb(3),f.qc(a.comment)}}var O,N,P,S=[{path:"",component:(O=function(){function t(e,a,i,r,o,c,s,d,l,u){n(this,t),this.navCtrl=e,this.modalCtrl=a,this.route=i,this.router=r,this.tasksDelegator=o,this.tasksCommentsDelegator=c,this.candidatesDelegator=s,this.msgService=d,this.langProvider=l,this.store=u,this.selectedCandidates={},this.dragDelay=m.a.DragDelay,this.title=this.langProvider.GeneralComment,this.isInit=!1}return i(t,[{key:"ngOnInit",value:function(){var t,n,a;return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var r,o,c=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.candidatesDelegator.getCandidatesCopy(!0);case 2:if(this.candidates=i.sent,this.savedComments=b.c,r=this.route.snapshot.paramMap.get(m.a.TaskDescId),i.t0=r,!i.t0){i.next=15;break}return i.next=9,this.tasksDelegator.getTaskDesk(r);case 9:return this.taskDescRef=i.sent,i.next=12,this.tasksDelegator.getTasksConfig(r);case 12:this.taskConfigRef=i.sent,this.title=this.taskDescRef.description,this.savedComments=[].concat(e(null!==(t=this.taskConfigRef.comments)&&void 0!==t?t:[]),e(null!==(n=this.savedComments)&&void 0!==n?n:[]));case 15:(o=this.route.snapshot.paramMap.get(m.a.Navigate))&&this.store.editComment.value.id===o&&(this.editedComment=this.store.editComment.value.data,this.editedComment&&(this.comment=this.editedComment.comment,this.editedComment.candidates.forEach((function(e){return c.selectedCandidates[e._id]=e})),this.taskDescRef=this.editedComment.TaskDescRef,this.title=null===(a=this.editedComment.TaskDescRef)||void 0===a?void 0:a.description)),this.isInit=!0;case 17:case"end":return i.stop()}}),i,this)})))}},{key:"ngOnDestroy",value:function(){}},{key:"selectCandidate",value:function(e){this.selectedCandidates[e._id]=this.selectedCandidates[e._id]?null:e}},{key:"dropCandidates",value:function(e){}},{key:"createComment",value:function(){var e,t;return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var a,i,r,o,c=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=this.editedComment,!n.t0){n.next=4;break}return n.next=4,this.tasksCommentsDelegator.deleteComments(this.editedComment.SavedComments);case 4:if(0!==(a=Object.keys(this.selectedCandidates).filter((function(e){return c.selectedCandidates[e]})).map((function(e){return c.selectedCandidates[e]}))).length){n.next=9;break}this.msgService.showToast(this.langProvider.NoneSelectedCandidates,1e3,"toastWarn"),n.next=25;break;case 9:if(!(null===(e=this.comment)||void 0===e?void 0:e.trim())){n.next=24;break}return i={candidates:a,comment:this.comment,TaskDescRef:this.taskDescRef,date:null===(t=this.editedComment)||void 0===t?void 0:t.date},n.next=13,this.tasksCommentsDelegator.createComment(i);case 13:if(r=n.sent,this.store.lastCommentsChangeDateTime.next(r[0].date),this.msgService.showToast(this.langProvider.CommentSaved+"..."),!this.taskDescRef){n.next=20;break}return o=this.store.lastTaskNavData,n.next=18,this.router.navigate([o.value.Path,o.value.Params],o.value.NavigationExtras);case 18:n.next=22;break;case 20:return n.next=22,this.router.navigate(["tabs/comments"],{skipLocationChange:!0});case 22:n.next=25;break;case 24:this.msgService.showToast(this.langProvider.EmptyComment,1e3,"toastWarn");case 25:case"end":return n.stop()}}),n,this)})))}},{key:"savedCommentSelected",value:function(e){this.comment="".concat(this.comment?this.comment+"\n":"").concat(e.comment)}},{key:"addSavedComment",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"selectCandidates",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a,i,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},Object.keys(this.selectedCandidates).forEach((function(e){return t[r.selectedCandidates[e]._id]=!0})),e.next=4,this.modalCtrl.create({component:u.a,componentProps:{candidates:this.candidates,selectedCandidates:t,isModal:!0}});case 4:return n=e.sent,e.next=7,n.present();case 7:return e.next=9,n.onWillDismiss();case 9:if(!(a=e.sent).data){e.next=15;break}return i=Object.keys(a.data).filter((function(e){return a.data[e]})),e.next=14,this.candidatesDelegator.getCandidatesByIdsMap(i);case 14:this.selectedCandidates=e.sent;case 15:case"end":return e.stop()}}),e,this)})))}},{key:"trackByFn",value:function(e,t){return(null==t?void 0:t.value)?t.value._id:e}},{key:"back",value:function(e){var t;return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=this.comment)||void 0===t?void 0:t.trim())){e.next=8;break}return e.next=3,this.msgService.showAreYouSure(this.langProvider.CommentNotSaved);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.navCtrl.back();case 6:e.next=9;break;case 8:this.navCtrl.back();case 9:case"end":return e.stop()}}),e,this)})))}}]),t}(),O.\u0275fac=function(e){return new(e||O)(f.Ib(s.fb),f.Ib(s.eb),f.Ib(d.a),f.Ib(d.f),f.Ib(h.a),f.Ib(v.a),f.Ib(g.a),f.Ib(p.a),f.Ib(C.b),f.Ib(k.a))},O.\u0275cmp=f.Cb({type:O,selectors:[["app-create-comment"]],decls:24,vars:16,consts:[["slot","start"],["slot","end"],[3,"click"],["slot","icon-only","name","arrow-back"],["cdkDropListGroup","",1,"container"],[1,"commentArea"],["color","primary",1,"selectCandidatesBtn",3,"click"],["name","people"],["autocomplete","on","rows","5",1,"commentText",3,"ngModel","placeholder","ngModelChange"],[1,"selectedCandidates"],["class","candi",3,"candidate",4,"ngFor","ngForOf","ngForTrackBy"],[1,"commentBtns"],["color","secondary",1,"sendBtn",3,"click"],["name","send"],[1,"savedComments"],["button","",3,"click",4,"ngFor","ngForOf"],[1,"candi",3,"candidate"],["button","",3,"click"]],template:function(e,t){1&e&&(f.Nb(0,"ion-header"),f.Nb(1,"ion-toolbar"),f.Nb(2,"ion-buttons",0),f.Jb(3,"ion-menu-button"),f.Mb(),f.Nb(4,"ion-buttons",1),f.Nb(5,"ion-button",2),f.Vb("click",(function(e){return t.back(e)})),f.Jb(6,"ion-icon",3),f.Mb(),f.Mb(),f.Nb(7,"ion-title"),f.pc(8),f.Mb(),f.Mb(),f.Mb(),f.Nb(9,"ion-content"),f.Nb(10,"div",4),f.Nb(11,"div",5),f.Nb(12,"ion-fab-button",6),f.Vb("click",(function(){return t.selectCandidates()})),f.Jb(13,"ion-icon",7),f.Mb(),f.Nb(14,"ion-textarea",8),f.Vb("ngModelChange",(function(e){return t.comment=e})),f.Mb(),f.Nb(15,"div",9),f.nc(16,w,1,1,"app-candidate-avatar",10),f.Yb(17,"keyvalue"),f.Mb(),f.Nb(18,"div",11),f.Nb(19,"ion-fab-button",12),f.Vb("click",(function(){return t.createComment()})),f.Jb(20,"ion-icon",13),f.Mb(),f.Mb(),f.Nb(21,"div",14),f.Nb(22,"ion-list"),f.nc(23,x,4,1,"ion-item",15),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb()),2&e&&(f.yb(7),f.mc("direction",t.langProvider.LangDirection),f.yb(1),f.qc(t.title),f.yb(6),f.mc("direction",t.langProvider.LangDirection),f.dc("ngModel",t.comment)("placeholder",t.langProvider.CreateComment),f.yb(1),f.mc("direction",t.langProvider.LangDirection),f.yb(1),f.dc("ngForOf",f.Zb(17,14,t.selectedCandidates))("ngForTrackBy",t.trackByFn),f.yb(6),f.mc("direction",t.langProvider.LangDirection),f.yb(1),f.dc("ngForOf",t.savedComments))},directives:[s.s,s.Z,s.k,s.F,s.j,s.t,s.X,s.n,y.e,s.p,s.W,s.lb,c.d,c.g,o.l,s.D,M.a,s.w,s.C],pipes:[o.g],styles:["ion-content[_ngcontent-%COMP%]{--overflow:hidden}.container[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%}.candidates[_ngcontent-%COMP%]{height:100%;width:auto;overflow:scroll;min-width:var(--avatar-empty-width)}.avatar[_ngcontent-%COMP%]{height:var(--avatar-height);width:var(--avatar-width)}.avatarMargin[_ngcontent-%COMP%]{margin:var(--avatar-margin)}.avatarComment[_ngcontent-%COMP%]{height:2rem;width:2rem}.commentArea[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;justify-content:flex-start;flex:1}.commentText[_ngcontent-%COMP%]{color:var(--ion-color-dark);max-height:20%}.commentBtns[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.closeBtn[_ngcontent-%COMP%]{margin-left:auto;--background:transparent;--color:var(--ion-color-dark)}.savedComments[_ngcontent-%COMP%]{overflow:scroll}.selectedCandidates[_ngcontent-%COMP%]{display:flex;width:100%;flex-wrap:wrap;overflow:scroll;max-height:5rem}.selectCandidatesBtn[_ngcontent-%COMP%]{margin:.5rem .5rem .5rem auto}.sendBtn[_ngcontent-%COMP%]{transform:rotate(180deg);margin:.5rem auto .5rem .5rem}.candi[_ngcontent-%COMP%]{height:2rem;width:2rem;margin:.2rem}"]}),O)}],D=((N=function e(){n(this,e)}).\u0275mod=f.Gb({type:N}),N.\u0275inj=f.Fb({factory:function(e){return new(e||N)},imports:[[d.h.forChild(S)],d.h]}),N),_=r("ajeZ"),I=((P=function e(){n(this,e)}).\u0275mod=f.Gb({type:P}),P.\u0275inj=f.Fb({factory:function(e){return new(e||P)},imports:[[o.c,c.a,s.bb,D,_.a,y.f]]}),P)},OZ4V:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("mrSG"),o=a("fXoL"),c=a("TEn/"),s=a("zrcv"),d=a("L5fO"),l=a("ofXK"),u=a("g1yl");function m(e,t){if(1&e){var n=o.Ob();o.Nb(0,"ion-header",3),o.Nb(1,"ion-toolbar"),o.Nb(2,"ion-title"),o.pc(3),o.Mb(),o.Nb(4,"ion-buttons",4),o.Nb(5,"ion-button",5),o.Vb("click",(function(e){return o.ic(n),o.Xb().back(e)})),o.Jb(6,"ion-icon",6),o.Mb(),o.Mb(),o.Mb(),o.Mb()}if(2&e){var a=o.Xb();o.yb(3),o.rc(" ",a.langProvider.Select," ")}}function b(e,t){if(1&e){var n=o.Ob();o.Nb(0,"app-candidate-avatar",11),o.Vb("click",(function(){o.ic(n);var e=t.$implicit;return o.Xb(2).select(e)})),o.Mb()}if(2&e){var a=t.$implicit,i=o.Xb(2);o.dc("candidate",a)("isSelected",i.selectedCandidatesCopy[a._id])}}function f(e,t){if(1&e){var n=o.Ob();o.Nb(0,"ion-fab-button",12),o.Vb("click",(function(){return o.ic(n),o.Xb(2).activate()})),o.Jb(1,"ion-icon",13),o.Mb()}}function h(e,t){if(1&e&&(o.Lb(0),o.Nb(1,"ion-content"),o.Nb(2,"div",7),o.Nb(3,"div",8),o.nc(4,b,1,2,"app-candidate-avatar",9),o.Mb(),o.nc(5,f,2,0,"ion-fab-button",10),o.Mb(),o.Mb(),o.Kb()),2&e){var n=o.Xb();o.yb(4),o.dc("ngForOf",n.candidates)("ngForTrackBy",n.trackByFn),o.yb(1),o.dc("ngIf",n.isModal)}}function v(e,t){if(1&e){var n=o.Ob();o.Nb(0,"app-candidate-avatar",11),o.Vb("click",(function(){o.ic(n);var e=t.$implicit;return o.Xb(2).select(e)})),o.Mb()}if(2&e){var a=t.$implicit,i=o.Xb(2);o.dc("candidate",a)("isSelected",i.selectedCandidatesCopy[a._id])}}function g(e,t){if(1&e&&(o.Nb(0,"div",8),o.nc(1,v,1,2,"app-candidate-avatar",9),o.Mb()),2&e){var n=o.Xb();o.yb(1),o.dc("ngForOf",n.candidates)("ngForTrackBy",n.trackByFn)}}var p=function(){var e=function(){function e(t,a,i){n(this,e),this.modalCtrl=t,this.msgService=a,this.langProvider=i,this.candidateSelected=new o.n}return i(e,[{key:"ngOnInit",value:function(){this.isModal?(this.select=this.selectModal,this.selectedCandidates?this.selectedCandidatesCopy=JSON.parse(JSON.stringify(this.selectedCandidates)):this.selectedCandidates={}):(this.select=this.selectNoneModal,this.selectedCandidatesCopy=this.selectedCandidates)}},{key:"selectNoneModal",value:function(e){this.candidateSelected.emit(e)}},{key:"selectModal",value:function(e){this.selectedCandidatesCopy[e._id]=!this.selectedCandidatesCopy[e._id]}},{key:"activate",value:function(){this.modalCtrl.dismiss(this.selectedCandidatesCopy)}},{key:"trackByFn",value:function(e,t){return t?t._id:e}},{key:"back",value:function(e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.candidates.filter((function(e){return t.selectedCandidates[e._id]!=t.selectedCandidatesCopy[e._id]})).length>0)){e.next=8;break}return e.next=3,this.msgService.showAreYouSure(this.langProvider.DataNotSaved);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.modalCtrl.dismiss();case 6:e.next=9;break;case 8:this.modalCtrl.dismiss();case 9:case"end":return e.stop()}}),e,this)})))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Ib(c.eb),o.Ib(s.a),o.Ib(d.b))},e.\u0275cmp=o.Cb({type:e,selectors:[["app-candidate-selection"]],inputs:{candidates:"candidates",selectedCandidates:"selectedCandidates",isModal:"isModal"},outputs:{candidateSelected:"candidateSelected"},decls:4,vars:3,consts:[["translucent","true",4,"ngIf"],[4,"ngIf","ngIfElse"],["noModal",""],["translucent","true"],["slot","end"],[3,"click"],["slot","icon-only","name","arrow-back"],[1,"container"],[1,"candidates"],["class","candi",3,"candidate","isSelected","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","activate","color","secondary",3,"click",4,"ngIf"],[1,"candi",3,"candidate","isSelected","click"],["color","secondary",1,"activate",3,"click"],["name","checkmark"]],template:function(e,t){if(1&e&&(o.nc(0,m,7,1,"ion-header",0),o.nc(1,h,6,3,"ng-container",1),o.nc(2,g,2,2,"ng-template",null,2,o.oc)),2&e){var n=o.hc(3);o.dc("ngIf",t.isModal),o.yb(1),o.dc("ngIf",t.isModal)("ngIfElse",n)}},directives:[l.m,c.s,c.Z,c.X,c.k,c.j,c.t,c.n,l.l,u.a,c.p],styles:[".container[_ngcontent-%COMP%]{flex-direction:column;width:100%}.candidates[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]{display:flex;height:100%}.candidates[_ngcontent-%COMP%]{flex-wrap:wrap;align-content:flex-start;overflow:scroll}.candi[_ngcontent-%COMP%]{height:var(--avatar-height);width:var(--avatar-width);margin:.5rem}.activate[_ngcontent-%COMP%]{margin:.5rem auto}"]}),e}()}}])}();