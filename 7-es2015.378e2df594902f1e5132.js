(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{QiNc:function(t,e,i){"use strict";i.r(e),i.d(e,"TaskCatalogFilterPageModule",(function(){return d}));var s=i("ofXK"),o=i("3Pt+"),n=i("TEn/"),a=i("tyNb"),r=i("hvzS"),c=i("fXoL");const l=[{path:"",component:r.a}];let b=(()=>{class t{}return t.\u0275mod=c.Gb({type:t}),t.\u0275inj=c.Fb({factory:function(e){return new(e||t)},imports:[[a.j.forChild(l)],a.j]}),t})(),d=(()=>{class t{}return t.\u0275mod=c.Gb({type:t}),t.\u0275inj=c.Fb({factory:function(e){return new(e||t)},imports:[[s.c,o.e,n.Bb,b]]}),t})()},hvzS:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var s=i("fXoL"),o=i("TEn/"),n=i("L5fO"),a=i("ofXK"),r=i("3Pt+");function c(t,e){if(1&t){const t=s.Ob();s.Nb(0,"ion-item"),s.Nb(1,"ion-label"),s.qc(2),s.Mb(),s.Nb(3,"ion-toggle",9),s.Vb("ngModelChange",(function(i){s.ic(t);const o=e.$implicit;return s.Xb().taskGroups[o].isFiltered=!i})),s.Mb(),s.Mb()}if(2&t){const t=e.$implicit,i=s.Xb();s.yb(2),s.rc(t),s.yb(1),s.dc("ngModel",!i.taskGroups[t].isFiltered)}}let l=(()=>{class t{constructor(t,e){this.modalCtrl=t,this.langProvider=e}ngOnInit(){this.taskGroupsKeys=Object.keys(this.taskGroups)}resetFilters(){Object.keys(this.taskGroups).forEach(t=>this.taskGroups[t].isFiltered=!1)}shutdownFilters(){Object.keys(this.taskGroups).forEach(t=>this.taskGroups[t].isFiltered=!0)}applyFilters(){this.modalCtrl.dismiss("koko")}dismissFilters(){this.modalCtrl.dismiss("koko")}changeFilterStatus(t){this.taskGroups[t].isFiltered=!this.taskGroups[t].isFiltered}}return t.\u0275fac=function(e){return new(e||t)(s.Ib(o.Eb),s.Ib(n.b))},t.\u0275cmp=s.Cb({type:t,selectors:[["app-task-catalog-filter"]],inputs:{taskGroups:"taskGroups"},decls:15,vars:5,consts:[["translucent","true"],["slot","end"],["strong","",3,"click"],[1,"mainFilters",3,"fullscreen"],[1,"resetFilters"],["slot","start","color","danger","fill","clear",3,"click"],["slot","end","color","success","fill","clear",3,"click"],[1,"filtersList"],[4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(s.Nb(0,"ion-header",0),s.Nb(1,"ion-toolbar"),s.Jb(2,"ion-title"),s.Nb(3,"ion-buttons",1),s.Nb(4,"ion-button",2),s.Vb("click",(function(){return e.applyFilters()})),s.qc(5),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Nb(6,"ion-content",3),s.Nb(7,"ion-toolbar",4),s.Nb(8,"ion-button",5),s.Vb("click",(function(){return e.shutdownFilters()})),s.qc(9),s.Mb(),s.Nb(10,"ion-button",6),s.Vb("click",(function(){return e.resetFilters()})),s.qc(11),s.Mb(),s.Mb(),s.Nb(12,"div",7),s.Nb(13,"ion-list"),s.oc(14,c,4,2,"ion-item",8),s.Mb(),s.Mb(),s.Mb()),2&t&&(s.yb(5),s.rc(e.langProvider.Done),s.yb(1),s.dc("fullscreen",!0),s.yb(3),s.sc(" ",e.langProvider.ShutdownAll," "),s.yb(2),s.sc(" ",e.langProvider.ShowAll," "),s.yb(3),s.dc("ngForOf",e.taskGroupsKeys))},directives:[o.B,o.zb,o.xb,o.l,o.k,o.u,o.O,a.s,o.H,o.N,o.yb,o.c,r.j,r.m],styles:[".mainFilters[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;overflow:hidden}.resetFilters[_ngcontent-%COMP%]{flex:1;width:100%;display:flex;justify-content:space-between}.filtersList[_ngcontent-%COMP%]{overflow:scroll}"]}),t})()},"m/R5":function(t,e,i){"use strict";i.r(e),i.d(e,"TaskCatalogPageModule",(function(){return P}));var s=i("ofXK"),o=i("3Pt+"),n=i("TEn/"),a=i("tyNb"),r=i("mrSG"),c=i("kLqA"),l=i("Mxx3"),b=i("hvzS"),d=i("fXoL"),h=i("3LWr"),u=i("zrcv"),g=i("NrBX"),k=i("RybT"),f=i("L5fO");const p=["slide"];function y(t,e){if(1&t){const t=d.Ob();d.Nb(0,"ion-button",10),d.Vb("click",(function(){return d.ic(t),d.Xb(3).showSearchbar()})),d.Jb(1,"ion-icon",12),d.Mb()}}function m(t,e){if(1&t){const t=d.Ob();d.Lb(0),d.Nb(1,"ion-buttons",4),d.Jb(2,"ion-menu-button"),d.Mb(),d.Nb(3,"ion-segment",5),d.Vb("ngModelChange",(function(e){return d.ic(t),d.Xb(2).segment=e}))("ionChange",(function(){return d.ic(t),d.Xb(2).updateSegment()})),d.Nb(4,"ion-segment-button",6),d.qc(5),d.Mb(),d.Nb(6,"ion-segment-button",7),d.qc(7),d.Mb(),d.Mb(),d.Nb(8,"ion-buttons",8),d.oc(9,y,2,0,"ion-button",9),d.Nb(10,"ion-button",10),d.Vb("click",(function(){return d.ic(t),d.Xb(2).showTaskFilters()})),d.Jb(11,"ion-icon",11),d.Mb(),d.Mb(),d.Kb()}if(2&t){const t=d.Xb(2);d.yb(3),d.dc("ngModel",t.segment),d.yb(2),d.sc(" ",t.langProvider.FavoriteCatalogTasks," "),d.yb(2),d.sc(" ",t.langProvider.AllCatalogTasks," "),d.yb(2),d.dc("ngIf",!t.isShowSearchbar)}}function v(t,e){if(1&t){const t=d.Ob();d.Nb(0,"ion-searchbar",13),d.Vb("ngModelChange",(function(e){return d.ic(t),d.Xb(2).searchTaskStr=e}))("ionChange",(function(){return d.ic(t),d.Xb(2).updateSearchTask()}))("ionCancel",(function(){return d.ic(t),d.Xb(2).hideSearchbar()})),d.Mb()}if(2&t){const t=d.Xb(2);d.dc("ngModel",t.searchTaskStr)}}function T(t,e){if(1&t){const t=d.Ob();d.Nb(0,"ion-item-group"),d.Nb(1,"ion-item-divider",14),d.Nb(2,"ion-label"),d.qc(3),d.Mb(),d.Mb(),d.Nb(4,"ion-item",15),d.Vb("click",(function(){d.ic(t);const e=d.Xb(2);return e.createNewTask(e.store.lastTask.value)})),d.Yb(5,"lowercase"),d.Yb(6,"async"),d.Nb(7,"ion-label"),d.Nb(8,"p"),d.qc(9),d.Yb(10,"async"),d.Mb(),d.Mb(),d.Mb(),d.Mb()}if(2&t){const t=d.Xb(2);d.yb(3),d.sc(" ",t.langProvider.LatestCatalogTasks," "),d.yb(1),d.zb("track",d.Zb(5,3,d.Zb(6,5,t.store.lastTask).type)),d.yb(5),d.rc(d.Zb(10,7,t.store.lastTask).description)}}function M(t,e){if(1&t){const t=d.Ob();d.Nb(0,"ion-icon",21),d.Vb("click",(function(e){d.ic(t);const i=d.Xb().$implicit;return d.Xb(3).changeFavorite(i,e)})),d.Mb()}}function C(t,e){if(1&t){const t=d.Ob();d.Nb(0,"ion-icon",22),d.Vb("click",(function(e){d.ic(t);const i=d.Xb().$implicit;return d.Xb(3).changeFavorite(i,e)})),d.Mb()}}function F(t,e){if(1&t){const t=d.Ob();d.Nb(0,"ion-item-sliding",null,17),d.Yb(2,"lowercase"),d.Nb(3,"ion-item",18),d.Vb("click",(function(){d.ic(t);const i=e.$implicit;return d.Xb(3).createNewTask(i)})),d.Nb(4,"ion-label"),d.Nb(5,"p"),d.qc(6),d.Mb(),d.Mb(),d.oc(7,M,1,0,"ion-icon",19),d.oc(8,C,1,0,"ion-icon",20),d.Mb(),d.Mb()}if(2&t){const t=e.$implicit;d.zb("track",d.Zb(2,5,t.type)),d.yb(3),d.dc("hidden",t.isFiltered),d.yb(3),d.rc(t.description),d.yb(1),d.dc("ngIf",!t.isFavorite),d.yb(1),d.dc("ngIf",t.isFavorite)}}function w(t,e){if(1&t&&(d.Nb(0,"ion-item-group"),d.Nb(1,"ion-item-divider",14),d.Nb(2,"ion-label"),d.qc(3),d.Mb(),d.Mb(),d.oc(4,F,9,7,"ion-item-sliding",16),d.Mb()),2&t){const t=e.$implicit,i=d.Xb(2);d.yb(3),d.sc(" ",t," "),d.yb(1),d.dc("ngForOf",i.taskGroups[t].tasks)("ngForTrackBy",i.trackByFn)}}function N(t,e){if(1&t&&(d.Lb(0),d.Nb(1,"ion-header"),d.Nb(2,"ion-toolbar"),d.oc(3,m,12,4,"ng-container",0),d.oc(4,v,1,1,"ion-searchbar",1),d.Mb(),d.Mb(),d.Nb(5,"ion-content",2),d.Nb(6,"ion-list"),d.oc(7,T,11,9,"ion-item-group",0),d.Yb(8,"async"),d.oc(9,w,5,3,"ion-item-group",3),d.Mb(),d.Mb(),d.Kb()),2&t){const t=d.Xb();d.yb(3),d.dc("ngIf",!t.isShowSearchbar),d.yb(1),d.dc("ngIf",t.isShowSearchbar),d.yb(1),d.dc("fullscreen",!0),d.yb(2),d.dc("ngIf",d.Zb(8,5,t.store.lastTask)),d.yb(2),d.dc("ngForOf",t.taskGroupsKeys)}}const S=[{path:"",component:(()=>{class t{constructor(t,e,i,s,o,n,a,r,c){this.router=t,this.route=e,this.actionCtrl=i,this.store=s,this.msgService=o,this.modalCtrl=n,this.tasksDelegator=a,this.taskDelegatorFactory=r,this.langProvider=c,this.searchTaskStr="",this.segment="favorites",this.isInit=!1}ngOnInit(){return Object(r.a)(this,void 0,void 0,(function*(){this.taskCatalog=(yield this.tasksDelegator.getCategoryConfig()).TasksCatalog,this.taskGroups=this.taskCatalog.reduce((t,e)=>(t[e.group]=t[e.group]||{isFiltered:!1,tasks:[]},t[e.group].tasks.push(e),t),Object.create(null)),this.filterTasks(),this.isInit=!0}))}ionViewWillEnter(){return Object(r.a)(this,void 0,void 0,(function*(){const t=this.route.snapshot.paramMap.get(l.a.TaskDescId);if(t){const e=yield this.tasksDelegator.getTaskDesk(t);yield this.createNewTask(e,!0)}}))}updateSearchTask(){this.filterTasks()}updateSegment(){var t;null===(t=this.slide)||void 0===t||t.closeOpened(),this.filterTasks()}showSearchbar(){this.isShowSearchbar=!0}hideSearchbar(){this.isShowSearchbar=!1,this.searchTaskStr="",this.filterTasks()}tokenizeSearchText(t){let e=null;if(""!==t.trim()){const i=t.toLowerCase().replace(/,|\.|-/g," ");""!==i&&(e=i.split(" ").filter(t=>!!t.trim().length))}return e}checkSearchDesc(t,e,i=!0){let s=!0;return e&&(s=i?e.every(e=>t.description.indexOf(e)>-1):e.some(e=>t.description.indexOf(e)>-1)),s}filterTasks(){const t=this.tokenizeSearchText(this.searchTaskStr);switch(this.segment){case"all":Object.keys(this.taskGroups).forEach(e=>{this.taskGroups[e].tasks.forEach(i=>{i.isFiltered=this.taskGroups[e].isFiltered||!this.checkSearchDesc(i,t)})});break;case"favorites":Object.keys(this.taskGroups).forEach(e=>{this.taskGroups[e].tasks.forEach(i=>{i.isFiltered=!i.isFavorite||this.taskGroups[e].isFiltered||!this.checkSearchDesc(i,t)})})}this.taskGroupsKeys=[],Object.keys(this.taskGroups).forEach(t=>{this.taskGroups[t].tasks.filter(t=>!t.isFiltered).length>0&&this.taskGroupsKeys.push(t)})}changeFavorite(t,e){return Object(r.a)(this,void 0,void 0,(function*(){e.stopImmediatePropagation(),t.isFavorite=!t.isFavorite,t.isFavorite?this.msgService.showToast(this.langProvider.FavoriteAddMsg(t.description),500,l.b.ToastSuccess):this.msgService.showToast(this.langProvider.FavoriteRemoveMsg(t.description),500,l.b.ToastWarn),yield this.tasksDelegator.updateTaskCatalog(),this.filterTasks()}))}showTaskFilters(){return Object(r.a)(this,void 0,void 0,(function*(){const t=yield this.modalCtrl.create({component:b.a,swipeToClose:!0,componentProps:{taskGroups:this.taskGroups}});yield t.present(),yield t.onWillDismiss(),this.filterTasks()}))}taskSwiped(t,e){return Object(r.a)(this,void 0,void 0,(function*(){yield this.msgService.showToast("Fully Swiped: "+t.description,500)}))}createNewTask(t,e=!1){return Object(r.a)(this,void 0,void 0,(function*(){const i=yield this.tasksDelegator.getTasksConfig(t.id);if(!e&&(i.isAlertForMultiple||i.maxItems>=1)){const e=yield this.tasksDelegator.getAllTasksByTypeImpl(t.type,t.id);let s;if(e.length>0)if(e.length>=i.maxItems){const t=yield this.actionCtrl.create({header:this.langProvider.CatalogTaskEditMaxTasksMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:()=>{s="Edit"}},{text:this.langProvider.Cancel,role:"cancel",handler:()=>{s="Cancel"}}]});yield t.present(),yield t.onWillDismiss()}else if(i.isAlertForMultiple){const t=yield this.actionCtrl.create({header:this.langProvider.CatalogTaskEditOrNewMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:()=>{s="Edit"}},{text:this.langProvider.CatalogTaskNew,role:"destructive",handler:()=>{s="New"}},{text:this.langProvider.Cancel,role:"cancel",handler:()=>{s="Cancel"}}]});yield t.present(),yield t.onWillDismiss()}else s="New";else s="New";switch(s){case"New":this.navigatoToTask(t);break;case"Edit":{const i=e.sort((t,e)=>new Date(t.date).getTime()-new Date(e.date).getTime()).reverse()[0];this.navigatoToTask(t,i._id);break}}}else this.navigatoToTask(t)}))}navigatoToTask(t,e){var i;this.store.lastTask.next(t),null===(i=this.slide)||void 0===i||i.closeOpened();const s={};s[l.a.TaskType]=t.type,s[l.a.TaskDescId]=t.id,e&&(s[l.a.SavedTaskId]=e),s[l.a.Unique]=c.Guid.raw();const o={Path:"tabs/tasks/"+this.taskDelegatorFactory.getTaskDelegator(t.type).getComponentRoute(),Params:s,NavigationExtras:{skipLocationChange:!0,replaceUrl:!0}};this.store.lastTaskNavData.next(o),this.router.navigate([o.Path,o.Params],o.NavigationExtras)}trackByFn(t,e){return e?e.id:t}}return t.\u0275fac=function(e){return new(e||t)(d.Ib(a.f),d.Ib(a.a),d.Ib(n.a),d.Ib(h.a),d.Ib(u.a),d.Ib(n.Eb),d.Ib(g.a),d.Ib(k.a),d.Ib(f.b))},t.\u0275cmp=d.Cb({type:t,selectors:[["app-task-catalog"]],viewQuery:function(t,e){var i;1&t&&d.wc(p,!0),2&t&&d.gc(i=d.Wb())&&(e.slide=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],["class","searchbar","showCancelButton","always",3,"ngModel","ngModelChange","ionChange","ionCancel",4,"ngIf"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["slot","start"],[3,"ngModel","ngModelChange","ionChange"],["value","favorites"],["value","all"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","options"],["slot","icon-only","name","search"],["showCancelButton","always",1,"searchbar",3,"ngModel","ngModelChange","ionChange","ionCancel"],["sticky","",1,"itemGroup"],["button","",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["slide",""],["button","",3,"hidden","click"],["slot","end","name","star-outline",3,"click",4,"ngIf"],["slot","end","name","star","color","primary",3,"click",4,"ngIf"],["slot","end","name","star-outline",3,"click"],["slot","end","name","star","color","primary",3,"click"]],template:function(t,e){1&t&&d.oc(0,N,10,7,"ng-container",0),2&t&&d.dc("ngIf",e.isInit)},directives:[s.t,n.B,n.zb,n.u,n.O,s.s,n.l,n.R,n.ib,n.Mb,o.j,o.m,n.jb,n.k,n.C,n.hb,n.Nb,n.J,n.I,n.N,n.H,n.M],pipes:[s.b,s.p],styles:[".itemGroup[_ngcontent-%COMP%]{font-weight:700;--color:var(--ion-color-favorite)}.searchbar[_ngcontent-%COMP%]{background:var(--ion-color-light)}"]}),t})()},{path:"task-catalog-filter",loadChildren:()=>Promise.resolve().then(i.bind(null,"QiNc")).then(t=>t.TaskCatalogFilterPageModule)}];let O=(()=>{class t{}return t.\u0275mod=d.Gb({type:t}),t.\u0275inj=d.Fb({factory:function(e){return new(e||t)},imports:[[a.j.forChild(S)],a.j]}),t})();var G=i("QiNc");let P=(()=>{class t{}return t.\u0275mod=d.Gb({type:t}),t.\u0275inj=d.Fb({factory:function(e){return new(e||t)},imports:[[s.c,o.e,n.Bb,O,G.TaskCatalogFilterPageModule]]}),t})()}}]);