!function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{QiNc:function(e,t,i){"use strict";i.r(t),i.d(t,"TaskCatalogFilterPageModule",function(){return g});var r,a,s=i("ofXK"),o=i("3Pt+"),c=i("TEn/"),l=i("tyNb"),u=i("hvzS"),b=i("fXoL"),h=[{path:"",component:u.a}],f=((a=function e(){n(this,e)}).\u0275fac=function(e){return new(e||a)},a.\u0275mod=b.Ib({type:a}),a.\u0275inj=b.Hb({imports:[[l.h.forChild(h)],l.h]}),a),g=((r=function e(){n(this,e)}).\u0275fac=function(e){return new(e||r)},r.\u0275mod=b.Ib({type:r}),r.\u0275inj=b.Hb({imports:[[s.c,o.a,c.bb,f]]}),r)},hvzS:function(e,i,r){"use strict";r.d(i,"a",function(){return b});var a=r("fXoL"),s=r("TEn/"),o=r("L5fO"),c=r("ofXK"),l=r("3Pt+");function u(e,t){if(1&e){var n=a.Rb();a.Qb(0,"ion-item"),a.Qb(1,"ion-label"),a.sc(2),a.Pb(),a.Qb(3,"ion-toggle",9),a.Yb("ngModelChange",function(e){a.lc(n);var i=t.$implicit;return a.ac().taskGroups[i].isFiltered=!e}),a.Pb(),a.Pb()}if(2&e){var i=t.$implicit,r=a.ac();a.Ab(2),a.tc(i),a.Ab(1),a.gc("ngModel",!r.taskGroups[i].isFiltered)}}var b=function(){var e=function(){function e(t,i){n(this,e),this.modalCtrl=t,this.langProvider=i}return t(e,[{key:"ngOnInit",value:function(){this.taskGroupsKeys=Object.keys(this.taskGroups)}},{key:"resetFilters",value:function(){var e=this;Object.keys(this.taskGroups).forEach(function(t){return e.taskGroups[t].isFiltered=!1})}},{key:"shutdownFilters",value:function(){var e=this;Object.keys(this.taskGroups).forEach(function(t){return e.taskGroups[t].isFiltered=!0})}},{key:"applyFilters",value:function(){this.modalCtrl.dismiss("koko")}},{key:"dismissFilters",value:function(){this.modalCtrl.dismiss("koko")}},{key:"changeFilterStatus",value:function(e){this.taskGroups[e].isFiltered=!this.taskGroups[e].isFiltered}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Kb(s.eb),a.Kb(o.b))},e.\u0275cmp=a.Eb({type:e,selectors:[["app-task-catalog-filter"]],inputs:{taskGroups:"taskGroups"},decls:15,vars:5,consts:[["translucent","true"],["slot","end"],["strong","",3,"click"],[1,"mainFilters",3,"fullscreen"],[1,"resetFilters"],["slot","start","color","danger","fill","clear",3,"click"],["slot","end","color","success","fill","clear",3,"click"],[1,"filtersList"],[4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(a.Qb(0,"ion-header",0),a.Qb(1,"ion-toolbar"),a.Lb(2,"ion-title"),a.Qb(3,"ion-buttons",1),a.Qb(4,"ion-button",2),a.Yb("click",function(){return t.applyFilters()}),a.sc(5),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Qb(6,"ion-content",3),a.Qb(7,"ion-toolbar",4),a.Qb(8,"ion-button",5),a.Yb("click",function(){return t.shutdownFilters()}),a.sc(9),a.Pb(),a.Qb(10,"ion-button",6),a.Yb("click",function(){return t.resetFilters()}),a.sc(11),a.Pb(),a.Pb(),a.Qb(12,"div",7),a.Qb(13,"ion-list"),a.qc(14,u,4,2,"ion-item",8),a.Pb(),a.Pb(),a.Pb()),2&e&&(a.Ab(5),a.tc(t.langProvider.Done),a.Ab(1),a.gc("fullscreen",!0),a.Ab(3),a.uc(" ",t.langProvider.ShutdownAll," "),a.Ab(2),a.uc(" ",t.langProvider.ShowAll," "),a.Ab(3),a.gc("ngForOf",t.taskGroupsKeys))},directives:[s.s,s.Z,s.X,s.k,s.j,s.n,s.D,c.l,s.w,s.C,s.Y,s.c,l.e,l.h],styles:[".mainFilters[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:hidden;width:100%}.resetFilters[_ngcontent-%COMP%]{display:flex;flex:1;justify-content:space-between;width:100%}.filtersList[_ngcontent-%COMP%]{overflow:scroll}"]}),e}()},"m/R5":function(e,i,r){"use strict";r.r(i),r.d(i,"TaskCatalogPageModule",function(){return E});var a=r("ofXK"),s=r("3Pt+"),o=r("TEn/"),c=r("tyNb"),l=r("mrSG"),u=r("kLqA"),b=r("Mxx3"),h=r("hvzS"),f=r("fXoL"),g=r("3LWr"),k=r("zrcv"),d=r("NrBX"),v=r("RybT"),p=r("L5fO"),m=r("Ueei"),y=["slide"];function P(e,t){if(1&e){var n=f.Rb();f.Qb(0,"ion-button",10),f.Yb("click",function(){return f.lc(n),f.ac(3).showSearchbar()}),f.Lb(1,"ion-icon",12),f.Pb()}}function w(e,t){if(1&e){var n=f.Rb();f.Ob(0),f.Qb(1,"ion-buttons",4),f.Lb(2,"ion-menu-button"),f.Pb(),f.Qb(3,"ion-segment",5),f.Yb("ngModelChange",function(e){return f.lc(n),f.ac(2).segment=e})("ionChange",function(){return f.lc(n),f.ac(2).updateSegment()}),f.Qb(4,"ion-segment-button",6),f.sc(5),f.Pb(),f.Qb(6,"ion-segment-button",7),f.sc(7),f.Pb(),f.Pb(),f.Qb(8,"ion-buttons",8),f.qc(9,P,2,0,"ion-button",9),f.Qb(10,"ion-button",10),f.Yb("click",function(){return f.lc(n),f.ac(2).showTaskFilters()}),f.Lb(11,"ion-icon",11),f.Pb(),f.Pb(),f.Nb()}if(2&e){var i=f.ac(2);f.Ab(3),f.gc("ngModel",i.segment),f.Ab(2),f.uc(" ",i.langProvider.FavoriteCatalogTasks," "),f.Ab(2),f.uc(" ",i.langProvider.AllCatalogTasks," "),f.Ab(2),f.gc("ngIf",!i.isShowSearchbar)}}function T(e,t){if(1&e){var n=f.Rb();f.Qb(0,"ion-searchbar",13),f.Yb("ngModelChange",function(e){return f.lc(n),f.ac(2).searchTaskStr=e})("ionChange",function(){return f.lc(n),f.ac(2).updateSearchTask()})("ionCancel",function(){return f.lc(n),f.ac(2).hideSearchbar()}),f.Pb()}if(2&e){var i=f.ac(2);f.gc("ngModel",i.searchTaskStr)}}function C(e,t){if(1&e){var n=f.Rb();f.Qb(0,"ion-item-group"),f.Qb(1,"ion-item-divider",14),f.Qb(2,"ion-label"),f.sc(3),f.Pb(),f.Pb(),f.Qb(4,"ion-item",15),f.Yb("click",function(){f.lc(n);var e=f.ac(2);return e.createNewTask(e.store.lastTask.value)}),f.bc(5,"lowercase"),f.bc(6,"async"),f.Qb(7,"ion-label"),f.Qb(8,"p"),f.sc(9),f.bc(10,"async"),f.Pb(),f.Pb(),f.Pb(),f.Pb()}if(2&e){var i=f.ac(2);f.Ab(3),f.uc(" ",i.langProvider.LatestCatalogTasks," "),f.Ab(1),f.Bb("track",f.cc(5,3,f.cc(6,5,i.store.lastTask).type)),f.Ab(5),f.tc(f.cc(10,7,i.store.lastTask).description)}}function F(e,t){if(1&e){var n=f.Rb();f.Qb(0,"ion-icon",21),f.Yb("click",function(e){f.lc(n);var t=f.ac().$implicit;return f.ac(3).changeFavorite(t,e)}),f.Pb()}}function x(e,t){if(1&e){var n=f.Rb();f.Qb(0,"ion-icon",22),f.Yb("click",function(e){f.lc(n);var t=f.ac().$implicit;return f.ac(3).changeFavorite(t,e)}),f.Pb()}}function S(e,t){if(1&e){var n=f.Rb();f.Qb(0,"ion-item-sliding",null,17),f.bc(2,"lowercase"),f.Qb(3,"ion-item",18),f.Yb("click",function(){f.lc(n);var e=t.$implicit;return f.ac(3).createNewTask(e)}),f.Qb(4,"ion-label"),f.Qb(5,"p"),f.sc(6),f.Pb(),f.Pb(),f.qc(7,F,1,0,"ion-icon",19),f.qc(8,x,1,0,"ion-icon",20),f.Pb(),f.Pb()}if(2&e){var i=t.$implicit;f.Bb("track",f.cc(2,5,i.type)),f.Ab(3),f.gc("hidden",i.isFiltered),f.Ab(3),f.tc(i.description),f.Ab(1),f.gc("ngIf",!i.isFavorite),f.Ab(1),f.gc("ngIf",i.isFavorite)}}function Q(e,t){if(1&e&&(f.Qb(0,"ion-item-group"),f.Qb(1,"ion-item-divider",14),f.Qb(2,"ion-label"),f.sc(3),f.Pb(),f.Pb(),f.qc(4,S,9,7,"ion-item-sliding",16),f.Pb()),2&e){var n=t.$implicit,i=f.ac(2);f.Ab(3),f.uc(" ",n," "),f.Ab(1),f.gc("ngForOf",i.taskGroups[n].tasks)("ngForTrackBy",i.trackByFn)}}function O(e,t){if(1&e&&(f.Ob(0),f.Qb(1,"ion-header"),f.Qb(2,"ion-toolbar"),f.qc(3,w,12,4,"ng-container",0),f.qc(4,T,1,1,"ion-searchbar",1),f.Pb(),f.Pb(),f.Qb(5,"ion-content",2),f.Qb(6,"ion-list"),f.qc(7,C,11,9,"ion-item-group",0),f.bc(8,"async"),f.qc(9,Q,5,3,"ion-item-group",3),f.Pb(),f.Pb(),f.Nb()),2&e){var n=f.ac();f.Ab(3),f.gc("ngIf",!n.isShowSearchbar),f.Ab(1),f.gc("ngIf",n.isShowSearchbar),f.Ab(1),f.gc("fullscreen",!0),f.Ab(2),f.gc("ngIf",f.cc(8,5,n.store.lastTask)),f.Ab(2),f.gc("ngForOf",n.taskGroupsKeys)}}var G,A,M,I=[{path:"",component:(G=function(){function e(t,i,r,a,s,o,c,l,u,b){n(this,e),this.router=t,this.route=i,this.actionCtrl=r,this.store=a,this.msgService=s,this.modalCtrl=o,this.tasksDelegator=c,this.taskDelegatorFactory=l,this.langProvider=u,this.backupService=b,this.searchTaskStr="",this.segment="favorites",this.isInit=!1}return t(e,[{key:"ngOnInit",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tasksDelegator.getCategoryConfig();case 2:this.taskCatalog=e.sent.TasksCatalog,this.taskGroups=this.taskCatalog.reduce(function(e,t){return e[t.group]=e[t.group]||{isFiltered:!1,tasks:[]},e[t.group].tasks.push(t),e},Object.create(null)),this.filterTasks(),this.isInit=!0;case 6:case"end":return e.stop()}},e,this)}))}},{key:"ionViewWillEnter",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.backupService.checkBackupNeeded(),!(t=this.route.snapshot.paramMap.get(b.a.TaskDescId))){e.next=8;break}return e.next=5,this.tasksDelegator.getTaskDesk(t);case 5:return n=e.sent,e.next=8,this.createNewTask(n,!0);case 8:case"end":return e.stop()}},e,this)}))}},{key:"updateSearchTask",value:function(){this.filterTasks()}},{key:"updateSegment",value:function(){var e;null===(e=this.slide)||void 0===e||e.closeOpened(),this.filterTasks()}},{key:"showSearchbar",value:function(){this.isShowSearchbar=!0}},{key:"hideSearchbar",value:function(){this.isShowSearchbar=!1,this.searchTaskStr="",this.filterTasks()}},{key:"tokenizeSearchText",value:function(e){var t=null;if(""!==e.trim()){var n=e.toLowerCase().replace(/,|\.|-/g," ");""!==n&&(t=n.split(" ").filter(function(e){return!!e.trim().length}))}return t}},{key:"checkSearchDesc",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!0;return t&&(i=n?t.every(function(t){return e.description.indexOf(t)>-1}):t.some(function(t){return e.description.indexOf(t)>-1})),i}},{key:"filterTasks",value:function(){var e=this,t=this.tokenizeSearchText(this.searchTaskStr);switch(this.segment){case"all":Object.keys(this.taskGroups).forEach(function(n){e.taskGroups[n].tasks.forEach(function(i){i.isFiltered=e.taskGroups[n].isFiltered||!e.checkSearchDesc(i,t)})});break;case"favorites":Object.keys(this.taskGroups).forEach(function(n){e.taskGroups[n].tasks.forEach(function(i){i.isFiltered=!i.isFavorite||e.taskGroups[n].isFiltered||!e.checkSearchDesc(i,t)})})}this.taskGroupsKeys=[],Object.keys(this.taskGroups).forEach(function(t){e.taskGroups[t].tasks.filter(function(e){return!e.isFiltered}).length>0&&e.taskGroupsKeys.push(t)})}},{key:"changeFavorite",value:function(e,t){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stopImmediatePropagation(),e.isFavorite=!e.isFavorite,e.isFavorite?this.msgService.showToast(this.langProvider.FavoriteAddMsg(e.description),500,b.b.ToastSuccess):this.msgService.showToast(this.langProvider.FavoriteRemoveMsg(e.description),500,b.b.ToastWarn),n.next=5,this.tasksDelegator.updateTaskCatalog();case 5:this.filterTasks();case 6:case"end":return n.stop()}},n,this)}))}},{key:"showTaskFilters",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:h.a,swipeToClose:!0,componentProps:{taskGroups:this.taskGroups}});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.next=7,t.onWillDismiss();case 7:this.filterTasks();case 8:case"end":return e.stop()}},e,this)}))}},{key:"taskSwiped",value:function(e,t){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.msgService.showToast("Fully Swiped: ".concat(e.description),500);case 2:case"end":return t.stop()}},t,this)}))}},{key:"createNewTask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r,a,s,o,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.tasksDelegator.getTasksConfig(e.id);case 2:if(i=n.sent,t||!(i.isAlertForMultiple||i.maxItems>=1)){n.next=42;break}return n.next=6,this.tasksDelegator.getAllTasksByTypeImpl(e.type,e.id);case 6:if(!((r=n.sent).length>0)){n.next=31;break}if(!(r.length>=i.maxItems)){n.next=18;break}return n.next=11,this.actionCtrl.create({header:this.langProvider.CatalogTaskEditMaxTasksMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:function(){a="Edit"}},{text:this.langProvider.Cancel,role:"cancel",handler:function(){a="Cancel"}}]});case 11:return s=n.sent,n.next=14,s.present();case 14:return n.next=16,s.onWillDismiss();case 16:n.next=29;break;case 18:if(!i.isAlertForMultiple){n.next=28;break}return n.next=21,this.actionCtrl.create({header:this.langProvider.CatalogTaskEditOrNewMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:function(){a="Edit"}},{text:this.langProvider.CatalogTaskNew,role:"destructive",handler:function(){a="New"}},{text:this.langProvider.Cancel,role:"cancel",handler:function(){a="Cancel"}}]});case 21:return o=n.sent,n.next=24,o.present();case 24:return n.next=26,o.onWillDismiss();case 26:n.next=29;break;case 28:a="New";case 29:n.next=32;break;case 31:a="New";case 32:n.t0=a,n.next="New"===n.t0?35:"Edit"===n.t0?37:40;break;case 35:return this.navigatoToTask(e),n.abrupt("break",40);case 37:return c=r.sort(function(e,t){return new Date(e.date).getTime()-new Date(t.date).getTime()}).reverse()[0],this.navigatoToTask(e,c._id),n.abrupt("break",40);case 40:n.next=43;break;case 42:this.navigatoToTask(e);case 43:case"end":return n.stop()}},n,this)}))}},{key:"navigatoToTask",value:function(e,t){var n;this.store.lastTask.next(e),null===(n=this.slide)||void 0===n||n.closeOpened();var i={};i[b.a.TaskType]=e.type,i[b.a.TaskDescId]=e.id,t&&(i[b.a.SavedTaskId]=t),i[b.a.Unique]=u.Guid.raw();var r={Path:"tabs/tasks/".concat(this.taskDelegatorFactory.getTaskDelegator(e.type).getComponentRoute()),Params:i,NavigationExtras:{skipLocationChange:!0,replaceUrl:!0}};this.store.lastTaskNavData.next(r),this.router.navigate([r.Path,r.Params],r.NavigationExtras)}},{key:"trackByFn",value:function(e,t){return t?t.id:e}}]),e}(),G.\u0275fac=function(e){return new(e||G)(f.Kb(c.f),f.Kb(c.a),f.Kb(o.a),f.Kb(g.a),f.Kb(k.a),f.Kb(o.eb),f.Kb(d.a),f.Kb(v.a),f.Kb(p.b),f.Kb(m.a))},G.\u0275cmp=f.Eb({type:G,selectors:[["app-task-catalog"]],viewQuery:function(e,t){var n;1&e&&f.yc(y,1),2&e&&f.jc(n=f.Zb())&&(t.slide=n.first)},decls:1,vars:1,consts:[[4,"ngIf"],["class","searchbar","showCancelButton","always",3,"ngModel","ngModelChange","ionChange","ionCancel",4,"ngIf"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["slot","start"],[3,"ngModel","ngModelChange","ionChange"],["value","favorites"],["value","all"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","options"],["slot","icon-only","name","search"],["showCancelButton","always",1,"searchbar",3,"ngModel","ngModelChange","ionChange","ionCancel"],["sticky","",1,"itemGroup"],["button","",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["slide",""],["button","",3,"hidden","click"],["slot","end","name","star-outline",3,"click",4,"ngIf"],["slot","end","name","star","color","primary",3,"click",4,"ngIf"],["slot","end","name","star-outline",3,"click"],["slot","end","name","star","color","primary",3,"click"]],template:function(e,t){1&e&&f.qc(0,O,10,7,"ng-container",0),2&e&&f.gc("ngIf",t.isInit)},directives:[a.m,o.s,o.Z,o.n,o.D,a.l,o.k,o.F,o.O,o.kb,s.e,s.h,o.P,o.j,o.t,o.N,o.lb,o.y,o.x,o.C,o.w,o.B],pipes:[a.b,a.k],styles:[".itemGroup[_ngcontent-%COMP%]{--color:var(--ion-color-favorite);font-weight:700}.searchbar[_ngcontent-%COMP%]{background:var(--ion-color-light)}"]}),G)},{path:"task-catalog-filter",loadChildren:function(){return Promise.resolve().then(r.bind(null,"QiNc")).then(function(e){return e.TaskCatalogFilterPageModule})}}],D=((A=function e(){n(this,e)}).\u0275fac=function(e){return new(e||A)},A.\u0275mod=f.Ib({type:A}),A.\u0275inj=f.Hb({imports:[[c.h.forChild(I)],c.h]}),A),R=r("QiNc"),E=((M=function e(){n(this,e)}).\u0275fac=function(e){return new(e||M)},M.\u0275mod=f.Ib({type:M}),M.\u0275inj=f.Hb({imports:[[a.c,s.a,o.bb,D,R.TaskCatalogFilterPageModule]]}),M)}}])}();