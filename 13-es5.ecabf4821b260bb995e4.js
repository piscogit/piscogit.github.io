!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{OrUu:function(e,i,r){"use strict";r.r(i),r.d(i,"TasksHistoryPageModule",(function(){return j}));var a,s=r("ofXK"),o=r("3Pt+"),c=r("TEn/"),u=r("tyNb"),l=r("mrSG"),b=r("Mxx3"),h=r("fXoL"),p=r("zrcv"),d=((a=function(){function e(n,i){t(this,e),this.popupCtrl=n,this.msgService=i}return n(e,[{key:"ngOnInit",value:function(){}},{key:"copy",value:function(){this.msgService.copyToClipboard(this.msg),this.msgService.showToast("Copy to clipboard",1e3),this.popupCtrl.dismiss()}},{key:"whatsapp",value:function(){var t=document.createElement("a");t.href="whatsapp://send?text="+this.msg,t["data-action"]="share/whatsapp/share",t.click(),this.popupCtrl.dismiss()}}]),e}()).\u0275fac=function(t){return new(t||a)(h.Ib(c.ib),h.Ib(p.a))},a.\u0275cmp=h.Cb({type:a,selectors:[["app-share-data"]],inputs:{msg:"msg"},decls:5,vars:0,consts:[[1,"container"],["color","light",3,"click"],["color","primary","name","copy",1,"sicon"],["color","primary","name","logo-whatsapp",1,"sicon"]],template:function(t,e){1&t&&(h.Nb(0,"div",0),h.Nb(1,"ion-button",1),h.Vb("click",(function(){return e.copy()})),h.Jb(2,"ion-icon",2),h.Mb(),h.Nb(3,"ion-button",1),h.Vb("click",(function(){return e.whatsapp()})),h.Jb(4,"ion-icon",3),h.Mb(),h.Mb())},directives:[c.j,c.t],styles:[".container[_ngcontent-%COMP%]{display:flex}.sicon[_ngcontent-%COMP%]{font-size:x-large}"]}),a),f=r("3LWr"),g=r("ufmx"),v=r("NrBX"),k=r("L5fO"),m=r("RybT"),y=r("VVJX");function w(t,e){}var C,x=((C=function(){function e(n,i){t(this,e),this.componentFactoryResolver=n,this.taskDelegatorFactory=i}return n(e,[{key:"ngOnInit",value:function(){var t=this.taskDelegatorFactory.getTaskDelegator(this.task.type).getHistoryComponent();if(t){var e=this.componentFactoryResolver.resolveComponentFactory(t),n=this.taskHost.viewContainerRef;n.clear();var i=n.createComponent(e);i.instance.task=this.task,i.instance.candidates=this.candidates,this.componentRef=i}}},{key:"ngOnChanges",value:function(t){this.componentRef&&(this.componentRef.instance.task=this.task,this.componentRef.instance.candidates=this.candidates,this.componentRef.instance.calcHistory())}}]),e}()).\u0275fac=function(t){return new(t||C)(h.Ib(h.j),h.Ib(m.a))},C.\u0275cmp=h.Cb({type:C,selectors:[["app-task-history-host"]],viewQuery:function(t,e){var n;1&t&&h.lc(y.a,!0),2&t&&h.gc(n=h.Wb())&&(e.taskHost=n.first)},inputs:{task:"task",candidates:"candidates"},features:[h.wb],decls:1,vars:0,consts:[["appTaskHost",""]],template:function(t,e){1&t&&h.nc(0,w,0,0,"ng-template",0)},directives:[y.a],styles:[""]}),C);function M(t,e){if(1&t){var n=h.Ob();h.Nb(0,"ion-button",6),h.Vb("click",(function(){return h.ic(n),h.Xb(3).showSearchbar(!0)})),h.Jb(1,"ion-icon",8),h.Mb()}}function T(t,e){if(1&t){var n=h.Ob();h.Lb(0),h.Nb(1,"ion-buttons",3),h.Jb(2,"ion-menu-button"),h.Mb(),h.Nb(3,"ion-title"),h.pc(4),h.Mb(),h.Nb(5,"ion-buttons",4),h.nc(6,M,2,0,"ion-button",5),h.Nb(7,"ion-button",6),h.Vb("click",(function(){return h.ic(n),h.Xb(2).showTaskFilters()})),h.Jb(8,"ion-icon",7),h.Mb(),h.Mb(),h.Kb()}if(2&t){var i=h.Xb(2);h.yb(3),h.mc("direction",i.langProvider.LangDirection),h.yb(1),h.qc(i.langProvider.TasksHistory),h.yb(2),h.dc("ngIf",!i.isShowSearchbar)}}function I(t,e){if(1&t){var n=h.Ob();h.Nb(0,"ion-searchbar",9),h.Vb("ngModelChange",(function(t){return h.ic(n),h.Xb(2).searchTaskStr=t}))("ionChange",(function(){return h.ic(n),h.Xb(2).updateSearchTask()}))("ionCancel",(function(){return h.ic(n),h.Xb(2).showSearchbar(!1)})),h.Mb()}if(2&t){var i=h.Xb(2);h.dc("ngModel",i.searchTaskStr)}}function D(t,e){if(1&t){var n=h.Ob();h.Nb(0,"ion-item-sliding",null,10),h.Yb(2,"lowercase"),h.Nb(3,"ion-item-options",11),h.Nb(4,"ion-item-option",12),h.Vb("click",(function(){h.ic(n);var t=e.$implicit,i=h.hc(1);return h.Xb(2).onDeleted(t,i)})),h.Jb(5,"ion-icon",13),h.Mb(),h.Nb(6,"ion-item-option",12),h.Vb("click",(function(t){h.ic(n);var i=e.$implicit,r=h.hc(1);return h.Xb(2).onCopyExport(i,r,t)})),h.Jb(7,"ion-icon",14),h.Mb(),h.Mb(),h.Nb(8,"ion-item",15),h.Vb("click",(function(){h.ic(n);var t=e.$implicit;return h.Xb(2).onEdit(t)})),h.Nb(9,"ion-label"),h.Nb(10,"h3",16),h.Nb(11,"span"),h.pc(12),h.Mb(),h.Nb(13,"span",17),h.pc(14),h.Yb(15,"date"),h.Mb(),h.Mb(),h.Jb(16,"app-task-history-host",18),h.Mb(),h.Mb(),h.Mb()}if(2&t){var i=e.$implicit,r=h.Xb(2);h.zb("track",h.Zb(2,7,i.type)),h.yb(9),h.mc("direction",r.langProvider.LangDirection),h.yb(3),h.qc(i.name),h.yb(2),h.qc(h.ac(15,9,i.date,"dd/MM/yy HH:mm:ss")),h.yb(2),h.dc("task",i)("candidates",r.candidates)}}function N(t,e){if(1&t&&(h.Lb(0),h.Nb(1,"ion-header"),h.Nb(2,"ion-toolbar"),h.nc(3,T,9,4,"ng-container",0),h.nc(4,I,1,1,"ion-searchbar",1),h.Mb(),h.Mb(),h.Nb(5,"ion-content"),h.Nb(6,"ion-list"),h.nc(7,D,17,12,"ion-item-sliding",2),h.Mb(),h.Mb(),h.Kb()),2&t){var n=h.Xb();h.yb(3),h.dc("ngIf",!n.isShowSearchbar),h.yb(1),h.dc("ngIf",n.isShowSearchbar),h.yb(3),h.dc("ngForOf",n.tasksHistory)("ngForTrackBy",n.trackByFn)}}var O,S,P,R=[{path:"",component:(O=function(){function e(n,i,r,a,s,o,c,u,l,b){t(this,e),this.router=n,this.store=i,this.candidatesDelegator=r,this.tasksDelegator=a,this.langProvider=s,this.msgService=o,this.popupCtrl=c,this.loadingCtrl=u,this.alertController=l,this.taskDelegatorFactory=b,this.subscription={},this.isInit=!1}return n(e,[{key:"ngOnInit",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.candidatesDelegator.getCandidatesCopy();case 2:this.candidates=t.sent,this.subscription.lastTasksChangeTime=this.store.lastTasksChangeTime.subscribe((function(t){return Object(l.a)(e,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.loadTasks();case 1:case"end":return t.stop()}}),t,this)})))})),this.isInit=!0;case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnDestroy",value:function(){for(var t in this.subscription)Object.prototype.hasOwnProperty.call(this.subscription,t)&&this.subscription[t].unsubscribe()}},{key:"ionViewWillEnter",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))}},{key:"loadTasks",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.msgService.showLoader();case 3:return e=t.sent,t.next=6,this.tasksDelegator.getAllTasks();case 6:n=t.sent.sort((function(t,e){var n=new Date(t.date).getTime();return new Date(e.date).getTime()-n})),this.tasksHistory=n;case 8:return t.prev=8,e.dismiss(),t.finish(8);case 11:case"end":return t.stop()}}),t,this,[[0,,8,11]])})))}},{key:"onEdit",value:function(t){var e=this.taskDelegatorFactory.getTaskDelegator(t.type),n={};n[b.a.TaskDescId]=t.taskId,n[b.a.SavedTaskId]=t._id;var i={Path:"tabs/tasks/"+e.getComponentRoute(),Params:n,NavigationExtras:{skipLocationChange:!0,replaceUrl:!0}};this.store.lastTaskNavData.next(i),this.router.navigate([i.Path,i.Params],i.NavigationExtras)}},{key:"onCopyExport",value:function(t,e,n){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var r,a,s;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=this.taskDelegatorFactory.getTaskDelegator(t.type),i.prev=1,i.next=4,r.exportCopy(t._id,t.taskId);case 4:return a=i.sent,i.next=7,this.popupCtrl.create({component:d,event:n,componentProps:{msg:a}});case 7:return s=i.sent,i.next=10,s.present();case 10:return i.next=12,s.onWillDismiss();case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(1),this.msgService.showToast("Cant export this task type to clipboard",1e3,"toastWarn");case 17:e.closeOpened();case 18:case"end":return i.stop()}}),i,this,[[1,14]])})))}},{key:"onDeleted",value:function(t,e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,r,a,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.closeOpened(),i=!1,n.next=4,this.alertController.create({cssClass:[this.langProvider.LangDirection],header:this.langProvider.AreYouSure,subHeader:this.langProvider.TaskDeleteWarnMsg,buttons:[{text:this.langProvider.Cancel,role:"cancel",cssClass:"secondary"},{text:this.langProvider.Activate,role:"destructive",cssClass:"danger",handler:function(){return i=!0}}]});case 4:return r=n.sent,n.next=7,r.present();case 7:return n.next=9,r.onWillDismiss();case 9:if(!i){n.next=24;break}return a=this.taskDelegatorFactory.getTaskDelegator(t.type),n.next=13,this.loadingCtrl.create({message:"temp delete task"});case 13:return s=n.sent,n.next=16,s.present();case 16:return n.next=18,a.deleteTask(t);case 18:return n.next=20,this.loadTasks();case 20:return n.next=22,s.dismiss();case 22:return n.next=24,s.onDidDismiss();case 24:case"end":return n.stop()}}),n,this)})))}},{key:"showSearchbar",value:function(t){}},{key:"showTaskFilters",value:function(){}},{key:"updateSearchTask",value:function(){}},{key:"trackByFn",value:function(t,e){return e?e._id:t}},{key:"temp",value:function(t){console.log(t._id)}}]),e}(),O.\u0275fac=function(t){return new(t||O)(h.Ib(u.f),h.Ib(f.a),h.Ib(g.a),h.Ib(v.a),h.Ib(k.b),h.Ib(p.a),h.Ib(c.ib),h.Ib(c.cb),h.Ib(c.b),h.Ib(m.a))},O.\u0275cmp=h.Cb({type:O,selectors:[["app-tasks-history"]],viewQuery:function(t,e){var n;1&t&&h.vc(c.ab,!0),2&t&&h.gc(n=h.Wb())&&(e.virtualScroll=n.first)},decls:1,vars:1,consts:[[4,"ngIf"],["class","searchbar","showCancelButton","always",3,"ngModel","ngModelChange","ionChange","ionCancel",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["slot","start"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","options"],["slot","icon-only","name","search"],["showCancelButton","always",1,"searchbar",3,"ngModel","ngModelChange","ionChange","ionCancel"],["slide",""],["side","end"],["color","light",3,"click"],["name","trash","color","danger",1,"htBtn"],["name","share-social","color","primary",1,"htBtn"],["button","",3,"click"],[1,"taskHistory"],[2,"direction","ltr"],[3,"task","candidates"]],template:function(t,e){1&t&&h.nc(0,N,8,4,"ng-container",0),2&t&&h.dc("ngIf",e.isInit)},directives:[s.m,c.s,c.Z,c.n,c.D,s.l,c.k,c.F,c.X,c.j,c.t,c.N,c.lb,o.d,o.g,c.B,c.A,c.z,c.w,c.C,x],pipes:[s.k,s.e],styles:[".taskHistory[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.htBtn[_ngcontent-%COMP%]{font-size:x-large}"]}),O)}],F=((S=function e(){t(this,e)}).\u0275mod=h.Gb({type:S}),S.\u0275inj=h.Fb({factory:function(t){return new(t||S)},imports:[[u.h.forChild(R)],u.h]}),S),X=r("ajeZ"),j=((P=function e(){t(this,e)}).\u0275mod=h.Gb({type:P}),P.\u0275inj=h.Fb({factory:function(t){return new(t||P)},imports:[[s.c,o.a,c.bb,X.a,F]]}),P)}}])}();