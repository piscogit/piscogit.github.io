!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{LTzM:function(e,i,r){"use strict";r.r(i),r.d(i,"CreateCommentPageModule",(function(){return _}));var o=r("ofXK"),s=r("3Pt+"),c=r("TEn/"),d=r("tyNb"),m=r("mrSG"),l=r("Mxx3"),u=r("+Ff3"),b=r("fXoL"),h=r("NrBX"),f=r("nTzd"),v=r("ufmx"),g=r("zrcv"),p=r("L5fO"),C=r("3LWr"),k=r("5+WD"),y=r("g1yl");function D(t,e){if(1&t&&b.Jb(0,"app-candidate-avatar",19),2&t){var n=b.Xb().$implicit,a=b.Xb();b.dc("candidate",n)("isSelected",a.selectedCandidates[n._id])}}function M(t,e){if(1&t&&b.Jb(0,"app-candidate-avatar",19),2&t){var n=b.Xb().$implicit,a=b.Xb();b.dc("candidate",n)("isSelected",a.selectedCandidates[n._id])}}function w(t,e){1&t&&b.Jb(0,"span",20)}function x(t,e){if(1&t){var n=b.Ob();b.Nb(0,"div",13),b.Nb(1,"ion-item",14),b.Vb("click",(function(){b.ic(n);var t=e.$implicit;return b.Xb().selectCandidate(t)})),b.Jb(2,"app-candidate-avatar",15),b.nc(3,D,1,2,"app-candidate-avatar",16),b.nc(4,M,1,2,"app-candidate-avatar",17),b.Mb(),b.nc(5,w,1,0,"span",18),b.Mb()}if(2&t){var a=e.$implicit,i=b.Xb();b.yb(1),b.dc("cdkDragStartDelay",i.dragDelay),b.yb(1),b.dc("candidate",a)("isSelected",i.selectedCandidates[a._id]),b.yb(3),b.dc("ngIf",i.store.isIos)}}function S(t,e){if(1&t){var n=b.Ob();b.Nb(0,"ion-item",21),b.Vb("click",(function(){b.ic(n);var t=e.$implicit;return b.Xb().savedCommentSelected(t)})),b.Nb(1,"ion-label"),b.Nb(2,"span"),b.pc(3),b.Mb(),b.Mb(),b.Mb()}if(2&t){var a=e.$implicit;b.yb(3),b.qc(a.comment)}}var P,O,N,I=[{path:"",component:(P=function(){function e(t,a,i,r,o,s,c,d,m){n(this,e),this.navCtrl=t,this.route=a,this.router=i,this.tasksDelegator=r,this.tasksCommentsDelegator=o,this.candidatesDelegator=s,this.msgService=c,this.langProvider=d,this.store=m,this.selectedCandidates={},this.dragDelay=l.a.DragDelay,this.title=this.langProvider.GeneralComment,this.isInit=!1}var i,r,o;return i=e,(r=[{key:"ngOnInit",value:function(){var e,n,a;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var r,o,s=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.candidatesDelegator.getCandidatesCopy(!0);case 2:if(this.candidates=i.sent,this.savedComments=u.c,r=this.route.snapshot.paramMap.get(l.a.TaskDescId),i.t0=r,!i.t0){i.next=15;break}return i.next=9,this.tasksDelegator.getTaskDesk(r);case 9:return this.taskDescRef=i.sent,i.next=12,this.tasksDelegator.getTasksConfig(r);case 12:this.taskConfigRef=i.sent,this.title=this.taskDescRef.description,this.savedComments=[].concat(t(null!==(e=this.taskConfigRef.comments)&&void 0!==e?e:[]),t(null!==(n=this.savedComments)&&void 0!==n?n:[]));case 15:(o=this.route.snapshot.paramMap.get(l.a.Navigate))&&this.store.editComment.value.id===o&&(this.editedComment=this.store.editComment.value.data,this.editedComment&&(this.comment=this.editedComment.comment,this.editedComment.candidates.forEach((function(t){return s.selectedCandidates[t._id]=t})),this.taskDescRef=this.editedComment.TaskDescRef,this.title=null===(a=this.editedComment.TaskDescRef)||void 0===a?void 0:a.description)),this.isInit=!0;case 17:case"end":return i.stop()}}),i,this)})))}},{key:"ngOnDestroy",value:function(){}},{key:"selectCandidate",value:function(t){this.selectedCandidates[t._id]=this.selectedCandidates[t._id]?null:t}},{key:"dropCandidates",value:function(t){}},{key:"createComment",value:function(){var t,e;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var a,i,r,o,s=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=this.editedComment,!n.t0){n.next=4;break}return n.next=4,this.tasksCommentsDelegator.deleteComments(this.editedComment.SavedComments);case 4:if(0!==(a=Object.keys(this.selectedCandidates).filter((function(t){return s.selectedCandidates[t]})).map((function(t){return s.selectedCandidates[t]}))).length){n.next=9;break}this.msgService.showToast(this.langProvider.NoneSelectedCandidates,1e3,"toastWarn"),n.next=25;break;case 9:if(!(null===(t=this.comment)||void 0===t?void 0:t.trim())){n.next=24;break}return i={candidates:a,comment:this.comment,TaskDescRef:this.taskDescRef,date:null===(e=this.editedComment)||void 0===e?void 0:e.date},n.next=13,this.tasksCommentsDelegator.createComment(i);case 13:if(r=n.sent,this.store.lastCommentsChangeDateTime.next(r[0].date),this.msgService.showToast(this.langProvider.CommentSaved+"..."),!this.taskDescRef){n.next=20;break}return o=this.store.lastTaskNavData,n.next=18,this.router.navigate([o.value.Path,o.value.Params],o.value.NavigationExtras);case 18:n.next=22;break;case 20:return n.next=22,this.router.navigate(["tabs/comments"],{skipLocationChange:!0});case 22:n.next=25;break;case 24:this.msgService.showToast(this.langProvider.EmptyComment,1e3,"toastWarn");case 25:case"end":return n.stop()}}),n,this)})))}},{key:"savedCommentSelected",value:function(t){this.comment="".concat(this.comment?this.comment+"\n":"").concat(t.comment)}},{key:"addSavedComment",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))}},{key:"back",value:function(t){var e;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===(e=this.comment)||void 0===e?void 0:e.trim(),!t.t0){t.next=5;break}return t.next=4,this.msgService.showAreYouSure(this.langProvider.CommentNotSaved);case 4:t.t0=t.sent;case 5:if(t.t1=t.t0,!t.t1){t.next=8;break}this.navCtrl.back();case 8:case"end":return t.stop()}}),t,this)})))}}])&&a(i.prototype,r),o&&a(i,o),e}(),P.\u0275fac=function(t){return new(t||P)(b.Ib(c.fb),b.Ib(d.a),b.Ib(d.f),b.Ib(h.a),b.Ib(f.a),b.Ib(v.a),b.Ib(g.a),b.Ib(p.b),b.Ib(C.a))},P.\u0275cmp=b.Cb({type:P,selectors:[["app-create-comment"]],decls:23,vars:14,consts:[["slot","start"],["slot","end"],[3,"click"],["slot","icon-only","name","arrow-back"],["cdkDropListGroup","",1,"container"],["lines","none","id","candidates","cdkDropList","","cdkDropListSortingDisabled","",1,"candidates",3,"cdkDropListData","cdkDropListDropped"],["class","iosDndFixItem",4,"ngFor","ngForOf"],[1,"commentArea"],["autocomplete","on","rows","5",1,"commentText",3,"ngModel","placeholder","ngModelChange"],[1,"commentBtns"],["disabled","","color","success",3,"click"],[1,"savedComments"],["button","",3,"click",4,"ngFor","ngForOf"],[1,"iosDndFixItem"],["cdkDrag","",3,"cdkDragStartDelay","click"],[1,"avatar","avatarMargin",3,"candidate","isSelected"],["class","avatar",3,"candidate","isSelected",4,"cdkDragPreview"],["class","avatar",3,"candidate","isSelected",4,"cdkDragPlaceholder"],["class","iosDndFixGap",4,"ngIf"],[1,"avatar",3,"candidate","isSelected"],[1,"iosDndFixGap"],["button","",3,"click"]],template:function(t,e){1&t&&(b.Nb(0,"ion-header"),b.Nb(1,"ion-toolbar"),b.Nb(2,"ion-buttons",0),b.Jb(3,"ion-menu-button"),b.Mb(),b.Nb(4,"ion-buttons",1),b.Nb(5,"ion-button",2),b.Vb("click",(function(t){return e.back(t)})),b.Jb(6,"ion-icon",3),b.Mb(),b.Mb(),b.Nb(7,"ion-title"),b.pc(8),b.Mb(),b.Mb(),b.Mb(),b.Nb(9,"ion-content"),b.Nb(10,"div",4),b.Nb(11,"ion-list",5),b.Vb("cdkDropListDropped",(function(t){return e.dropCandidates(t)})),b.nc(12,x,6,4,"div",6),b.Mb(),b.Nb(13,"div",7),b.Nb(14,"ion-textarea",8),b.Vb("ngModelChange",(function(t){return e.comment=t})),b.Mb(),b.Nb(15,"div",9),b.Nb(16,"ion-button",10),b.Vb("click",(function(){return e.addSavedComment()})),b.pc(17),b.Mb(),b.Nb(18,"ion-button",2),b.Vb("click",(function(){return e.createComment()})),b.pc(19),b.Mb(),b.Mb(),b.Nb(20,"div",11),b.Nb(21,"ion-list"),b.nc(22,S,4,1,"ion-item",12),b.Mb(),b.Mb(),b.Mb(),b.Mb(),b.Mb()),2&t&&(b.yb(7),b.mc("direction",e.langProvider.LangDirection),b.yb(1),b.qc(e.title),b.yb(3),b.dc("cdkDropListData",e.candidates),b.yb(1),b.dc("ngForOf",e.candidates),b.yb(2),b.mc("direction",e.langProvider.LangDirection),b.dc("ngModel",e.comment)("placeholder",e.langProvider.CreateComment),b.yb(3),b.qc(e.langProvider.CreateSavedComment),b.yb(2),b.qc(e.langProvider.CreateComment),b.yb(2),b.mc("direction",e.langProvider.LangDirection),b.yb(1),b.dc("ngForOf",e.savedComments))},directives:[c.s,c.Z,c.k,c.F,c.j,c.t,c.X,c.n,k.e,c.D,k.d,o.l,c.W,c.lb,s.d,s.g,c.w,k.a,y.a,k.c,k.b,o.m,c.C],styles:["ion-content[_ngcontent-%COMP%]{--overflow:hidden}.container[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%}.candidates[_ngcontent-%COMP%]{height:100%;width:auto;overflow:scroll;min-width:var(--avatar-empty-width)}.avatar[_ngcontent-%COMP%]{height:var(--avatar-height);width:var(--avatar-width)}.avatarMargin[_ngcontent-%COMP%]{margin:var(--avatar-margin)}.avatarComment[_ngcontent-%COMP%]{height:2rem;width:2rem}.commentArea[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;justify-content:flex-start;flex:1}.commentText[_ngcontent-%COMP%]{color:var(--ion-color-dark);max-height:20%}.candidateSelected[_ngcontent-%COMP%]{background:#d6b8b8;border:#b43434;border-radius:90rem;border-style:solid;border-width:.1rem}.commentBtns[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.closeBtn[_ngcontent-%COMP%]{margin-left:auto;--background:transparent;--color:var(--ion-color-dark)}.savedComments[_ngcontent-%COMP%]{overflow:scroll}"]}),P)}],R=((O=function t(){n(this,t)}).\u0275mod=b.Gb({type:O}),O.\u0275inj=b.Fb({factory:function(t){return new(t||O)},imports:[[d.h.forChild(I)],d.h]}),O),T=r("ajeZ"),_=((N=function t(){n(this,t)}).\u0275mod=b.Gb({type:N}),N.\u0275inj=b.Fb({factory:function(t){return new(t||N)},imports:[[o.c,s.a,c.bb,R,T.a,k.f]]}),N)}}])}();