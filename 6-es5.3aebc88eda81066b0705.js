!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{LTzM:function(t,i,o){"use strict";o.r(i),o.d(i,"CreateCommentPageModule",(function(){return j}));var r=o("ofXK"),s=o("3Pt+"),c=o("TEn/"),d=o("tyNb"),m=o("mrSG"),l=o("OZ4V"),u=o("Mxx3"),h=o("fXoL"),b=o("NrBX"),v=o("nTzd"),f=o("ufmx"),g=o("zrcv"),C=o("L5fO"),p=o("3LWr"),k=o("5+WD"),y=o("g1yl");function x(e,t){1&e&&h.Jb(0,"app-candidate-avatar",17),2&e&&h.dc("candidate",t.$implicit.value)}function M(e,t){if(1&e){var n=h.Ob();h.Nb(0,"ion-item-options",25),h.Nb(1,"ion-item-option",26),h.Vb("click",(function(){h.ic(n);var e=h.Xb().$implicit;return h.Xb(2).onDeleteSavedComment(e)})),h.Jb(2,"ion-icon",27),h.Mb(),h.Mb()}}function w(e,t){1&e&&(h.Nb(0,"span"),h.qc(1,"*"),h.Mb())}function O(e,t){if(1&e){var n=h.Ob();h.Nb(0,"ion-item-sliding",null,20),h.oc(2,M,3,0,"ion-item-options",21),h.Nb(3,"ion-item",22),h.Vb("click",(function(){h.ic(n);var e=t.$implicit;return h.Xb(2).savedCommentSelected(e)})),h.Nb(4,"ion-label"),h.oc(5,w,2,0,"span",23),h.Nb(6,"span",24),h.qc(7),h.Mb(),h.Mb(),h.Mb(),h.Mb()}if(2&e){var a=t.$implicit,i=h.Xb(2);h.yb(2),h.dc("ngIf",a._id),h.yb(1),h.nc("direction",i.langProvider.LangDirection),h.yb(2),h.dc("ngIf",!a._id),h.yb(2),h.rc(a.comment)}}function P(e,t){if(1&e&&(h.Nb(0,"div",18),h.Nb(1,"ion-list"),h.oc(2,O,8,5,"ion-item-sliding",19),h.Mb(),h.Mb()),2&e){var n=h.Xb();h.yb(2),h.dc("ngForOf",n.savedComments)}}var D,N,S,_=[{path:"",component:(D=function(){function t(e,a,i,o,r,s,c,d,m,l){n(this,t),this.navCtrl=e,this.modalCtrl=a,this.route=i,this.router=o,this.tasksDelegator=r,this.tasksCommentsDelegator=s,this.candidatesDelegator=c,this.msgService=d,this.langProvider=m,this.store=l,this.selectedCandidates={},this.dragDelay=u.a.DragDelay,this.title=this.langProvider.GeneralComment,this.isInit=!1}var i,o,r;return i=t,(o=[{key:"ngOnInit",value:function(){var t,n,a;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var o,r,s=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.candidatesDelegator.getCandidatesCopy(!0);case 2:return this.candidates=i.sent,i.next=5,this.tasksCommentsDelegator.loadSavedComments();case 5:if(this.savedComments=i.sent,o=this.route.snapshot.paramMap.get(u.a.TaskDescId),i.t0=o,!i.t0){i.next=17;break}return i.next=11,this.tasksDelegator.getTaskDesk(o);case 11:return this.taskDescRef=i.sent,i.next=14,this.tasksDelegator.getTasksConfig(o);case 14:this.taskConfigRef=i.sent,this.title=this.taskDescRef.description,this.savedComments=[].concat(e(null!==(t=this.taskConfigRef.comments)&&void 0!==t?t:[]),e(null!==(n=this.savedComments)&&void 0!==n?n:[]));case 17:(r=this.route.snapshot.paramMap.get(u.a.Navigate))&&this.store.editComment.value.id===r&&(this.editedComment=this.store.editComment.value.data,this.editedComment&&(this.comment=this.editedComment.comment,this.editedComment.candidates.forEach((function(e){return s.selectedCandidates[e._id]=e})),this.taskDescRef=this.editedComment.TaskDescRef,this.title=null===(a=this.editedComment.TaskDescRef)||void 0===a?void 0:a.description)),this.isInit=!0;case 19:case"end":return i.stop()}}),i,this)})))}},{key:"ngOnDestroy",value:function(){}},{key:"selectCandidate",value:function(e){this.selectedCandidates[e._id]=this.selectedCandidates[e._id]?null:e}},{key:"createComment",value:function(){var e,t;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var a,i,o,r,s=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=this.editedComment,!n.t0){n.next=4;break}return n.next=4,this.tasksCommentsDelegator.deleteComments(this.editedComment.SavedComments);case 4:if(0!==(a=Object.keys(this.selectedCandidates).filter((function(e){return s.selectedCandidates[e]})).map((function(e){return s.selectedCandidates[e]}))).length){n.next=9;break}this.msgService.showToast(this.langProvider.NoneSelectedCandidates,1e3,"toastWarn"),n.next=25;break;case 9:if(!(null===(e=this.comment)||void 0===e?void 0:e.trim())){n.next=24;break}return i={candidates:a,comment:this.comment,TaskDescRef:this.taskDescRef,date:null===(t=this.editedComment)||void 0===t?void 0:t.date},n.next=13,this.tasksCommentsDelegator.createComment(i);case 13:if(o=n.sent,this.store.lastCommentsChangeDateTime.next(o[0].date),this.msgService.showToast(this.langProvider.CommentSaved+"..."),!this.taskDescRef){n.next=20;break}return r=this.store.lastTaskNavData,n.next=18,this.router.navigate([r.value.Path,r.value.Params],r.value.NavigationExtras);case 18:n.next=22;break;case 20:return n.next=22,this.router.navigate(["tabs/comments"],{skipLocationChange:!0});case 22:n.next=25;break;case 24:this.msgService.showToast(this.langProvider.EmptyComment,1e3,"toastWarn");case 25:case"end":return n.stop()}}),n,this)})))}},{key:"addSavedComment",value:function(){var e;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null===(e=this.comment)||void 0===e?void 0:e.trim())){t.next=8;break}return n={comment:this.comment.trim()},t.next=4,this.tasksCommentsDelegator.createSavedComment(n);case 4:a=t.sent,this.savedComments.push(a),this.msgService.showToast(this.langProvider.SavedCommentAdded),this.comment="",t.next=9;break;case 8:this.msgService.showToast(this.langProvider.EmptyComment,1e3,"toastWarn");case 9:case"end":return t.stop()}}),t,this)})))}},{key:"onDeleteSavedComment",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.tasksCommentsDelegator.deleteSavedComment(e);case 2:this.savedComments=this.savedComments.filter((function(t){var n;return(null===(n=t)||void 0===n?void 0:n._id)!==e._id}));case 3:case"end":return t.stop()}}),t,this)})))}},{key:"savedCommentSelected",value:function(e){this.comment="".concat(this.comment?this.comment+"\n":"").concat(e.comment)}},{key:"selectCandidates",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},Object.keys(this.selectedCandidates).forEach((function(e){return t[o.selectedCandidates[e]._id]=!0})),e.next=4,this.modalCtrl.create({component:l.a,componentProps:{candidates:this.candidates,selectedCandidates:t,isModal:!0}});case 4:return n=e.sent,e.next=7,n.present();case 7:return e.next=9,n.onWillDismiss();case 9:if(!(a=e.sent).data){e.next=15;break}return i=Object.keys(a.data).filter((function(e){return a.data[e]})),e.next=14,this.candidatesDelegator.getCandidatesByIdsMap(i);case 14:this.selectedCandidates=e.sent;case 15:case"end":return e.stop()}}),e,this)})))}},{key:"trackByFn",value:function(e,t){return(null==t?void 0:t.value)?t.value._id:e}},{key:"back",value:function(e){var t;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=this.comment)||void 0===t?void 0:t.trim())){e.next=8;break}return e.next=3,this.msgService.showAreYouSure(this.langProvider.CommentNotSaved);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.navCtrl.back();case 6:e.next=9;break;case 8:this.navCtrl.back();case 9:case"end":return e.stop()}}),e,this)})))}}])&&a(i.prototype,o),r&&a(i,r),t}(),D.\u0275fac=function(e){return new(e||D)(h.Ib(c.Fb),h.Ib(c.Eb),h.Ib(d.a),h.Ib(d.f),h.Ib(b.a),h.Ib(v.a),h.Ib(f.a),h.Ib(g.a),h.Ib(C.b),h.Ib(p.a))},D.\u0275cmp=h.Cb({type:D,selectors:[["app-create-comment"]],decls:26,vars:17,consts:[["slot","start"],["slot","end"],[3,"click"],["slot","icon-only","name","arrow-back"],["cdkDropListGroup","",1,"container"],[1,"commentArea"],["autocomplete","on","rows","5",1,"commentText",3,"ngModel","placeholder","ngModelChange"],[1,"selectedCandidates"],["class","candi",3,"candidate",4,"ngFor","ngForOf","ngForTrackBy"],[1,"commentBtns"],["color","secondary",1,"sendBtn",3,"click"],["name","send"],["color","secondary",1,"saveCommentBtn",3,"click"],["name","save"],["color","primary",1,"selectCandidatesBtn",3,"click"],["name","people"],["class","savedComments",4,"ngIf"],[1,"candi",3,"candidate"],[1,"savedComments"],[4,"ngFor","ngForOf"],["slide",""],["side","end",4,"ngIf"],["button","",3,"click"],[4,"ngIf"],[1,"savedComment"],["side","end"],["color","light",3,"click"],["name","trash","color","danger",1,"htBtn"]],template:function(e,t){1&e&&(h.Nb(0,"ion-header"),h.Nb(1,"ion-toolbar"),h.Nb(2,"ion-buttons",0),h.Jb(3,"ion-menu-button"),h.Mb(),h.Nb(4,"ion-buttons",1),h.Nb(5,"ion-button",2),h.Vb("click",(function(e){return t.back(e)})),h.Jb(6,"ion-icon",3),h.Mb(),h.Mb(),h.Nb(7,"ion-title"),h.qc(8),h.Mb(),h.Mb(),h.Mb(),h.Nb(9,"ion-content"),h.Nb(10,"div",4),h.Nb(11,"div",5),h.Nb(12,"ion-textarea",6),h.Vb("ngModelChange",(function(e){return t.comment=e})),h.Mb(),h.Nb(13,"div",7),h.oc(14,x,1,1,"app-candidate-avatar",8),h.Yb(15,"keyvalue"),h.Mb(),h.Nb(16,"div",9),h.Nb(17,"ion-fab-button",10),h.Vb("click",(function(){return t.createComment()})),h.Jb(18,"ion-icon",11),h.Mb(),h.Nb(19,"ion-fab-button",12),h.Vb("click",(function(){return t.addSavedComment()})),h.Jb(20,"ion-icon",13),h.Mb(),h.Nb(21,"ion-fab-button",14),h.Vb("click",(function(){return t.selectCandidates()})),h.Jb(22,"ion-icon",15),h.Mb(),h.Mb(),h.Nb(23,"h3"),h.qc(24),h.Mb(),h.oc(25,P,3,1,"div",16),h.Mb(),h.Mb(),h.Mb()),2&e&&(h.yb(7),h.nc("direction",t.langProvider.LangDirection),h.yb(1),h.rc(t.title),h.yb(4),h.nc("direction",t.langProvider.LangDirection),h.dc("ngModel",t.comment)("placeholder",t.langProvider.CreateComment),h.yb(1),h.nc("direction",t.langProvider.LangDirection),h.yb(1),h.dc("ngForOf",h.Zb(15,15,t.selectedCandidates))("ngForTrackBy",t.trackByFn),h.yb(9),h.nc("direction",t.langProvider.LangDirection),h.yb(1),h.rc(t.langProvider.SavedComments),h.yb(1),h.dc("ngIf",(null==t.savedComments?null:t.savedComments.length)>0))},directives:[c.B,c.zb,c.l,c.R,c.k,c.C,c.xb,c.u,k.f,c.vb,c.Nb,s.j,s.m,r.s,c.x,r.t,y.a,c.O,c.M,c.H,c.N,c.L,c.K],pipes:[r.l],styles:["ion-content[_ngcontent-%COMP%]{--overflow:hidden}.container[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%}.candidates[_ngcontent-%COMP%]{height:100%;width:auto;overflow:scroll;min-width:var(--avatar-empty-width)}.avatar[_ngcontent-%COMP%]{height:var(--avatar-height);width:var(--avatar-width)}.avatarMargin[_ngcontent-%COMP%]{margin:var(--avatar-margin)}.avatarComment[_ngcontent-%COMP%]{height:2rem;width:2rem}.commentArea[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;justify-content:flex-start;flex:1}.commentText[_ngcontent-%COMP%]{color:var(--ion-color-dark);max-height:20%}.commentBtns[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:.3rem;min-height:auto}.closeBtn[_ngcontent-%COMP%]{margin-left:auto;--background:transparent;--color:var(--ion-color-dark)}.savedComments[_ngcontent-%COMP%]{overflow:scroll;width:100%}.savedComment[_ngcontent-%COMP%]{white-space:normal}.selectedCandidates[_ngcontent-%COMP%]{display:flex;width:100%;flex-wrap:wrap;overflow:scroll;max-height:5rem}.selectCandidatesBtn[_ngcontent-%COMP%]{margin:.5rem .5rem .5rem auto}.sendBtn[_ngcontent-%COMP%]{transform:rotate(180deg)}.saveCommentBtn[_ngcontent-%COMP%], .sendBtn[_ngcontent-%COMP%]{margin:.5rem}.candi[_ngcontent-%COMP%]{height:2rem;width:2rem;margin:.2rem}.htBtn[_ngcontent-%COMP%]{font-size:x-large}"]}),D)}],I=((N=function e(){n(this,e)}).\u0275mod=h.Gb({type:N}),N.\u0275inj=h.Fb({factory:function(e){return new(e||N)},imports:[[d.j.forChild(_)],d.j]}),N),R=o("ajeZ"),j=((S=function e(){n(this,e)}).\u0275mod=h.Gb({type:S}),S.\u0275inj=h.Fb({factory:function(e){return new(e||S)},imports:[[r.c,s.e,c.Bb,I,R.a,k.g]]}),S)}}])}();