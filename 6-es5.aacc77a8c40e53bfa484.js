!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{LTzM:function(n,a,i){"use strict";i.r(a),i.d(a,"CreateCommentPageModule",(function(){return L}));var r=i("ofXK"),o=i("3Pt+"),c=i("TEn/"),s=i("tyNb"),d=i("mrSG"),m=i("Mxx3"),l=i("+Ff3"),u=i("fXoL"),b=i("NrBX"),h=i("nTzd"),v=i("ufmx"),f=i("zrcv"),g=i("L5fO"),p=i("3LWr"),C=i("5+WD"),k=i("g1yl");function D(t,e){if(1&t&&u.Jb(0,"app-candidate-avatar",18),2&t){var n=u.Xb().$implicit;u.dc("candidate",n)}}function y(t,e){if(1&t&&u.Jb(0,"app-candidate-avatar",18),2&t){var n=u.Xb().$implicit;u.dc("candidate",n)}}function M(t,e){if(1&t){var n=u.Ob();u.Nb(0,"ion-item",14),u.Vb("click",(function(){u.ic(n);var t=e.$implicit;return u.Xb().selectCandidate(t)})),u.Jb(1,"app-candidate-avatar",15),u.nc(2,D,1,1,"app-candidate-avatar",16),u.nc(3,y,1,1,"app-candidate-avatar",17),u.Mb()}if(2&t){var a=e.$implicit,i=u.Xb();u.dc("cdkDragStartDelay",i.dragDelay),u.yb(1),u.Ab("candidateSelected",i.selectedCandidates[a._id]),u.dc("candidate",a)}}function w(t,e){if(1&t){var n=u.Ob();u.Nb(0,"ion-item",19),u.Vb("click",(function(){u.ic(n);var t=e.$implicit;return u.Xb().savedCommentSelected(t)})),u.Nb(1,"ion-label"),u.Nb(2,"span"),u.pc(3),u.Mb(),u.Mb(),u.Mb()}if(2&t){var a=e.$implicit;u.yb(3),u.qc(a)}}var x,P,N,O=[{path:"",component:(x=function(){function n(e,a,i,r,o,c,s,d,l){t(this,n),this.navCtrl=e,this.route=a,this.router=i,this.tasksDelegator=r,this.tasksCommentsDelegator=o,this.candidatesDelegator=c,this.msgService=s,this.langProvider=d,this.store=l,this.selectedCandidates={},this.dragDelay=m.a.DragDelay,this.title=this.langProvider.GeneralComment,this.isInit=!1}var a,i,r;return a=n,(i=[{key:"ngOnInit",value:function(){var t;return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,a,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.candidatesDelegator.getCandidatesCopy();case 2:if(this.candidates=e.sent,this.savedComments=l.c,n=this.route.snapshot.paramMap.get(m.a.TaskDescId),e.t0=n,!e.t0){e.next=11;break}return e.next=9,this.tasksDelegator.getTaskDesk(n);case 9:this.taskDescRef=e.sent,this.title=this.taskDescRef.description;case 11:(a=this.route.snapshot.paramMap.get(m.a.Navigate))&&this.store.editComment.value.id===a&&(this.editedComment=this.store.editComment.value.data,this.editedComment&&(this.comment=this.editedComment.comment,this.editedComment.candidates.forEach((function(t){return i.selectedCandidates[t._id]=t})),this.taskDescRef=this.editedComment.TaskDescRef,this.title=null===(t=this.editedComment.TaskDescRef)||void 0===t?void 0:t.description)),this.isInit=!0;case 13:case"end":return e.stop()}}),e,this)})))}},{key:"ngOnDestroy",value:function(){}},{key:"selectCandidate",value:function(t){this.selectedCandidates[t._id]=this.selectedCandidates[t._id]?null:t}},{key:"dropCandidates",value:function(t){}},{key:"createComment",value:function(){var t,e;return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var a,i,r,o,c=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=this.editedComment,!n.t0){n.next=4;break}return n.next=4,this.tasksCommentsDelegator.deleteComments(this.editedComment.SavedComments);case 4:if(0!==(a=Object.keys(this.selectedCandidates).filter((function(t){return c.selectedCandidates[t]})).map((function(t){return c.selectedCandidates[t]}))).length){n.next=9;break}this.msgService.showToast(this.langProvider.NoneSelectedCandidates,1e3,"toastWarn"),n.next=25;break;case 9:if(!(null===(t=this.comment)||void 0===t?void 0:t.trim())){n.next=24;break}return i={candidates:a,comment:this.comment,TaskDescRef:this.taskDescRef,date:null===(e=this.editedComment)||void 0===e?void 0:e.date},n.next=13,this.tasksCommentsDelegator.createComment(i);case 13:if(r=n.sent,this.store.lastCommentsChangeDateTime.next(r[0].date),this.msgService.showToast(this.langProvider.CommentSaved+"..."),!this.taskDescRef){n.next=20;break}return o=this.store.lastTaskNavData,n.next=18,this.router.navigate([o.value.Path,o.value.Params],o.value.NavigationExtras);case 18:n.next=22;break;case 20:return n.next=22,this.router.navigate(["tabs/comments"],{skipLocationChange:!0});case 22:n.next=25;break;case 24:this.msgService.showToast(this.langProvider.EmptyComment,1e3,"toastWarn");case 25:case"end":return n.stop()}}),n,this)})))}},{key:"savedCommentSelected",value:function(t){this.comment="".concat(this.comment?this.comment+"\n":"").concat(t)}},{key:"addSavedComment",value:function(){return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))}}])&&e(a.prototype,i),r&&e(a,r),n}(),x.\u0275fac=function(t){return new(t||x)(u.Ib(c.fb),u.Ib(s.a),u.Ib(s.f),u.Ib(b.a),u.Ib(h.a),u.Ib(v.a),u.Ib(f.a),u.Ib(g.b),u.Ib(p.a))},x.\u0275cmp=u.Cb({type:x,selectors:[["app-create-comment"]],decls:22,vars:15,consts:[["slot","start"],["slot","end"],["defaultHref","tabs/comments"],[3,"fullscreen"],["cdkDropListGroup","",1,"container"],["lines","none","id","candidates","cdkDropList","","cdkDropListSortingDisabled","",1,"candidates",3,"cdkDropListData","cdkDropListDropped"],["cdkDrag","",3,"cdkDragStartDelay","click",4,"ngFor","ngForOf"],[1,"commentArea"],["autocomplete","on","rows","5",1,"commentText",3,"ngModel","placeholder","ngModelChange"],[1,"commentBtns"],["color","success",3,"click"],[3,"click"],[1,"savedComments"],["button","",3,"click",4,"ngFor","ngForOf"],["cdkDrag","",3,"cdkDragStartDelay","click"],[1,"avatar","avatarMargin",3,"candidate"],["class","avatar",3,"candidate",4,"cdkDragPreview"],["class","avatar",3,"candidate",4,"cdkDragPlaceholder"],[1,"avatar",3,"candidate"],["button","",3,"click"]],template:function(t,e){1&t&&(u.Nb(0,"ion-header"),u.Nb(1,"ion-toolbar"),u.Nb(2,"ion-buttons",0),u.Jb(3,"ion-menu-button"),u.Mb(),u.Nb(4,"ion-buttons",1),u.Jb(5,"ion-back-button",2),u.Mb(),u.Nb(6,"ion-title"),u.pc(7),u.Mb(),u.Mb(),u.Mb(),u.Nb(8,"ion-content",3),u.Nb(9,"div",4),u.Nb(10,"ion-list",5),u.Vb("cdkDropListDropped",(function(t){return e.dropCandidates(t)})),u.nc(11,M,4,4,"ion-item",6),u.Mb(),u.Nb(12,"div",7),u.Nb(13,"ion-textarea",8),u.Vb("ngModelChange",(function(t){return e.comment=t})),u.Mb(),u.Nb(14,"div",9),u.Nb(15,"ion-button",10),u.Vb("click",(function(){return e.addSavedComment()})),u.pc(16),u.Mb(),u.Nb(17,"ion-button",11),u.Vb("click",(function(){return e.createComment()})),u.pc(18),u.Mb(),u.Mb(),u.Nb(19,"div",12),u.Nb(20,"ion-list"),u.nc(21,w,4,1,"ion-item",13),u.Mb(),u.Mb(),u.Mb(),u.Mb(),u.Mb()),2&t&&(u.yb(6),u.mc("direction",e.langProvider.LangDirection),u.yb(1),u.qc(e.title),u.yb(1),u.dc("fullscreen",!0),u.yb(2),u.dc("cdkDropListData",e.candidates),u.yb(1),u.dc("ngForOf",e.candidates),u.yb(2),u.mc("direction",e.langProvider.LangDirection),u.dc("ngModel",e.comment)("placeholder",e.langProvider.CreateComment),u.yb(3),u.qc(e.langProvider.CreateSavedComment),u.yb(2),u.qc(e.langProvider.CreateComment),u.yb(2),u.mc("direction",e.langProvider.LangDirection),u.yb(1),u.dc("ngForOf",e.savedComments))},directives:[c.s,c.Z,c.k,c.F,c.g,c.h,c.X,c.n,C.e,c.D,C.d,r.l,c.W,c.lb,o.d,o.g,c.j,c.w,C.a,k.a,C.c,C.b,c.C],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%}.candidates[_ngcontent-%COMP%]{height:100%;width:auto;overflow:scroll;min-width:var(--avatar-empty-width)}.avatar[_ngcontent-%COMP%]{height:var(--avatar-height);width:var(--avatar-width)}.avatarMargin[_ngcontent-%COMP%]{margin:var(--avatar-margin)}.avatarComment[_ngcontent-%COMP%]{height:2rem;width:2rem}.commentArea[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;justify-content:flex-end;flex:1}.commentText[_ngcontent-%COMP%]{color:var(--ion-color-dark);max-height:20%}.candidateSelected[_ngcontent-%COMP%]{background:#f08080}.commentBtns[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.closeBtn[_ngcontent-%COMP%]{margin-left:auto;--background:transparent;--color:var(--ion-color-dark)}.savedComments[_ngcontent-%COMP%]{overflow:scroll}"]}),x)}],S=((P=function e(){t(this,e)}).\u0275mod=u.Gb({type:P}),P.\u0275inj=u.Fb({factory:function(t){return new(t||P)},imports:[[s.h.forChild(O)],s.h]}),P),T=i("ajeZ"),L=((N=function e(){t(this,e)}).\u0275mod=u.Gb({type:N}),N.\u0275inj=u.Fb({factory:function(t){return new(t||N)},imports:[[r.c,o.a,c.bb,S,T.a,C.f]]}),N)}}])}();