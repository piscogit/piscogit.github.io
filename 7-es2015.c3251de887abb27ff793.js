(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{QiNc:function(t,e,s){"use strict";s.r(e),s.d(e,"TaskCatalogFilterPageModule",function(){return h});var i=s("ofXK"),n=s("3Pt+"),o=s("TEn/"),a=s("tyNb"),r=s("hvzS"),c=s("fXoL");const l=[{path:"",component:r.a}];let b=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.Ib({type:t}),t.\u0275inj=c.Hb({imports:[[a.h.forChild(l)],a.h]}),t})(),h=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.Ib({type:t}),t.\u0275inj=c.Hb({imports:[[i.c,n.a,o.bb,b]]}),t})()},hvzS:function(t,e,s){"use strict";s.d(e,"a",function(){return l});var i=s("fXoL"),n=s("TEn/"),o=s("L5fO"),a=s("ofXK"),r=s("3Pt+");function c(t,e){if(1&t){const t=i.Qb();i.Pb(0,"ion-item"),i.Pb(1,"ion-label"),i.rc(2),i.Ob(),i.Pb(3,"ion-toggle",9),i.Xb("ngModelChange",function(s){i.kc(t);const n=e.$implicit;return i.Zb().taskGroups[n].isFiltered=!s}),i.Ob(),i.Ob()}if(2&t){const t=e.$implicit,s=i.Zb();i.Ab(2),i.sc(t),i.Ab(1),i.fc("ngModel",!s.taskGroups[t].isFiltered)}}let l=(()=>{class t{constructor(t,e){this.modalCtrl=t,this.langProvider=e}ngOnInit(){this.taskGroupsKeys=Object.keys(this.taskGroups)}resetFilters(){Object.keys(this.taskGroups).forEach(t=>this.taskGroups[t].isFiltered=!1)}shutdownFilters(){Object.keys(this.taskGroups).forEach(t=>this.taskGroups[t].isFiltered=!0)}applyFilters(){this.modalCtrl.dismiss("koko")}dismissFilters(){this.modalCtrl.dismiss("koko")}changeFilterStatus(t){this.taskGroups[t].isFiltered=!this.taskGroups[t].isFiltered}}return t.\u0275fac=function(e){return new(e||t)(i.Kb(n.eb),i.Kb(o.b))},t.\u0275cmp=i.Eb({type:t,selectors:[["app-task-catalog-filter"]],inputs:{taskGroups:"taskGroups"},decls:15,vars:5,consts:[["translucent","true"],["slot","end"],["strong","",3,"click"],[1,"mainFilters",3,"fullscreen"],[1,"resetFilters"],["slot","start","color","danger","fill","clear",3,"click"],["slot","end","color","success","fill","clear",3,"click"],[1,"filtersList"],[4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Pb(0,"ion-header",0),i.Pb(1,"ion-toolbar"),i.Lb(2,"ion-title"),i.Pb(3,"ion-buttons",1),i.Pb(4,"ion-button",2),i.Xb("click",function(){return e.applyFilters()}),i.rc(5),i.Ob(),i.Ob(),i.Ob(),i.Ob(),i.Pb(6,"ion-content",3),i.Pb(7,"ion-toolbar",4),i.Pb(8,"ion-button",5),i.Xb("click",function(){return e.shutdownFilters()}),i.rc(9),i.Ob(),i.Pb(10,"ion-button",6),i.Xb("click",function(){return e.resetFilters()}),i.rc(11),i.Ob(),i.Ob(),i.Pb(12,"div",7),i.Pb(13,"ion-list"),i.pc(14,c,4,2,"ion-item",8),i.Ob(),i.Ob(),i.Ob()),2&t&&(i.Ab(5),i.sc(e.langProvider.Done),i.Ab(1),i.fc("fullscreen",!0),i.Ab(3),i.tc(" ",e.langProvider.ShutdownAll," "),i.Ab(2),i.tc(" ",e.langProvider.ShowAll," "),i.Ab(3),i.fc("ngForOf",e.taskGroupsKeys))},directives:[n.s,n.Z,n.X,n.k,n.j,n.n,n.D,a.l,n.w,n.C,n.Y,n.c,r.e,r.h],styles:[".mainFilters[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:hidden;width:100%}.resetFilters[_ngcontent-%COMP%]{display:flex;flex:1;justify-content:space-between;width:100%}.filtersList[_ngcontent-%COMP%]{overflow:scroll}"]}),t})()},"m/R5":function(t,e,s){"use strict";s.r(e),s.d(e,"TaskCatalogPageModule",function(){return I});var i=s("ofXK"),n=s("3Pt+"),o=s("TEn/"),a=s("tyNb"),r=s("mrSG"),c=s("kLqA"),l=s("Mxx3"),b=s("hvzS"),h=s("fXoL"),u=s("3LWr"),d=s("zrcv"),g=s("NrBX"),k=s("RybT"),f=s("L5fO"),p=s("Ueei");const m=["slide"];function v(t,e){if(1&t){const t=h.Qb();h.Pb(0,"ion-button",10),h.Xb("click",function(){return h.kc(t),h.Zb(3).showSearchbar()}),h.Lb(1,"ion-icon",12),h.Ob()}}function P(t,e){if(1&t){const t=h.Qb();h.Nb(0),h.Pb(1,"ion-buttons",4),h.Lb(2,"ion-menu-button"),h.Ob(),h.Pb(3,"ion-segment",5),h.Xb("ngModelChange",function(e){return h.kc(t),h.Zb(2).segment=e})("ionChange",function(){return h.kc(t),h.Zb(2).updateSegment()}),h.Pb(4,"ion-segment-button",6),h.rc(5),h.Ob(),h.Pb(6,"ion-segment-button",7),h.rc(7),h.Ob(),h.Ob(),h.Pb(8,"ion-buttons",8),h.pc(9,v,2,0,"ion-button",9),h.Pb(10,"ion-button",10),h.Xb("click",function(){return h.kc(t),h.Zb(2).showTaskFilters()}),h.Lb(11,"ion-icon",11),h.Ob(),h.Ob(),h.Mb()}if(2&t){const t=h.Zb(2);h.Ab(3),h.fc("ngModel",t.segment),h.Ab(2),h.tc(" ",t.langProvider.FavoriteCatalogTasks," "),h.Ab(2),h.tc(" ",t.langProvider.AllCatalogTasks," "),h.Ab(2),h.fc("ngIf",!t.isShowSearchbar)}}function T(t,e){if(1&t){const t=h.Qb();h.Pb(0,"ion-searchbar",13),h.Xb("ngModelChange",function(e){return h.kc(t),h.Zb(2).searchTaskStr=e})("ionChange",function(){return h.kc(t),h.Zb(2).updateSearchTask()})("ionCancel",function(){return h.kc(t),h.Zb(2).hideSearchbar()}),h.Ob()}if(2&t){const t=h.Zb(2);h.fc("ngModel",t.searchTaskStr)}}function O(t,e){if(1&t){const t=h.Qb();h.Pb(0,"ion-item-group"),h.Pb(1,"ion-item-divider",14),h.Pb(2,"ion-label"),h.rc(3),h.Ob(),h.Ob(),h.Pb(4,"ion-item",15),h.Xb("click",function(){h.kc(t);const e=h.Zb(2);return e.createNewTask(e.store.lastTask.value)}),h.ac(5,"lowercase"),h.ac(6,"async"),h.Pb(7,"ion-label"),h.Pb(8,"p"),h.rc(9),h.ac(10,"async"),h.Ob(),h.Ob(),h.Ob(),h.Ob()}if(2&t){const t=h.Zb(2);h.Ab(3),h.tc(" ",t.langProvider.LatestCatalogTasks," "),h.Ab(1),h.Bb("track",h.bc(5,3,h.bc(6,5,t.store.lastTask).type)),h.Ab(5),h.sc(h.bc(10,7,t.store.lastTask).description)}}function y(t,e){if(1&t){const t=h.Qb();h.Pb(0,"ion-icon",21),h.Xb("click",function(e){h.kc(t);const s=h.Zb().$implicit;return h.Zb(3).changeFavorite(s,e)}),h.Ob()}}function C(t,e){if(1&t){const t=h.Qb();h.Pb(0,"ion-icon",22),h.Xb("click",function(e){h.kc(t);const s=h.Zb().$implicit;return h.Zb(3).changeFavorite(s,e)}),h.Ob()}}function w(t,e){if(1&t){const t=h.Qb();h.Pb(0,"ion-item-sliding",null,17),h.ac(2,"lowercase"),h.Pb(3,"ion-item",18),h.Xb("click",function(){h.kc(t);const s=e.$implicit;return h.Zb(3).createNewTask(s)}),h.Pb(4,"ion-label"),h.Pb(5,"p"),h.rc(6),h.Ob(),h.Ob(),h.pc(7,y,1,0,"ion-icon",19),h.pc(8,C,1,0,"ion-icon",20),h.Ob(),h.Ob()}if(2&t){const t=e.$implicit;h.Bb("track",h.bc(2,5,t.type)),h.Ab(3),h.fc("hidden",t.isFiltered),h.Ab(3),h.sc(t.description),h.Ab(1),h.fc("ngIf",!t.isFavorite),h.Ab(1),h.fc("ngIf",t.isFavorite)}}function F(t,e){if(1&t&&(h.Pb(0,"ion-item-group"),h.Pb(1,"ion-item-divider",14),h.Pb(2,"ion-label"),h.rc(3),h.Ob(),h.Ob(),h.pc(4,w,9,7,"ion-item-sliding",16),h.Ob()),2&t){const t=e.$implicit,s=h.Zb(2);h.Ab(3),h.tc(" ",t," "),h.Ab(1),h.fc("ngForOf",s.taskGroups[t].tasks)("ngForTrackBy",s.trackByFn)}}function S(t,e){if(1&t&&(h.Nb(0),h.Pb(1,"ion-header"),h.Pb(2,"ion-toolbar"),h.pc(3,P,12,4,"ng-container",0),h.pc(4,T,1,1,"ion-searchbar",1),h.Ob(),h.Ob(),h.Pb(5,"ion-content",2),h.Pb(6,"ion-list"),h.pc(7,O,11,9,"ion-item-group",0),h.ac(8,"async"),h.pc(9,F,5,3,"ion-item-group",3),h.Ob(),h.Ob(),h.Mb()),2&t){const t=h.Zb();h.Ab(3),h.fc("ngIf",!t.isShowSearchbar),h.Ab(1),h.fc("ngIf",t.isShowSearchbar),h.Ab(1),h.fc("fullscreen",!0),h.Ab(2),h.fc("ngIf",h.bc(8,5,t.store.lastTask)),h.Ab(2),h.fc("ngForOf",t.taskGroupsKeys)}}const G=[{path:"",component:(()=>{class t{constructor(t,e,s,i,n,o,a,r,c,l){this.router=t,this.route=e,this.actionCtrl=s,this.store=i,this.msgService=n,this.modalCtrl=o,this.tasksDelegator=a,this.taskDelegatorFactory=r,this.langProvider=c,this.backupService=l,this.searchTaskStr="",this.segment="favorites",this.isInit=!1}ngOnInit(){return Object(r.a)(this,void 0,void 0,function*(){this.taskCatalog=(yield this.tasksDelegator.getCategoryConfig()).TasksCatalog,this.taskGroups=this.taskCatalog.reduce((t,e)=>(t[e.group]=t[e.group]||{isFiltered:!1,tasks:[]},t[e.group].tasks.push(e),t),Object.create(null)),this.filterTasks(),this.isInit=!0})}ionViewWillEnter(){return Object(r.a)(this,void 0,void 0,function*(){this.backupService.checkBackupNeeded();const t=this.route.snapshot.paramMap.get(l.a.TaskDescId);if(t){const e=yield this.tasksDelegator.getTaskDesk(t);yield this.createNewTask(e,!0)}})}updateSearchTask(){this.filterTasks()}updateSegment(){var t;null===(t=this.slide)||void 0===t||t.closeOpened(),this.filterTasks()}showSearchbar(){this.isShowSearchbar=!0}hideSearchbar(){this.isShowSearchbar=!1,this.searchTaskStr="",this.filterTasks()}tokenizeSearchText(t){let e=null;if(""!==t.trim()){const s=t.toLowerCase().replace(/,|\.|-/g," ");""!==s&&(e=s.split(" ").filter(t=>!!t.trim().length))}return e}checkSearchDesc(t,e,s=!0){let i=!0;return e&&(i=s?e.every(e=>t.description.indexOf(e)>-1):e.some(e=>t.description.indexOf(e)>-1)),i}filterTasks(){const t=this.tokenizeSearchText(this.searchTaskStr);switch(this.segment){case"all":Object.keys(this.taskGroups).forEach(e=>{this.taskGroups[e].tasks.forEach(s=>{s.isFiltered=this.taskGroups[e].isFiltered||!this.checkSearchDesc(s,t)})});break;case"favorites":Object.keys(this.taskGroups).forEach(e=>{this.taskGroups[e].tasks.forEach(s=>{s.isFiltered=!s.isFavorite||this.taskGroups[e].isFiltered||!this.checkSearchDesc(s,t)})})}this.taskGroupsKeys=[],Object.keys(this.taskGroups).forEach(t=>{this.taskGroups[t].tasks.filter(t=>!t.isFiltered).length>0&&this.taskGroupsKeys.push(t)})}changeFavorite(t,e){return Object(r.a)(this,void 0,void 0,function*(){e.stopImmediatePropagation(),t.isFavorite=!t.isFavorite,t.isFavorite?this.msgService.showToast(this.langProvider.FavoriteAddMsg(t.description),500,l.b.ToastSuccess):this.msgService.showToast(this.langProvider.FavoriteRemoveMsg(t.description),500,l.b.ToastWarn),yield this.tasksDelegator.updateTaskCatalog(),this.filterTasks()})}showTaskFilters(){return Object(r.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:b.a,swipeToClose:!0,componentProps:{taskGroups:this.taskGroups}});yield t.present(),yield t.onWillDismiss(),this.filterTasks()})}taskSwiped(t,e){return Object(r.a)(this,void 0,void 0,function*(){yield this.msgService.showToast(`Fully Swiped: ${t.description}`,500)})}createNewTask(t,e=!1){return Object(r.a)(this,void 0,void 0,function*(){const s=yield this.tasksDelegator.getTasksConfig(t.id);if(!e&&(s.isAlertForMultiple||s.maxItems>=1)){const e=yield this.tasksDelegator.getAllTasksByTypeImpl(t.type,t.id);let i;if(e.length>0)if(e.length>=s.maxItems){const t=yield this.actionCtrl.create({header:this.langProvider.CatalogTaskEditMaxTasksMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:()=>{i="Edit"}},{text:this.langProvider.Cancel,role:"cancel",handler:()=>{i="Cancel"}}]});yield t.present(),yield t.onWillDismiss()}else if(s.isAlertForMultiple){const t=yield this.actionCtrl.create({header:this.langProvider.CatalogTaskEditOrNewMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:()=>{i="Edit"}},{text:this.langProvider.CatalogTaskNew,role:"destructive",handler:()=>{i="New"}},{text:this.langProvider.Cancel,role:"cancel",handler:()=>{i="Cancel"}}]});yield t.present(),yield t.onWillDismiss()}else i="New";else i="New";switch(i){case"New":this.navigatoToTask(t);break;case"Edit":{const s=e.sort((t,e)=>new Date(t.date).getTime()-new Date(e.date).getTime()).reverse()[0];this.navigatoToTask(t,s._id);break}}}else this.navigatoToTask(t)})}navigatoToTask(t,e){var s;this.store.lastTask.next(t),null===(s=this.slide)||void 0===s||s.closeOpened();const i={};i[l.a.TaskType]=t.type,i[l.a.TaskDescId]=t.id,e&&(i[l.a.SavedTaskId]=e),i[l.a.Unique]=c.Guid.raw();const n={Path:`tabs/tasks/${this.taskDelegatorFactory.getTaskDelegator(t.type).getComponentRoute()}`,Params:i,NavigationExtras:{skipLocationChange:!0,replaceUrl:!0}};this.store.lastTaskNavData.next(n),this.router.navigate([n.Path,n.Params],n.NavigationExtras)}trackByFn(t,e){return e?e.id:t}}return t.\u0275fac=function(e){return new(e||t)(h.Kb(a.f),h.Kb(a.a),h.Kb(o.a),h.Kb(u.a),h.Kb(d.a),h.Kb(o.eb),h.Kb(g.a),h.Kb(k.a),h.Kb(f.b),h.Kb(p.a))},t.\u0275cmp=h.Eb({type:t,selectors:[["app-task-catalog"]],viewQuery:function(t,e){if(1&t&&h.xc(m,1),2&t){let t;h.ic(t=h.Yb())&&(e.slide=t.first)}},decls:1,vars:1,consts:[[4,"ngIf"],["class","searchbar","showCancelButton","always",3,"ngModel","ngModelChange","ionChange","ionCancel",4,"ngIf"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["slot","start"],[3,"ngModel","ngModelChange","ionChange"],["value","favorites"],["value","all"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","options"],["slot","icon-only","name","search"],["showCancelButton","always",1,"searchbar",3,"ngModel","ngModelChange","ionChange","ionCancel"],["sticky","",1,"itemGroup"],["button","",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["slide",""],["button","",3,"hidden","click"],["slot","end","name","star-outline",3,"click",4,"ngIf"],["slot","end","name","star","color","primary",3,"click",4,"ngIf"],["slot","end","name","star-outline",3,"click"],["slot","end","name","star","color","primary",3,"click"]],template:function(t,e){1&t&&h.pc(0,S,10,7,"ng-container",0),2&t&&h.fc("ngIf",e.isInit)},directives:[i.m,o.s,o.Z,o.n,o.D,i.l,o.k,o.F,o.O,o.kb,n.e,n.h,o.P,o.j,o.t,o.N,o.lb,o.y,o.x,o.C,o.w,o.B],pipes:[i.b,i.k],styles:[".itemGroup[_ngcontent-%COMP%]{--color:var(--ion-color-favorite);font-weight:700}.searchbar[_ngcontent-%COMP%]{background:var(--ion-color-light)}"]}),t})()},{path:"task-catalog-filter",loadChildren:()=>Promise.resolve().then(s.bind(null,"QiNc")).then(t=>t.TaskCatalogFilterPageModule)}];let M=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.Ib({type:t}),t.\u0275inj=h.Hb({imports:[[a.h.forChild(G)],a.h]}),t})();var A=s("QiNc");let I=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.Ib({type:t}),t.\u0275inj=h.Hb({imports:[[i.c,n.a,o.bb,M,A.TaskCatalogFilterPageModule]]}),t})()}}]);