!function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{QiNc:function(e,t,r){"use strict";r.r(t),r.d(t,"TaskCatalogFilterPageModule",function(){return k});var i,a,s=r("ofXK"),o=r("3Pt+"),c=r("TEn/"),l=r("tyNb"),u=r("hvzS"),b=r("fXoL"),f=[{path:"",component:u.a}],h=((a=function e(){n(this,e)}).\u0275fac=function(e){return new(e||a)},a.\u0275mod=b.Ib({type:a}),a.\u0275inj=b.Hb({imports:[[l.h.forChild(f)],l.h]}),a),k=((i=function e(){n(this,e)}).\u0275fac=function(e){return new(e||i)},i.\u0275mod=b.Ib({type:i}),i.\u0275inj=b.Hb({imports:[[s.c,o.a,c.bb,h]]}),i)},hvzS:function(e,r,i){"use strict";i.d(r,"a",function(){return b});var a=i("fXoL"),s=i("TEn/"),o=i("L5fO"),c=i("ofXK"),l=i("3Pt+");function u(e,t){if(1&e){var n=a.Qb();a.Pb(0,"ion-item"),a.Pb(1,"ion-label"),a.rc(2),a.Ob(),a.Pb(3,"ion-toggle",9),a.Xb("ngModelChange",function(e){a.kc(n);var r=t.$implicit;return a.Zb().taskGroups[r].isFiltered=!e}),a.Ob(),a.Ob()}if(2&e){var r=t.$implicit,i=a.Zb();a.Ab(2),a.sc(r),a.Ab(1),a.fc("ngModel",!i.taskGroups[r].isFiltered)}}var b=function(){var e=function(){function e(t,r){n(this,e),this.modalCtrl=t,this.langProvider=r}return t(e,[{key:"ngOnInit",value:function(){this.taskGroupsKeys=Object.keys(this.taskGroups)}},{key:"resetFilters",value:function(){var e=this;Object.keys(this.taskGroups).forEach(function(t){return e.taskGroups[t].isFiltered=!1})}},{key:"shutdownFilters",value:function(){var e=this;Object.keys(this.taskGroups).forEach(function(t){return e.taskGroups[t].isFiltered=!0})}},{key:"applyFilters",value:function(){this.modalCtrl.dismiss("koko")}},{key:"dismissFilters",value:function(){this.modalCtrl.dismiss("koko")}},{key:"changeFilterStatus",value:function(e){this.taskGroups[e].isFiltered=!this.taskGroups[e].isFiltered}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Kb(s.eb),a.Kb(o.b))},e.\u0275cmp=a.Eb({type:e,selectors:[["app-task-catalog-filter"]],inputs:{taskGroups:"taskGroups"},decls:15,vars:5,consts:[["translucent","true"],["slot","end"],["strong","",3,"click"],[1,"mainFilters",3,"fullscreen"],[1,"resetFilters"],["slot","start","color","danger","fill","clear",3,"click"],["slot","end","color","success","fill","clear",3,"click"],[1,"filtersList"],[4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(a.Pb(0,"ion-header",0),a.Pb(1,"ion-toolbar"),a.Lb(2,"ion-title"),a.Pb(3,"ion-buttons",1),a.Pb(4,"ion-button",2),a.Xb("click",function(){return t.applyFilters()}),a.rc(5),a.Ob(),a.Ob(),a.Ob(),a.Ob(),a.Pb(6,"ion-content",3),a.Pb(7,"ion-toolbar",4),a.Pb(8,"ion-button",5),a.Xb("click",function(){return t.shutdownFilters()}),a.rc(9),a.Ob(),a.Pb(10,"ion-button",6),a.Xb("click",function(){return t.resetFilters()}),a.rc(11),a.Ob(),a.Ob(),a.Pb(12,"div",7),a.Pb(13,"ion-list"),a.pc(14,u,4,2,"ion-item",8),a.Ob(),a.Ob(),a.Ob()),2&e&&(a.Ab(5),a.sc(t.langProvider.Done),a.Ab(1),a.fc("fullscreen",!0),a.Ab(3),a.tc(" ",t.langProvider.ShutdownAll," "),a.Ab(2),a.tc(" ",t.langProvider.ShowAll," "),a.Ab(3),a.fc("ngForOf",t.taskGroupsKeys))},directives:[s.s,s.Z,s.X,s.k,s.j,s.n,s.D,c.l,s.w,s.C,s.Y,s.c,l.e,l.h],styles:[".mainFilters[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:hidden;width:100%}.resetFilters[_ngcontent-%COMP%]{display:flex;flex:1;justify-content:space-between;width:100%}.filtersList[_ngcontent-%COMP%]{overflow:scroll}"]}),e}()},"m/R5":function(e,r,i){"use strict";i.r(r),i.d(r,"TaskCatalogPageModule",function(){return Z});var a=i("ofXK"),s=i("3Pt+"),o=i("TEn/"),c=i("tyNb"),l=i("mrSG"),u=i("kLqA"),b=i("Mxx3"),f=i("hvzS"),h=i("fXoL"),k=i("3LWr"),d=i("zrcv"),g=i("NrBX"),p=i("RybT"),v=i("L5fO"),m=i("Ueei"),y=["slide"];function P(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-button",10),h.Xb("click",function(){return h.kc(n),h.Zb(3).showSearchbar()}),h.Lb(1,"ion-icon",12),h.Ob()}}function w(e,t){if(1&e){var n=h.Qb();h.Nb(0),h.Pb(1,"ion-buttons",4),h.Lb(2,"ion-menu-button"),h.Ob(),h.Pb(3,"ion-segment",5),h.Xb("ngModelChange",function(e){return h.kc(n),h.Zb(2).segment=e})("ionChange",function(){return h.kc(n),h.Zb(2).updateSegment()}),h.Pb(4,"ion-segment-button",6),h.rc(5),h.Ob(),h.Pb(6,"ion-segment-button",7),h.rc(7),h.Ob(),h.Ob(),h.Pb(8,"ion-buttons",8),h.pc(9,P,2,0,"ion-button",9),h.Pb(10,"ion-button",10),h.Xb("click",function(){return h.kc(n),h.Zb(2).showTaskFilters()}),h.Lb(11,"ion-icon",11),h.Ob(),h.Ob(),h.Mb()}if(2&e){var r=h.Zb(2);h.Ab(3),h.fc("ngModel",r.segment),h.Ab(2),h.tc(" ",r.langProvider.FavoriteCatalogTasks," "),h.Ab(2),h.tc(" ",r.langProvider.AllCatalogTasks," "),h.Ab(2),h.fc("ngIf",!r.isShowSearchbar)}}function T(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-searchbar",13),h.Xb("ngModelChange",function(e){return h.kc(n),h.Zb(2).searchTaskStr=e})("ionChange",function(){return h.kc(n),h.Zb(2).updateSearchTask()})("ionCancel",function(){return h.kc(n),h.Zb(2).hideSearchbar()}),h.Ob()}if(2&e){var r=h.Zb(2);h.fc("ngModel",r.searchTaskStr)}}function O(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-item-group"),h.Pb(1,"ion-item-divider",14),h.Pb(2,"ion-label"),h.rc(3),h.Ob(),h.Ob(),h.Pb(4,"ion-item",15),h.Xb("click",function(){h.kc(n);var e=h.Zb(2);return e.createNewTask(e.store.lastTask.value)}),h.ac(5,"lowercase"),h.ac(6,"async"),h.Pb(7,"ion-label"),h.Pb(8,"p"),h.rc(9),h.ac(10,"async"),h.Ob(),h.Ob(),h.Ob(),h.Ob()}if(2&e){var r=h.Zb(2);h.Ab(3),h.tc(" ",r.langProvider.LatestCatalogTasks," "),h.Ab(1),h.Bb("track",h.bc(5,3,h.bc(6,5,r.store.lastTask).type)),h.Ab(5),h.sc(h.bc(10,7,r.store.lastTask).description)}}function C(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-icon",21),h.Xb("click",function(e){h.kc(n);var t=h.Zb().$implicit;return h.Zb(3).changeFavorite(t,e)}),h.Ob()}}function F(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-icon",22),h.Xb("click",function(e){h.kc(n);var t=h.Zb().$implicit;return h.Zb(3).changeFavorite(t,e)}),h.Ob()}}function x(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-item-sliding",null,17),h.ac(2,"lowercase"),h.Pb(3,"ion-item",18),h.Xb("click",function(){h.kc(n);var e=t.$implicit;return h.Zb(3).createNewTask(e)}),h.Pb(4,"ion-label"),h.Pb(5,"p"),h.rc(6),h.Ob(),h.Ob(),h.pc(7,C,1,0,"ion-icon",19),h.pc(8,F,1,0,"ion-icon",20),h.Ob(),h.Ob()}if(2&e){var r=t.$implicit;h.Bb("track",h.bc(2,5,r.type)),h.Ab(3),h.fc("hidden",r.isFiltered),h.Ab(3),h.sc(r.description),h.Ab(1),h.fc("ngIf",!r.isFavorite),h.Ab(1),h.fc("ngIf",r.isFavorite)}}function S(e,t){if(1&e&&(h.Pb(0,"ion-item-group"),h.Pb(1,"ion-item-divider",14),h.Pb(2,"ion-label"),h.rc(3),h.Ob(),h.Ob(),h.pc(4,x,9,7,"ion-item-sliding",16),h.Ob()),2&e){var n=t.$implicit,r=h.Zb(2);h.Ab(3),h.tc(" ",n," "),h.Ab(1),h.fc("ngForOf",r.taskGroups[n].tasks)("ngForTrackBy",r.trackByFn)}}function G(e,t){if(1&e&&(h.Nb(0),h.Pb(1,"ion-header"),h.Pb(2,"ion-toolbar"),h.pc(3,w,12,4,"ng-container",0),h.pc(4,T,1,1,"ion-searchbar",1),h.Ob(),h.Ob(),h.Pb(5,"ion-content",2),h.Pb(6,"ion-list"),h.pc(7,O,11,9,"ion-item-group",0),h.ac(8,"async"),h.pc(9,S,5,3,"ion-item-group",3),h.Ob(),h.Ob(),h.Mb()),2&e){var n=h.Zb();h.Ab(3),h.fc("ngIf",!n.isShowSearchbar),h.Ab(1),h.fc("ngIf",n.isShowSearchbar),h.Ab(1),h.fc("fullscreen",!0),h.Ab(2),h.fc("ngIf",h.bc(8,5,n.store.lastTask)),h.Ab(2),h.fc("ngForOf",n.taskGroupsKeys)}}var M,A,I,D=[{path:"",component:(M=function(){function e(t,r,i,a,s,o,c,l,u,b){n(this,e),this.router=t,this.route=r,this.actionCtrl=i,this.store=a,this.msgService=s,this.modalCtrl=o,this.tasksDelegator=c,this.taskDelegatorFactory=l,this.langProvider=u,this.backupService=b,this.searchTaskStr="",this.segment="favorites",this.isInit=!1}return t(e,[{key:"ngOnInit",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tasksDelegator.getCategoryConfig();case 2:this.taskCatalog=e.sent.TasksCatalog,this.taskGroups=this.taskCatalog.reduce(function(e,t){return e[t.group]=e[t.group]||{isFiltered:!1,tasks:[]},e[t.group].tasks.push(t),e},Object.create(null)),this.filterTasks(),this.isInit=!0;case 6:case"end":return e.stop()}},e,this)}))}},{key:"ionViewWillEnter",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.backupService.checkBackupNeeded(),!(t=this.route.snapshot.paramMap.get(b.a.TaskDescId))){e.next=8;break}return e.next=5,this.tasksDelegator.getTaskDesk(t);case 5:return n=e.sent,e.next=8,this.createNewTask(n,!0);case 8:case"end":return e.stop()}},e,this)}))}},{key:"updateSearchTask",value:function(){this.filterTasks()}},{key:"updateSegment",value:function(){var e;null===(e=this.slide)||void 0===e||e.closeOpened(),this.filterTasks()}},{key:"showSearchbar",value:function(){this.isShowSearchbar=!0}},{key:"hideSearchbar",value:function(){this.isShowSearchbar=!1,this.searchTaskStr="",this.filterTasks()}},{key:"tokenizeSearchText",value:function(e){var t=null;if(""!==e.trim()){var n=e.toLowerCase().replace(/,|\.|-/g," ");""!==n&&(t=n.split(" ").filter(function(e){return!!e.trim().length}))}return t}},{key:"checkSearchDesc",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!0;return t&&(r=n?t.every(function(t){return e.description.indexOf(t)>-1}):t.some(function(t){return e.description.indexOf(t)>-1})),r}},{key:"filterTasks",value:function(){var e=this,t=this.tokenizeSearchText(this.searchTaskStr);switch(this.segment){case"all":Object.keys(this.taskGroups).forEach(function(n){e.taskGroups[n].tasks.forEach(function(r){r.isFiltered=e.taskGroups[n].isFiltered||!e.checkSearchDesc(r,t)})});break;case"favorites":Object.keys(this.taskGroups).forEach(function(n){e.taskGroups[n].tasks.forEach(function(r){r.isFiltered=!r.isFavorite||e.taskGroups[n].isFiltered||!e.checkSearchDesc(r,t)})})}this.taskGroupsKeys=[],Object.keys(this.taskGroups).forEach(function(t){e.taskGroups[t].tasks.filter(function(e){return!e.isFiltered}).length>0&&e.taskGroupsKeys.push(t)})}},{key:"changeFavorite",value:function(e,t){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stopImmediatePropagation(),e.isFavorite=!e.isFavorite,e.isFavorite?this.msgService.showToast(this.langProvider.FavoriteAddMsg(e.description),500,b.b.ToastSuccess):this.msgService.showToast(this.langProvider.FavoriteRemoveMsg(e.description),500,b.b.ToastWarn),n.next=5,this.tasksDelegator.updateTaskCatalog();case 5:this.filterTasks();case 6:case"end":return n.stop()}},n,this)}))}},{key:"showTaskFilters",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:f.a,swipeToClose:!0,componentProps:{taskGroups:this.taskGroups}});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.next=7,t.onWillDismiss();case 7:this.filterTasks();case 8:case"end":return e.stop()}},e,this)}))}},{key:"taskSwiped",value:function(e,t){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.msgService.showToast("Fully Swiped: ".concat(e.description),500);case 2:case"end":return t.stop()}},t,this)}))}},{key:"createNewTask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,a,s,o,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.tasksDelegator.getTasksConfig(e.id);case 2:if(r=n.sent,t||!(r.isAlertForMultiple||r.maxItems>=1)){n.next=42;break}return n.next=6,this.tasksDelegator.getAllTasksByTypeImpl(e.type,e.id);case 6:if(!((i=n.sent).length>0)){n.next=31;break}if(!(i.length>=r.maxItems)){n.next=18;break}return n.next=11,this.actionCtrl.create({header:this.langProvider.CatalogTaskEditMaxTasksMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:function(){a="Edit"}},{text:this.langProvider.Cancel,role:"cancel",handler:function(){a="Cancel"}}]});case 11:return s=n.sent,n.next=14,s.present();case 14:return n.next=16,s.onWillDismiss();case 16:n.next=29;break;case 18:if(!r.isAlertForMultiple){n.next=28;break}return n.next=21,this.actionCtrl.create({header:this.langProvider.CatalogTaskEditOrNewMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:function(){a="Edit"}},{text:this.langProvider.CatalogTaskNew,role:"destructive",handler:function(){a="New"}},{text:this.langProvider.Cancel,role:"cancel",handler:function(){a="Cancel"}}]});case 21:return o=n.sent,n.next=24,o.present();case 24:return n.next=26,o.onWillDismiss();case 26:n.next=29;break;case 28:a="New";case 29:n.next=32;break;case 31:a="New";case 32:n.t0=a,n.next="New"===n.t0?35:"Edit"===n.t0?37:40;break;case 35:return this.navigatoToTask(e),n.abrupt("break",40);case 37:return c=i.sort(function(e,t){return new Date(e.date).getTime()-new Date(t.date).getTime()}).reverse()[0],this.navigatoToTask(e,c._id),n.abrupt("break",40);case 40:n.next=43;break;case 42:this.navigatoToTask(e);case 43:case"end":return n.stop()}},n,this)}))}},{key:"navigatoToTask",value:function(e,t){var n;this.store.lastTask.next(e),null===(n=this.slide)||void 0===n||n.closeOpened();var r={};r[b.a.TaskType]=e.type,r[b.a.TaskDescId]=e.id,t&&(r[b.a.SavedTaskId]=t),r[b.a.Unique]=u.Guid.raw();var i={Path:"tabs/tasks/".concat(this.taskDelegatorFactory.getTaskDelegator(e.type).getComponentRoute()),Params:r,NavigationExtras:{skipLocationChange:!0,replaceUrl:!0}};this.store.lastTaskNavData.next(i),this.router.navigate([i.Path,i.Params],i.NavigationExtras)}},{key:"trackByFn",value:function(e,t){return t?t.id:e}}]),e}(),M.\u0275fac=function(e){return new(e||M)(h.Kb(c.f),h.Kb(c.a),h.Kb(o.a),h.Kb(k.a),h.Kb(d.a),h.Kb(o.eb),h.Kb(g.a),h.Kb(p.a),h.Kb(v.b),h.Kb(m.a))},M.\u0275cmp=h.Eb({type:M,selectors:[["app-task-catalog"]],viewQuery:function(e,t){var n;1&e&&h.xc(y,1),2&e&&h.ic(n=h.Yb())&&(t.slide=n.first)},decls:1,vars:1,consts:[[4,"ngIf"],["class","searchbar","showCancelButton","always",3,"ngModel","ngModelChange","ionChange","ionCancel",4,"ngIf"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["slot","start"],[3,"ngModel","ngModelChange","ionChange"],["value","favorites"],["value","all"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","options"],["slot","icon-only","name","search"],["showCancelButton","always",1,"searchbar",3,"ngModel","ngModelChange","ionChange","ionCancel"],["sticky","",1,"itemGroup"],["button","",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["slide",""],["button","",3,"hidden","click"],["slot","end","name","star-outline",3,"click",4,"ngIf"],["slot","end","name","star","color","primary",3,"click",4,"ngIf"],["slot","end","name","star-outline",3,"click"],["slot","end","name","star","color","primary",3,"click"]],template:function(e,t){1&e&&h.pc(0,G,10,7,"ng-container",0),2&e&&h.fc("ngIf",t.isInit)},directives:[a.m,o.s,o.Z,o.n,o.D,a.l,o.k,o.F,o.O,o.kb,s.e,s.h,o.P,o.j,o.t,o.N,o.lb,o.y,o.x,o.C,o.w,o.B],pipes:[a.b,a.k],styles:[".itemGroup[_ngcontent-%COMP%]{--color:var(--ion-color-favorite);font-weight:700}.searchbar[_ngcontent-%COMP%]{background:var(--ion-color-light)}"]}),M)},{path:"task-catalog-filter",loadChildren:function(){return Promise.resolve().then(i.bind(null,"QiNc")).then(function(e){return e.TaskCatalogFilterPageModule})}}],E=((A=function e(){n(this,e)}).\u0275fac=function(e){return new(e||A)},A.\u0275mod=h.Ib({type:A}),A.\u0275inj=h.Hb({imports:[[c.h.forChild(D)],c.h]}),A),N=i("QiNc"),Z=((I=function e(){n(this,e)}).\u0275fac=function(e){return new(e||I)},I.\u0275mod=h.Ib({type:I}),I.\u0275inj=h.Hb({imports:[[a.c,s.a,o.bb,E,N.TaskCatalogFilterPageModule]]}),I)}}])}();