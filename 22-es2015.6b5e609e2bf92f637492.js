(window.webpackJsonp=window.webpackJsonp||[]).push([[22,25,26],{"9O2a":function(e,t,n){"use strict";n.r(t),n.d(t,"TaskHostPageModule",(function(){return f}));var o=n("ofXK"),r=n("3Pt+"),s=n("TEn/"),a=n("tyNb"),i=n("VVJX"),c=n("Mxx3"),d=n("fXoL"),m=n("RybT");function l(e,t){}const u=[{path:"",component:(()=>{class e{constructor(e,t,n,o){this.router=e,this.route=t,this.componentFactoryResolver=n,this.taskDelegatorFactory=o}ngOnInit(){this.load()}ngAfterViewInit(){}load(){const e=this.route.snapshot.paramMap.get(c.a.TaskType),t=this.taskDelegatorFactory.getTaskDelegator(e).getComponent(),n=this.componentFactoryResolver.resolveComponentFactory(t),o=this.taskHost.viewContainerRef;o.clear(),o.createComponent(n)}}return e.\u0275fac=function(t){return new(t||e)(d.Ib(a.f),d.Ib(a.a),d.Ib(d.j),d.Ib(m.a))},e.\u0275cmp=d.Cb({type:e,selectors:[["app-task-host"]],viewQuery:function(e,t){var n;1&e&&d.lc(i.a,!0),2&e&&d.gc(n=d.Wb())&&(t.taskHost=n.first)},decls:1,vars:0,consts:[["appTaskHost",""]],template:function(e,t){1&e&&d.nc(0,l,0,0,"ng-template",0)},styles:[""]}),e})()}];let h=(()=>{class e{}return e.\u0275mod=d.Gb({type:e}),e.\u0275inj=d.Fb({factory:function(t){return new(t||e)},imports:[[a.h.forChild(u)],a.h]}),e})(),f=(()=>{class e{}return e.\u0275mod=d.Gb({type:e}),e.\u0275inj=d.Fb({factory:function(t){return new(t||e)},imports:[[o.b,r.a,s.Y,h]]}),e})()},RybT:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("fXoL"),r=n("pQKU"),s=n("Gwuq"),a=n("TtBN"),i=n("tEcr");let c=(()=>{class e{constructor(e,t,n,o){this.basketDelegator=e,this.formsDelegator=t,this.orderedDelegator=n,this.tasksDelegator=o}getTaskDelegator(e){let t;switch(e.toLowerCase()){case"baskets":t=this.basketDelegator;break;case"forms":t=this.formsDelegator;break;case"ordered":t=this.orderedDelegator;break;case"comment":t=this.tasksDelegator;break;default:throw new Error(`Task delegator for type: ${e} does not exist !!!`)}return t}}return e.\u0275fac=function(t){return new(t||e)(o.Rb(r.a),o.Rb(s.a),o.Rb(a.a),o.Rb(i.a))},e.\u0275prov=o.Eb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},VVJX:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n("fXoL");let r=(()=>{class e{constructor(e){this.viewContainerRef=e}}return e.\u0275fac=function(t){return new(t||e)(o.Ib(o.O))},e.\u0275dir=o.Db({type:e,selectors:[["","appTaskHost",""]]}),e})()},tEcr:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var o=n("mrSG"),r=n("kLqA"),s=n("fXoL"),a=n("L5fO"),i=n("TEn/"),c=n("ofXK");function d(e,t){if(1&e&&(s.Nb(0,"span"),s.pc(1),s.Mb()),2&e){const e=s.Xb();s.yb(1),s.sc("",e.langProvider.Comment,": ",e.comment.TaskDescRef.description,"")}}function m(e,t){if(1&e&&(s.Nb(0,"span"),s.pc(1),s.Mb()),2&e){const e=s.Xb();s.yb(1),s.qc(e.langProvider.GeneralComment)}}let l=(()=>{class e{constructor(e){this.langProvider=e}ngOnInit(){this.calcHistory()}calcHistory(){this.comment=this.task}}return e.\u0275fac=function(t){return new(t||e)(s.Ib(a.b))},e.\u0275cmp=s.Cb({type:e,selectors:[["app-comment-candidate-history"]],decls:12,vars:9,consts:[[1,"header"],[4,"ngIf","ngIfElse"],["elseNoTaskDesk",""],[2,"direction","ltr"],[1,"commentTxt"]],template:function(e,t){if(1&e&&(s.Lb(0),s.Nb(1,"ion-item"),s.Nb(2,"ion-label"),s.Nb(3,"div",0),s.nc(4,d,2,2,"span",1),s.nc(5,m,2,1,"ng-template",null,2,s.oc),s.Nb(7,"span",3),s.pc(8),s.Yb(9,"date"),s.Mb(),s.Mb(),s.Nb(10,"span",4),s.pc(11),s.Mb(),s.Mb(),s.Mb(),s.Kb()),2&e){const e=s.hc(6);s.yb(1),s.mc("direction",t.langProvider.LangDirection),s.yb(3),s.dc("ngIf",t.comment.TaskDescRef)("ngIfElse",e),s.yb(4),s.qc(s.ac(9,6,t.task.date,"dd/MM/yy HH:mm:ss")),s.yb(3),s.qc(null==t.comment?null:t.comment.comment)}},directives:[i.v,i.B,c.l],pipes:[c.d],styles:[".commentDate[_ngcontent-%COMP%]{font-size:.7rem;margin-bottom:.2rem;display:flex;justify-content:flex-end;color:var(--ion-color-medium)}.commentTxt[_ngcontent-%COMP%]{white-space:normal}.commentTask[_ngcontent-%COMP%]{margin-bottom:.2rem;color:var(--ion-color-tertiary)}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;color:var(--ion-color-medium)}"]}),e})();var u=n("h7jJ"),h=n("nbnm");let f=(()=>{class e{constructor(e,t){this.dataProvider=e,this.entityNamer=t,this.commentsPrefix="comments"}getAllTasks(){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.dataProvider.getAllTasks()}))}mergeTasksAndCandidateComments(e,t){return Object(o.a)(this,void 0,void 0,(function*(){return[...e,...t].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())}))}buildTasksGroupsByType(e){return e.reduce((e,t,n)=>(e[t.type]||(e[t.type]=[]),e[t.type].push(t),e),{})}loadCandidateComments(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=`${this.entityNamer.userPrefix()}@${this.commentsPrefix}@${e}`;return yield this.dataProvider.loadEntities(t)}))}loadComments(){return Object(o.a)(this,void 0,void 0,(function*(){const e=`${this.entityNamer.userPrefix()}@${this.commentsPrefix}`;return(yield this.dataProvider.loadEntities(e)).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).reduce((e,t,n)=>{const o=e.length>0?e[e.length-1]:null,r=this.dataProvider.getCandidatesByIds([t.candidateId]);if(o&&t.comment===o.comment&&new Date(t.date).getTime()===o.date.getTime())e[e.length-1].candidates.push(...r),e[e.length-1].SavedComments.push(t);else{const n={comment:t.comment,candidates:r,date:new Date(t.date),SavedComments:[t],TaskDescRef:t.TaskDescRef};e.push(n)}return e},[])}))}deleteComments(e){return Object(o.a)(this,void 0,void 0,(function*(){yield this.dataProvider.deleteEntities(e)}))}createComment(e){var t;return Object(o.a)(this,void 0,void 0,(function*(){const n=[],o=null!==(t=e.date)&&void 0!==t?t:new Date,s=`${this.entityNamer.userPrefix()}@${this.commentsPrefix}`;let a;a=e.TaskDescRef?e.TaskDescRef.type:"general";for(const t of e.candidates){const i={type:"comment",_id:`${s}@${t._id}@${a}@${r.Guid.raw()}`,date:o,candidateId:t._id,comment:e.comment,tags:e.tags,TaskDescRef:e.TaskDescRef};n.push(i)}return yield this.dataProvider.saveEntities(n)}))}getTaskConfig(e){throw new Error("Method not implemented.")}getTaskName(){throw new Error("Method not implemented.")}saveTask(e,t){throw new Error("Method not implemented.")}loadTask(e){throw new Error("Method not implemented.")}getTaskHistory(){throw new Error("Method not implemented.")}getComponent(){throw new Error("Method not implemented.")}getHistoryComponent(){throw new Error("Method not implemented.")}getCandidateHistoryComponent(){return l}getCandidateAggregateComponent(){throw new Error("Method not implemented.")}deleteTask(e){throw new Error("Method not implemented.")}getTasksForCandidates(e){throw new Error("Method not implemented.")}checkTaskEmpty(e,t){throw new Error("Method not implemented.")}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(u.a),s.Rb(h.a))},e.\u0275prov=s.Eb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);