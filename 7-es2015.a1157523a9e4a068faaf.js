(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{QiNc:function(t,e,s){"use strict";s.r(e),s.d(e,"TaskCatalogFilterPageModule",function(){return h});var i=s("ofXK"),n=s("3Pt+"),o=s("TEn/"),a=s("tyNb"),r=s("hvzS"),c=s("fXoL");const l=[{path:"",component:r.a}];let b=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.Jb({type:t}),t.\u0275inj=c.Ib({imports:[[a.h.forChild(l)],a.h]}),t})(),h=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.Jb({type:t}),t.\u0275inj=c.Ib({imports:[[i.c,n.a,o.bb,b]]}),t})()},hvzS:function(t,e,s){"use strict";s.d(e,"a",function(){return l});var i=s("fXoL"),n=s("TEn/"),o=s("L5fO"),a=s("ofXK"),r=s("3Pt+");function c(t,e){if(1&t){const t=i.Sb();i.Rb(0,"ion-item"),i.Rb(1,"ion-label"),i.tc(2),i.Qb(),i.Rb(3,"ion-toggle",9),i.Zb("ngModelChange",function(s){i.mc(t);const n=e.$implicit;return i.bc().taskGroups[n].isFiltered=!s}),i.Qb(),i.Qb()}if(2&t){const t=e.$implicit,s=i.bc();i.Bb(2),i.uc(t),i.Bb(1),i.hc("ngModel",!s.taskGroups[t].isFiltered)}}let l=(()=>{class t{constructor(t,e){this.modalCtrl=t,this.langProvider=e}ngOnInit(){this.taskGroupsKeys=Object.keys(this.taskGroups)}resetFilters(){Object.keys(this.taskGroups).forEach(t=>this.taskGroups[t].isFiltered=!1)}shutdownFilters(){Object.keys(this.taskGroups).forEach(t=>this.taskGroups[t].isFiltered=!0)}applyFilters(){this.modalCtrl.dismiss("koko")}dismissFilters(){this.modalCtrl.dismiss("koko")}changeFilterStatus(t){this.taskGroups[t].isFiltered=!this.taskGroups[t].isFiltered}}return t.\u0275fac=function(e){return new(e||t)(i.Lb(n.eb),i.Lb(o.b))},t.\u0275cmp=i.Fb({type:t,selectors:[["app-task-catalog-filter"]],inputs:{taskGroups:"taskGroups"},decls:15,vars:5,consts:[["translucent","true"],["slot","end"],["strong","",3,"click"],[1,"mainFilters",3,"fullscreen"],[1,"resetFilters"],["slot","start","color","danger","fill","clear",3,"click"],["slot","end","color","success","fill","clear",3,"click"],[1,"filtersList"],[4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Rb(0,"ion-header",0),i.Rb(1,"ion-toolbar"),i.Mb(2,"ion-title"),i.Rb(3,"ion-buttons",1),i.Rb(4,"ion-button",2),i.Zb("click",function(){return e.applyFilters()}),i.tc(5),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Rb(6,"ion-content",3),i.Rb(7,"ion-toolbar",4),i.Rb(8,"ion-button",5),i.Zb("click",function(){return e.shutdownFilters()}),i.tc(9),i.Qb(),i.Rb(10,"ion-button",6),i.Zb("click",function(){return e.resetFilters()}),i.tc(11),i.Qb(),i.Qb(),i.Rb(12,"div",7),i.Rb(13,"ion-list"),i.rc(14,c,4,2,"ion-item",8),i.Qb(),i.Qb(),i.Qb()),2&t&&(i.Bb(5),i.uc(e.langProvider.Done),i.Bb(1),i.hc("fullscreen",!0),i.Bb(3),i.vc(" ",e.langProvider.ShutdownAll," "),i.Bb(2),i.vc(" ",e.langProvider.ShowAll," "),i.Bb(3),i.hc("ngForOf",e.taskGroupsKeys))},directives:[n.s,n.Z,n.X,n.k,n.j,n.n,n.D,a.l,n.w,n.C,n.Y,n.c,r.e,r.h],styles:[".mainFilters[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;overflow:hidden}.resetFilters[_ngcontent-%COMP%]{flex:1;width:100%;display:flex;justify-content:space-between}.filtersList[_ngcontent-%COMP%]{overflow:scroll}"]}),t})()},"m/R5":function(t,e,s){"use strict";s.r(e),s.d(e,"TaskCatalogPageModule",function(){return B});var i=s("ofXK"),n=s("3Pt+"),o=s("TEn/"),a=s("tyNb"),r=s("mrSG"),c=s("kLqA"),l=s("Mxx3"),b=s("hvzS"),h=s("fXoL"),u=s("3LWr"),d=s("zrcv"),g=s("NrBX"),k=s("RybT"),f=s("L5fO"),p=s("Ueei");const m=["slide"];function v(t,e){if(1&t){const t=h.Sb();h.Rb(0,"ion-button",10),h.Zb("click",function(){return h.mc(t),h.bc(3).showSearchbar()}),h.Mb(1,"ion-icon",12),h.Qb()}}function T(t,e){if(1&t){const t=h.Sb();h.Pb(0),h.Rb(1,"ion-buttons",4),h.Mb(2,"ion-menu-button"),h.Qb(),h.Rb(3,"ion-segment",5),h.Zb("ngModelChange",function(e){return h.mc(t),h.bc(2).segment=e})("ionChange",function(){return h.mc(t),h.bc(2).updateSegment()}),h.Rb(4,"ion-segment-button",6),h.tc(5),h.Qb(),h.Rb(6,"ion-segment-button",7),h.tc(7),h.Qb(),h.Qb(),h.Rb(8,"ion-buttons",8),h.rc(9,v,2,0,"ion-button",9),h.Rb(10,"ion-button",10),h.Zb("click",function(){return h.mc(t),h.bc(2).showTaskFilters()}),h.Mb(11,"ion-icon",11),h.Qb(),h.Qb(),h.Ob()}if(2&t){const t=h.bc(2);h.Bb(3),h.hc("ngModel",t.segment),h.Bb(2),h.vc(" ",t.langProvider.FavoriteCatalogTasks," "),h.Bb(2),h.vc(" ",t.langProvider.AllCatalogTasks," "),h.Bb(2),h.hc("ngIf",!t.isShowSearchbar)}}function y(t,e){if(1&t){const t=h.Sb();h.Rb(0,"ion-searchbar",13),h.Zb("ngModelChange",function(e){return h.mc(t),h.bc(2).searchTaskStr=e})("ionChange",function(){return h.mc(t),h.bc(2).updateSearchTask()})("ionCancel",function(){return h.mc(t),h.bc(2).hideSearchbar()}),h.Qb()}if(2&t){const t=h.bc(2);h.hc("ngModel",t.searchTaskStr)}}function C(t,e){if(1&t){const t=h.Sb();h.Rb(0,"ion-item-group"),h.Rb(1,"ion-item-divider",14),h.Rb(2,"ion-label"),h.tc(3),h.Qb(),h.Qb(),h.Rb(4,"ion-item",15),h.Zb("click",function(){h.mc(t);const e=h.bc(2);return e.createNewTask(e.store.lastTask.value)}),h.cc(5,"lowercase"),h.cc(6,"async"),h.Rb(7,"ion-label"),h.Rb(8,"p"),h.tc(9),h.cc(10,"async"),h.Qb(),h.Qb(),h.Qb(),h.Qb()}if(2&t){const t=h.bc(2);h.Bb(3),h.vc(" ",t.langProvider.LatestCatalogTasks," "),h.Bb(1),h.Cb("track",h.dc(5,3,h.dc(6,5,t.store.lastTask).type)),h.Bb(5),h.uc(h.dc(10,7,t.store.lastTask).description)}}function w(t,e){if(1&t){const t=h.Sb();h.Rb(0,"ion-icon",21),h.Zb("click",function(e){h.mc(t);const s=h.bc().$implicit;return h.bc(3).changeFavorite(s,e)}),h.Qb()}}function F(t,e){if(1&t){const t=h.Sb();h.Rb(0,"ion-icon",22),h.Zb("click",function(e){h.mc(t);const s=h.bc().$implicit;return h.bc(3).changeFavorite(s,e)}),h.Qb()}}function S(t,e){if(1&t){const t=h.Sb();h.Rb(0,"ion-item-sliding",null,17),h.cc(2,"lowercase"),h.Rb(3,"ion-item",18),h.Zb("click",function(){h.mc(t);const s=e.$implicit;return h.bc(3).createNewTask(s)}),h.Rb(4,"ion-label"),h.Rb(5,"p"),h.tc(6),h.Qb(),h.Qb(),h.rc(7,w,1,0,"ion-icon",19),h.rc(8,F,1,0,"ion-icon",20),h.Qb(),h.Qb()}if(2&t){const t=e.$implicit;h.Cb("track",h.dc(2,5,t.type)),h.Bb(3),h.hc("hidden",t.isFiltered),h.Bb(3),h.uc(t.description),h.Bb(1),h.hc("ngIf",!t.isFavorite),h.Bb(1),h.hc("ngIf",t.isFavorite)}}function Q(t,e){if(1&t&&(h.Rb(0,"ion-item-group"),h.Rb(1,"ion-item-divider",14),h.Rb(2,"ion-label"),h.tc(3),h.Qb(),h.Qb(),h.rc(4,S,9,7,"ion-item-sliding",16),h.Qb()),2&t){const t=e.$implicit,s=h.bc(2);h.Bb(3),h.vc(" ",t," "),h.Bb(1),h.hc("ngForOf",s.taskGroups[t].tasks)("ngForTrackBy",s.trackByFn)}}function R(t,e){if(1&t&&(h.Pb(0),h.Rb(1,"ion-header"),h.Rb(2,"ion-toolbar"),h.rc(3,T,12,4,"ng-container",0),h.rc(4,y,1,1,"ion-searchbar",1),h.Qb(),h.Qb(),h.Rb(5,"ion-content",2),h.Rb(6,"ion-list"),h.rc(7,C,11,9,"ion-item-group",0),h.cc(8,"async"),h.rc(9,Q,5,3,"ion-item-group",3),h.Qb(),h.Qb(),h.Ob()),2&t){const t=h.bc();h.Bb(3),h.hc("ngIf",!t.isShowSearchbar),h.Bb(1),h.hc("ngIf",t.isShowSearchbar),h.Bb(1),h.hc("fullscreen",!0),h.Bb(2),h.hc("ngIf",h.dc(8,5,t.store.lastTask)),h.Bb(2),h.hc("ngForOf",t.taskGroupsKeys)}}const P=[{path:"",component:(()=>{class t{constructor(t,e,s,i,n,o,a,r,c,l){this.router=t,this.route=e,this.actionCtrl=s,this.store=i,this.msgService=n,this.modalCtrl=o,this.tasksDelegator=a,this.taskDelegatorFactory=r,this.langProvider=c,this.backupService=l,this.searchTaskStr="",this.segment="favorites",this.isInit=!1}ngOnInit(){return Object(r.a)(this,void 0,void 0,function*(){this.taskCatalog=(yield this.tasksDelegator.getCategoryConfig()).TasksCatalog,this.taskGroups=this.taskCatalog.reduce((t,e)=>(t[e.group]=t[e.group]||{isFiltered:!1,tasks:[]},t[e.group].tasks.push(e),t),Object.create(null)),this.filterTasks(),this.isInit=!0})}ionViewWillEnter(){return Object(r.a)(this,void 0,void 0,function*(){this.backupService.checkBackupNeeded();const t=this.route.snapshot.paramMap.get(l.a.TaskDescId);if(t){const e=yield this.tasksDelegator.getTaskDesk(t);yield this.createNewTask(e,!0)}})}updateSearchTask(){this.filterTasks()}updateSegment(){var t;null===(t=this.slide)||void 0===t||t.closeOpened(),this.filterTasks()}showSearchbar(){this.isShowSearchbar=!0}hideSearchbar(){this.isShowSearchbar=!1,this.searchTaskStr="",this.filterTasks()}tokenizeSearchText(t){let e=null;if(""!==t.trim()){const s=t.toLowerCase().replace(/,|\.|-/g," ");""!==s&&(e=s.split(" ").filter(t=>!!t.trim().length))}return e}checkSearchDesc(t,e,s=!0){let i=!0;return e&&(i=s?e.every(e=>t.description.indexOf(e)>-1):e.some(e=>t.description.indexOf(e)>-1)),i}filterTasks(){const t=this.tokenizeSearchText(this.searchTaskStr);switch(this.segment){case"all":Object.keys(this.taskGroups).forEach(e=>{this.taskGroups[e].tasks.forEach(s=>{s.isFiltered=this.taskGroups[e].isFiltered||!this.checkSearchDesc(s,t)})});break;case"favorites":Object.keys(this.taskGroups).forEach(e=>{this.taskGroups[e].tasks.forEach(s=>{s.isFiltered=!s.isFavorite||this.taskGroups[e].isFiltered||!this.checkSearchDesc(s,t)})})}this.taskGroupsKeys=[],Object.keys(this.taskGroups).forEach(t=>{this.taskGroups[t].tasks.filter(t=>!t.isFiltered).length>0&&this.taskGroupsKeys.push(t)})}changeFavorite(t,e){return Object(r.a)(this,void 0,void 0,function*(){e.stopImmediatePropagation(),t.isFavorite=!t.isFavorite,t.isFavorite?this.msgService.showToast(this.langProvider.FavoriteAddMsg(t.description),500,l.b.ToastSuccess):this.msgService.showToast(this.langProvider.FavoriteRemoveMsg(t.description),500,l.b.ToastWarn),yield this.tasksDelegator.updateTaskCatalog(),this.filterTasks()})}showTaskFilters(){return Object(r.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:b.a,swipeToClose:!0,componentProps:{taskGroups:this.taskGroups}});yield t.present(),yield t.onWillDismiss(),this.filterTasks()})}taskSwiped(t,e){return Object(r.a)(this,void 0,void 0,function*(){yield this.msgService.showToast(`Fully Swiped: ${t.description}`,500)})}createNewTask(t,e=!1){return Object(r.a)(this,void 0,void 0,function*(){const s=yield this.tasksDelegator.getTasksConfig(t.id);if(!e&&(s.isAlertForMultiple||s.maxItems>=1)){const e=yield this.tasksDelegator.getAllTasksByTypeImpl(t.type,t.id);let i;if(e.length>0)if(e.length>=s.maxItems){const t=yield this.actionCtrl.create({header:this.langProvider.CatalogTaskEditMaxTasksMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:()=>{i="Edit"}},{text:this.langProvider.Cancel,role:"cancel",handler:()=>{i="Cancel"}}]});yield t.present(),yield t.onWillDismiss()}else if(s.isAlertForMultiple){const t=yield this.actionCtrl.create({header:this.langProvider.CatalogTaskEditOrNewMsg,cssClass:["actionSheetGeneral",this.langProvider.LangDirection],buttons:[{text:this.langProvider.CatalogTaskEditLast,role:"selected",handler:()=>{i="Edit"}},{text:this.langProvider.CatalogTaskNew,role:"destructive",handler:()=>{i="New"}},{text:this.langProvider.Cancel,role:"cancel",handler:()=>{i="Cancel"}}]});yield t.present(),yield t.onWillDismiss()}else i="New";else i="New";switch(i){case"New":this.navigatoToTask(t);break;case"Edit":{const s=e.sort((t,e)=>new Date(t.date).getTime()-new Date(e.date).getTime()).reverse()[0];this.navigatoToTask(t,s._id);break}}}else this.navigatoToTask(t)})}navigatoToTask(t,e){var s;this.store.lastTask.next(t),null===(s=this.slide)||void 0===s||s.closeOpened();const i={};i[l.a.TaskType]=t.type,i[l.a.TaskDescId]=t.id,e&&(i[l.a.SavedTaskId]=e),i[l.a.Unique]=c.Guid.raw();const n={Path:`tabs/tasks/${this.taskDelegatorFactory.getTaskDelegator(t.type).getComponentRoute()}`,Params:i,NavigationExtras:{skipLocationChange:!0,replaceUrl:!0}};this.store.lastTaskNavData.next(n),this.router.navigate([n.Path,n.Params],n.NavigationExtras)}trackByFn(t,e){return e?e.id:t}}return t.\u0275fac=function(e){return new(e||t)(h.Lb(a.f),h.Lb(a.a),h.Lb(o.a),h.Lb(u.a),h.Lb(d.a),h.Lb(o.eb),h.Lb(g.a),h.Lb(k.a),h.Lb(f.b),h.Lb(p.a))},t.\u0275cmp=h.Fb({type:t,selectors:[["app-task-catalog"]],viewQuery:function(t,e){if(1&t&&h.zc(m,1),2&t){let t;h.kc(t=h.ac())&&(e.slide=t.first)}},decls:1,vars:1,consts:[[4,"ngIf"],["class","searchbar","showCancelButton","always",3,"ngModel","ngModelChange","ionChange","ionCancel",4,"ngIf"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["slot","start"],[3,"ngModel","ngModelChange","ionChange"],["value","favorites"],["value","all"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","options"],["slot","icon-only","name","search"],["showCancelButton","always",1,"searchbar",3,"ngModel","ngModelChange","ionChange","ionCancel"],["sticky","",1,"itemGroup"],["button","",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["slide",""],["button","",3,"hidden","click"],["slot","end","name","star-outline",3,"click",4,"ngIf"],["slot","end","name","star","color","primary",3,"click",4,"ngIf"],["slot","end","name","star-outline",3,"click"],["slot","end","name","star","color","primary",3,"click"]],template:function(t,e){1&t&&h.rc(0,R,10,7,"ng-container",0),2&t&&h.hc("ngIf",e.isInit)},directives:[i.m,o.s,o.Z,o.n,o.D,i.l,o.k,o.F,o.O,o.kb,n.e,n.h,o.P,o.j,o.t,o.N,o.lb,o.y,o.x,o.C,o.w,o.B],pipes:[i.b,i.k],styles:[".itemGroup[_ngcontent-%COMP%]{font-weight:700;--color:var(--ion-color-favorite)}.searchbar[_ngcontent-%COMP%]{background:var(--ion-color-light)}"]}),t})()},{path:"task-catalog-filter",loadChildren:()=>Promise.resolve().then(s.bind(null,"QiNc")).then(t=>t.TaskCatalogFilterPageModule)}];let M=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.Jb({type:t}),t.\u0275inj=h.Ib({imports:[[a.h.forChild(P)],a.h]}),t})();var O=s("QiNc");let B=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.Jb({type:t}),t.\u0275inj=h.Ib({imports:[[i.c,n.a,o.bb,M,O.TaskCatalogFilterPageModule]]}),t})()}}]);