(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{PWTB:function(t,e,n){"use strict";var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r)return r;throw new Error("unable to locate global object")}();t.exports=e=r.fetch,r.fetch&&(e.default=r.fetch.bind(r)),e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response},TaIo:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n("PWTB"))&&r.__esModule?r:{default:r};e.default=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;try{e=window.fetch}catch(o){e=i.default}try{var r="https://spreadsheets.google.com/feeds/cells/".concat(t,"/").concat(n,"/public/values?alt=json-in-script");return e(r).then((function(t){if(!t.ok)throw console.log("there is an error in the gsheets response"),new Error("Error fetching GSheet");return t.text()})).then((function(t){var e=t.replace("gdata.io.handleScriptLoaded(","").slice(0,-2);return JSON.parse(e)})).catch((function(t){throw new Error("Failed to fetch from GSheets API. Check your Sheet Id and the public availability of your GSheet.")}))}catch(o){throw new Error("General error when fetching GSheet: ".concat(o))}}},Z6ku:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n("TaIo"))&&r.__esModule?r:{default:r};function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}e.default=function(t,e,n){return(0,i.default)(t.sheetId,t.sheetNumber?t.sheetNumber:1).then((function(n){var r=function(t,e,n,r){var i,a=[{}],s={},c=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return o(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,void 0):void 0}}(t))){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}(t.feed.entry);try{for(c.s();!(i=c.n()).done;){var l=i.value.gs$cell,u=l.$t,d=l.col,f=l.row,h=s[d];f<2?s[d]=u.toLowerCase():(void 0===a[f]&&(a[f]={}),void 0!==h&&h.length>0&&(a[f][h]=u))}}catch(v){c.e(v)}finally{c.f()}return a=a.filter((function(t){return Object.keys(t).length})),e||!n?a:function(t,e,n){return t.filter((function(t){var r=null,i=[];return!(void 0===t||t.length<=0||Object.keys(t).length<=0)&&(Object.keys(e).forEach((function(r){i.push(function(t,e,n){try{if(void 0!==t){if(t=t.toLowerCase().trim(),e=e.toLowerCase().trim(),"strict"===n)return t===e;if("loose"===n)return t.includes(e)||t==e}}catch(r){return console.log("error in matchValues: ".concat(r.message)),!1}return!1}(t[r],e[r],n.matching||"loose"))})),"or"===n.operator&&(r=i.some((function(t){return!0===t}))),"and"===n.operator&&(r=i.every((function(t){return!0===t}))),r)}))}(a,n,r)}(n,t.returnAllResults||!1,t.filter||!1,t.filterOptions||{operator:"or",matching:"loose"});e(r)})).catch((function(t){return n(t.message)}))}},sMI2:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n("Z6ku"))&&r.__esModule?r:{default:r},o=function(t,e,n){return(0,i.default)(t,(function(t){e(t)}),(function(t){if(!n)throw new Error("g-sheets-api error: ".concat(t));n(t)}))};t.exports=o,e.default=o},x5Jj:function(t,e,n){"use strict";n.r(e),n.d(e,"PouchbPlayPageModule",(function(){return P}));var r=n("ofXK"),i=n("3Pt+"),o=n("TEn/"),a=n("tyNb"),s=n("mrSG"),c=n("fXoL"),l=n("h7jJ"),u=n("4UqN"),d=n("sMI2"),f=n("6nr9"),h=n("ufmx"),v=n("pQKU"),b=n("Gwuq"),p=n("L5fO"),g=n("VYsW");let y=(()=>{class t{constructor(t,e,n,r,i,o){this.settingsService=t,this.candidatesDelegator=e,this.basketsDelegator=n,this.formsDelegator=r,this.langProvider=i,this.appContext=o}validate(){return Object(s.a)(this,void 0,void 0,(function*(){const t=this.appContext.getAppContext(),e=yield this.getValidationData();switch(t.activationCode){case"c1":yield this.validateMain(t.user,e);break;case"c2":case"c3":break;default:throw new Error("Unknown Activation Code: "+t.activationCode)}return JSON.stringify(e,null,2)}))}validateMain(t,e){return Object(s.a)(this,void 0,void 0,(function*(){const n=e.filter(e=>Object.keys(e).map(t=>t.toLocaleLowerCase()).filter(t=>"1"===e.active).filter(t=>t.startsWith("angel")).filter(n=>e[n]===t).length>0),r=yield this.candidatesDelegator.getCandidates(),i=[],o=[];for(const t of n){const e=r.find(e=>e.group===t.group&&e.number.toString()===t.number);e?(o.push(e),t.id=e._id):i.push(t)}const a=o.filter(t=>!t.isActive);if(a.length>0)throw new Error(`${this.langProvider.DataValidationActiveStatusNotMatch}\n\n${this.langProvider.Candidates}: ${a.map(t=>t.number)}`);if(i.length>0)throw new Error(`${this.langProvider.DataValidationMissingCandidates}\n\n${this.langProvider.Candidates}: ${i.map(t=>t.number)}`);const s=yield this.formsDelegator.getFormTaskMain("t_gibushFinalForm");if(!s)throw new Error(""+this.langProvider.DataValidationMissingCandidateForms);if(!n.every(t=>s.coverage.full.findIndex(e=>t.id===e)>-1))throw new Error(""+this.langProvider.DataValidationMissingCandidateForms);return!0}))}validateInterview(t,e){return Object(s.a)(this,void 0,void 0,(function*(){return e.filter(e=>Object.keys(e).map(t=>t.toLocaleLowerCase()).filter(t=>t.startsWith("interview")).filter(n=>e[n]===t).length>0),!0}))}validateSocio(t,e){return Object(s.a)(this,void 0,void 0,(function*(){return e.filter(e=>Object.keys(e).map(t=>t.toLocaleLowerCase()).filter(t=>"1"===e.active).filter(t=>t.startsWith("socio")).filter(n=>e[n]===t).length>0),!0}))}getValidationData(){return new Promise((t,e)=>{const n=new RegExp("https://docs.google.com/spreadsheets/d/(.*)/"),r=this.settingsService.getSettingsItem("validationSheetUri"),i={sheetId:n.exec(r)[1],returnAllResults:!0};try{d(i,e=>{t(e)})}catch(o){e(o)}})}}return t.\u0275fac=function(e){return new(e||t)(c.Rb(f.a),c.Rb(h.a),c.Rb(v.a),c.Rb(b.a),c.Rb(p.b),c.Rb(g.a))},t.\u0275prov=c.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var m=n("nbnm"),w=n("zrcv");const S=["video"],M=[{path:"",component:(()=>{class t{constructor(t,e,n,r,i,o){this.dataProvider=t,this.setupService=e,this.validationService=n,this.settingsService=r,this.entityNamer=i,this.msgService=o}ngOnInit(){}sync(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.dataProvider.syncToCouch(),yield this.msgService.showToast("DB Synced",500)}))}dropDb(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.setupService.clearSetup(),yield this.dataProvider.dropDb(),location.reload(),yield this.msgService.showToast("DB Dropped",500)}))}compactDb(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.dataProvider.compactDb(),yield this.msgService.showToast("DB Compacted",500)}))}getAllTasks(){return Object(s.a)(this,void 0,void 0,(function*(){const t=yield this.dataProvider.getAllTasks();this.msgService.showModal(JSON.stringify(t))}))}googleSheet(){return Object(s.a)(this,void 0,void 0,(function*(){try{const t=yield this.validationService.validate();this.msgService.showModal(t,null,"ltr")}catch(t){this.msgService.showModal(null==t?void 0:t.message)}}))}playVideo(){this.videoSrc="./assets/videos/VID-20200320-WA0027.mp4",this.videoPlayer.nativeElement.load(),this.videoPlayer.nativeElement.play()}sendMail(){return Object(s.a)(this,void 0,void 0,(function*(){const t=encodeURI(this.entityNamer.userPrefix()),e=this.settingsService.getSettingsItem("targetDataMail"),n=yield this.dataProvider.getAllDocs(),r=JSON.stringify(n);window.location.href=`mailto:${e}?subject=${t}&body=${r}`}))}}return t.\u0275fac=function(e){return new(e||t)(c.Ib(l.a),c.Ib(u.a),c.Ib(y),c.Ib(f.a),c.Ib(m.a),c.Ib(w.a))},t.\u0275cmp=c.Cb({type:t,selectors:[["app-pouchb-play"]],viewQuery:function(t,e){var n;1&t&&c.vc(S,!0),2&t&&c.gc(n=c.Wb())&&(e.videoPlayer=n.first)},decls:21,vars:0,consts:[["slot","end"],["defaultHref","/"],["expand","full","color","secondary",3,"click"]],template:function(t,e){1&t&&(c.Nb(0,"ion-header"),c.Nb(1,"ion-toolbar"),c.Nb(2,"ion-buttons",0),c.Jb(3,"ion-back-button",1),c.Mb(),c.Nb(4,"ion-title"),c.pc(5,"pouchbPlay"),c.Mb(),c.Mb(),c.Mb(),c.Nb(6,"ion-content"),c.Nb(7,"ion-button",2),c.Vb("click",(function(){return e.dropDb()})),c.pc(8,"Drop DB"),c.Mb(),c.Nb(9,"ion-button",2),c.Vb("click",(function(){return e.sync()})),c.pc(10,"Sync"),c.Mb(),c.Nb(11,"ion-button",2),c.Vb("click",(function(){return e.compactDb()})),c.pc(12,"Compact DB"),c.Mb(),c.Nb(13,"ion-button",2),c.Vb("click",(function(){return e.getAllTasks()})),c.pc(14,"Get All Tasks"),c.Mb(),c.Nb(15,"ion-button",2),c.Vb("click",(function(){return e.googleSheet()})),c.pc(16,"Google Sheet"),c.Mb(),c.Nb(17,"ion-button",2),c.Vb("click",(function(){return e.playVideo()})),c.pc(18,"Video"),c.Mb(),c.Nb(19,"ion-button",2),c.Vb("click",(function(){return e.sendMail()})),c.pc(20,"Mail"),c.Mb(),c.Mb())},directives:[o.s,o.Z,o.k,o.g,o.h,o.X,o.n,o.j],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;overflow:hidden}.video[_ngcontent-%COMP%]{height:auto;width:100%}"]}),t})()}];let k=(()=>{class t{}return t.\u0275mod=c.Gb({type:t}),t.\u0275inj=c.Fb({factory:function(e){return new(e||t)},imports:[[a.h.forChild(M)],a.h]}),t})(),P=(()=>{class t{}return t.\u0275mod=c.Gb({type:t}),t.\u0275inj=c.Fb({factory:function(e){return new(e||t)},imports:[[r.c,i.a,o.bb,k]]}),t})()}}]);